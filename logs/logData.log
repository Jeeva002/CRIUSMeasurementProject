2025-11-07 15:26:27 - root - INFO - Downloading study for file_id: 1.2.826.0.1.3680043.8.1678.201.10638814340534406936.382542
2025-11-07 15:26:32 - root - INFO - Processing DICOM from folder: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US
2025-11-07 15:26:32 - root - INFO - === Starting DICOM Ultrasound Processing Session ===
2025-11-07 15:26:32 - root - INFO - Processing DICOM directory: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US
2025-11-07 15:26:32 - root - INFO - Reading DICOM files from directory
2025-11-07 15:26:32 - root - INFO - Starting to read DICOM directory: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US
2025-11-07 15:26:32 - root - DEBUG - Listing files in directory
2025-11-07 15:26:32 - root - INFO - Found 31 files in directory to process
2025-11-07 15:26:32 - root - DEBUG - Processing file 1/31: US000003.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000003.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000003.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000003.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 2/31: US000004.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000004.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000004.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000004.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 3/31: US000005.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000005.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000005.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000005.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 4/31: US000006.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000006.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000006.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000006.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 5/31: US000007.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000007.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000007.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000007.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 6/31: US000008.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000008.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000008.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000008.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 7/31: US000009.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000009.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000009.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000009.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 8/31: US000010.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000010.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000010.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000010.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 9/31: US000011.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000011.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000011.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000011.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 10/31: US000012.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000012.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000012.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000012.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 11/31: US000013.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000013.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000013.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000013.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 12/31: US000014.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000014.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000014.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000014.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 13/31: US000015.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000015.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:32 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000015.dcm
2025-11-07 15:26:32 - root - DEBUG - Added valid DICOM file to list: US000015.dcm
2025-11-07 15:26:32 - root - DEBUG - Processing file 14/31: US000016.dcm
2025-11-07 15:26:32 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000016.dcm
2025-11-07 15:26:32 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000016.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000016.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 15/31: US000017.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000017.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000017.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000017.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 16/31: US000018.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000018.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000018.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000018.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 17/31: US000019.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000019.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000019.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000019.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 18/31: US000020.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000020.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000020.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000020.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 19/31: US000021.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000021.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000021.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000021.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 20/31: US000022.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000022.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000022.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000022.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 21/31: US000023.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000023.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000023.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000023.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 22/31: US000024.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000024.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000024.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000024.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 23/31: US000025.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000025.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000025.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000025.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 24/31: US000026.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000026.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000026.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000026.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 25/31: US000027.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000027.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000027.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000027.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 26/31: US000028.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000028.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000028.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000028.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 27/31: US000029.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000029.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000029.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000029.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 28/31: US000030.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000030.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000030.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000030.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 29/31: US000031.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000031.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000031.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000031.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 30/31: US000032.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000032.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000032.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000032.dcm
2025-11-07 15:26:33 - root - DEBUG - Processing file 31/31: US000033.dcm
2025-11-07 15:26:33 - root - DEBUG - Checking if file is valid DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000033.dcm
2025-11-07 15:26:33 - root - DEBUG - Attempting to read DICOM file with pydicom
2025-11-07 15:26:33 - root - DEBUG - File successfully validated as DICOM: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000033.dcm
2025-11-07 15:26:33 - root - DEBUG - Added valid DICOM file to list: US000033.dcm
2025-11-07 15:26:33 - root - INFO - DICOM file validation completed. Found 31 valid DICOM files
2025-11-07 15:26:33 - root - INFO - Extracting metadata from first DICOM file
2025-11-07 15:26:33 - root - DEBUG - Extracting metadata from DICOM file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000003.dcm
2025-11-07 15:26:33 - root - DEBUG - Reading DICOM metadata for information extraction
2025-11-07 15:26:33 - root - INFO - Metadata extracted successfully from: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000003.dcm
2025-11-07 15:26:33 - root - DEBUG - Extracted metadata: {'PatientName': 'KAVITHA.M', 'PatientID': 'CICPL14846', 'PatientAge': '19790324', 'PatientGender': 'F', 'HospitalName': 'CLARITY IMAGING CENTRE', 'PhysicianName': 'Dr. Devi Gayathri.P. MBBs., DNB', 'scanType': 'ABDOMEN/US', 'scanDate': '20250428', 'scanTime': '161021', 'scanModality': 'US'}
2025-11-07 15:26:33 - root - INFO - Successfully extracted metadata
2025-11-07 15:26:33 - root - INFO - Directory processing completed successfully
2025-11-07 15:26:33 - root - DEBUG - Final results - DICOM files: 31, Metadata available: True
2025-11-07 15:26:33 - root - INFO - Found 31 DICOM files to process
2025-11-07 15:26:33 - root - DEBUG - metaData: {'PatientName': 'KAVITHA.M', 'PatientID': 'CICPL14846', 'PatientAge': '19790324', 'PatientGender': 'F', 'HospitalName': 'CLARITY IMAGING CENTRE', 'PhysicianName': 'Dr. Devi Gayathri.P. MBBs., DNB', 'scanType': 'ABDOMEN/US', 'scanDate': '20250428', 'scanTime': '161021', 'scanModality': 'US'}
2025-11-07 15:26:33 - root - INFO - Processing DICOM file 1/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000003.dcm
2025-11-07 15:26:33 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:26:33 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000003.dcm
2025-11-07 15:26:33 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:26:33 - root - INFO - DICOM file loaded successfully
2025-11-07 15:26:33 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:26:33 - root - INFO - Processing RGB format DICOM
2025-11-07 15:26:33 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:26:33 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:26:33 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:26:33 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:26:33 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:26:33 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:26:33 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:26:33 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:26:33 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:33 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:26:33 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:26:33 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:26:33 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:26:33 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:33 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:26:33 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:26:33 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:26:33 - root - INFO - Initializing OCRHandler
2025-11-07 15:26:33 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:26:33 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:26:33 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:26:33 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:26:33 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:26:33 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:26:33 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:26:34 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:26:34 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:26:34 - root - INFO - Initializing TableDetector
2025-11-07 15:26:34 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:26:34 - root - DEBUG - Default detection parameters:
2025-11-07 15:26:34 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:26:34 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:26:34 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:26:34 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:26:34 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:26:34 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:26:34 - root - INFO - TableDetector initialization completed
2025-11-07 15:26:34 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:26:34 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:26:34 - root - DEBUG - Text analysis configuration:
2025-11-07 15:26:34 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:26:34 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:26:34 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:26:34 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:26:34 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:26:34 - root - INFO - Initializing ContentExtractor
2025-11-07 15:26:34 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:26:34 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:26:34 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:26:34 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:26:34 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:26:34 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:26:34 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:26:34 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:26:34 - root - DEBUG - Edge detection completed
2025-11-07 15:26:34 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:26:34 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 276221
2025-11-07 15:26:34 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:26:34 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:26:34 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:26:34 - root - DEBUG - Line enhancement completed
2025-11-07 15:26:34 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:26:34 - root - DEBUG - Line thickening completed
2025-11-07 15:26:34 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:26:34 - root - DEBUG - Line combination completed
2025-11-07 15:26:34 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:26:34 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:26:34 - root - INFO - Found 625 contours
2025-11-07 15:26:34 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:26:34 - root - DEBUG - Contours drawn successfully
2025-11-07 15:26:34 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:26:34 - root - INFO - Rectangular region detection completed
2025-11-07 15:26:34 - root - INFO - Total candidate regions found: 76
2025-11-07 15:26:34 - root - DEBUG - Found 76 candidate regions
2025-11-07 15:26:34 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:26:36 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:26:36 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:26:36 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:26:36 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:26:36 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:26:36 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:26:36 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:26:36 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:26:36 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:26:36 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:26:36 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:26:36 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:26:36 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:26:36 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:26:36 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:26:36 - root - INFO - Final measurement score: 0
2025-11-07 15:26:36 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:26:36 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:26:36 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:26:36 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:26:36 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:26:36 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:26:36 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:26:36 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:26:36 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:26:36 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:26:36 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:26:36 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:26:36 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:26:36 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:26:36 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:26:36 - root - DEBUG - Table detection completed. Candidates found: 76
2025-11-07 15:26:36 - root - INFO - Identifying organ name from the image
2025-11-07 15:26:36 - root - INFO - Starting organ name identification
2025-11-07 15:26:36 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:26:36 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:26:36 - root - INFO - Starting organ label identification
2025-11-07 15:26:36 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:26:36 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:26:37 - root - DEBUG - Line 1: '64/18Hz' (conf: 1.000)
2025-11-07 15:26:37 - root - DEBUG - Line 2: 'Voluson' (conf: 0.994)
2025-11-07 15:26:37 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.989)
2025-11-07 15:26:37 - root - DEBUG - Line 4: '58' (conf: 0.768)
2025-11-07 15:26:37 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.927)
2025-11-07 15:26:37 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.935)
2025-11-07 15:26:37 - root - DEBUG - Line 7: 'Gn -7' (conf: 0.993)
2025-11-07 15:26:37 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.908)
2025-11-07 15:26:37 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:26:37 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.974)
2025-11-07 15:26:37 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:26:37 - root - DEBUG - Line 0 text: '64/18Hz'
2025-11-07 15:26:37 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:26:37 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:26:37 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:26:37 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:26:37 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:26:37 - root - DEBUG - Line 6 text: 'Gn -7'
2025-11-07 15:26:37 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:26:37 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:26:37 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:26:37 - root - DEBUG - Combined text for keyword search: '64/18hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -7 c7 / m15 ff2/e2 sri ii 2 / cri 2'
2025-11-07 15:26:37 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:26:37 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:26:37 - root - INFO - Identified organs: []
2025-11-07 15:26:37 - root - WARNING - No organ name identified from the image
2025-11-07 15:26:37 - root - DEBUG - Organ identified: []
2025-11-07 15:26:37 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:26:37 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000003.dcm
2025-11-07 15:26:37 - root - INFO - Processing DICOM file 2/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000004.dcm
2025-11-07 15:26:37 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:26:37 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000004.dcm
2025-11-07 15:26:37 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:26:37 - root - INFO - DICOM file loaded successfully
2025-11-07 15:26:37 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:26:37 - root - INFO - Processing RGB format DICOM
2025-11-07 15:26:37 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:26:37 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:26:37 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:26:37 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:26:37 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:26:37 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:26:37 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:26:37 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:26:37 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:37 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:26:37 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:26:37 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:26:37 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:26:37 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:37 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:26:37 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:26:37 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:26:37 - root - INFO - Initializing OCRHandler
2025-11-07 15:26:37 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:26:37 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:26:37 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:26:37 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:26:37 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:26:37 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:26:37 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:26:38 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:26:38 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:26:38 - root - INFO - Initializing TableDetector
2025-11-07 15:26:38 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:26:38 - root - DEBUG - Default detection parameters:
2025-11-07 15:26:38 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:26:38 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:26:38 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:26:38 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:26:38 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:26:38 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:26:38 - root - INFO - TableDetector initialization completed
2025-11-07 15:26:38 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:26:38 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:26:38 - root - DEBUG - Text analysis configuration:
2025-11-07 15:26:38 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:26:38 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:26:38 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:26:38 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:26:38 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:26:38 - root - INFO - Initializing ContentExtractor
2025-11-07 15:26:38 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:26:38 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:26:38 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:26:38 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:26:38 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:26:38 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:26:38 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:26:38 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:26:38 - root - DEBUG - Edge detection completed
2025-11-07 15:26:38 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:26:38 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 272348
2025-11-07 15:26:38 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:26:38 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:26:38 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:26:38 - root - DEBUG - Line enhancement completed
2025-11-07 15:26:38 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:26:38 - root - DEBUG - Line thickening completed
2025-11-07 15:26:38 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:26:38 - root - DEBUG - Line combination completed
2025-11-07 15:26:38 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:26:38 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:26:38 - root - INFO - Found 601 contours
2025-11-07 15:26:38 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:26:38 - root - DEBUG - Contours drawn successfully
2025-11-07 15:26:38 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:26:38 - root - INFO - Rectangular region detection completed
2025-11-07 15:26:38 - root - INFO - Total candidate regions found: 74
2025-11-07 15:26:38 - root - DEBUG - Found 74 candidate regions
2025-11-07 15:26:38 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:26:40 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:26:40 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:26:40 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:26:40 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:26:40 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:26:40 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:26:40 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:26:40 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:26:40 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:26:40 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:26:40 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:26:40 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:26:40 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:26:40 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:26:40 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:26:40 - root - INFO - Final measurement score: 0
2025-11-07 15:26:41 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:26:41 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:26:41 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:26:41 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:26:41 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:26:41 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:26:41 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:26:41 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:26:41 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:26:41 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:26:41 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:26:41 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:26:41 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:26:41 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:26:41 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:26:41 - root - DEBUG - Table detection completed. Candidates found: 74
2025-11-07 15:26:41 - root - INFO - Identifying organ name from the image
2025-11-07 15:26:41 - root - INFO - Starting organ name identification
2025-11-07 15:26:41 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:26:41 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:26:41 - root - INFO - Starting organ label identification
2025-11-07 15:26:41 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:26:41 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:26:41 - root - DEBUG - Line 1: '64/18Hz' (conf: 1.000)
2025-11-07 15:26:41 - root - DEBUG - Line 2: 'Voluson' (conf: 0.973)
2025-11-07 15:26:41 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.989)
2025-11-07 15:26:41 - root - DEBUG - Line 4: '58' (conf: 0.768)
2025-11-07 15:26:41 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.927)
2025-11-07 15:26:41 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.935)
2025-11-07 15:26:41 - root - DEBUG - Line 7: 'Gn -7' (conf: 0.993)
2025-11-07 15:26:41 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.886)
2025-11-07 15:26:41 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:26:41 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.974)
2025-11-07 15:26:41 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:26:41 - root - DEBUG - Line 0 text: '64/18Hz'
2025-11-07 15:26:41 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:26:41 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:26:41 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:26:41 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:26:41 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:26:41 - root - DEBUG - Line 6 text: 'Gn -7'
2025-11-07 15:26:41 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:26:41 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:26:41 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:26:41 - root - DEBUG - Combined text for keyword search: '64/18hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -7 c7 / m15 ff2/e2 sri ii 2 / cri 2'
2025-11-07 15:26:41 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:26:41 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:26:41 - root - INFO - Identified organs: []
2025-11-07 15:26:41 - root - WARNING - No organ name identified from the image
2025-11-07 15:26:41 - root - DEBUG - Organ identified: []
2025-11-07 15:26:41 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:26:41 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000004.dcm
2025-11-07 15:26:41 - root - INFO - Processing DICOM file 3/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000005.dcm
2025-11-07 15:26:41 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:26:41 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000005.dcm
2025-11-07 15:26:41 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:26:41 - root - INFO - DICOM file loaded successfully
2025-11-07 15:26:41 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:26:41 - root - INFO - Processing RGB format DICOM
2025-11-07 15:26:41 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:26:41 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:26:41 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:26:41 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:26:41 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:26:41 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:26:41 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:26:41 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:26:41 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:41 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:26:41 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:26:41 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:26:41 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:26:41 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:41 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:26:41 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:26:41 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:26:41 - root - INFO - Initializing OCRHandler
2025-11-07 15:26:41 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:26:41 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:26:41 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:26:41 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:26:41 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:26:41 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:26:41 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:26:42 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:26:42 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:26:42 - root - INFO - Initializing TableDetector
2025-11-07 15:26:42 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:26:42 - root - DEBUG - Default detection parameters:
2025-11-07 15:26:42 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:26:42 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:26:42 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:26:42 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:26:42 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:26:42 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:26:42 - root - INFO - TableDetector initialization completed
2025-11-07 15:26:42 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:26:42 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:26:42 - root - DEBUG - Text analysis configuration:
2025-11-07 15:26:42 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:26:42 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:26:42 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:26:42 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:26:42 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:26:42 - root - INFO - Initializing ContentExtractor
2025-11-07 15:26:42 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:26:42 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:26:42 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:26:42 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:26:43 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:26:43 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:26:43 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:26:43 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:26:43 - root - DEBUG - Edge detection completed
2025-11-07 15:26:43 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:26:43 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 314070
2025-11-07 15:26:43 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:26:43 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:26:43 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:26:43 - root - DEBUG - Line enhancement completed
2025-11-07 15:26:43 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:26:43 - root - DEBUG - Line thickening completed
2025-11-07 15:26:43 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:26:43 - root - DEBUG - Line combination completed
2025-11-07 15:26:43 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:26:43 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:26:43 - root - INFO - Found 1064 contours
2025-11-07 15:26:43 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:26:43 - root - DEBUG - Contours drawn successfully
2025-11-07 15:26:43 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:26:43 - root - INFO - Rectangular region detection completed
2025-11-07 15:26:43 - root - INFO - Total candidate regions found: 91
2025-11-07 15:26:43 - root - DEBUG - Found 91 candidate regions
2025-11-07 15:26:43 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:26:44 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:26:44 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:26:44 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:26:44 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:26:44 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:26:44 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:26:44 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:26:44 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:26:44 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:26:44 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:26:44 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:26:44 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:26:44 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:26:44 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:26:44 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:26:44 - root - INFO - Final measurement score: 0
2025-11-07 15:26:45 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:26:45 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:26:45 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:26:45 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:26:45 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:26:45 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:26:45 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:26:45 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:26:45 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:26:45 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:26:45 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:26:45 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:26:45 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:26:45 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:26:45 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:26:45 - root - DEBUG - Table detection completed. Candidates found: 91
2025-11-07 15:26:45 - root - INFO - Identifying organ name from the image
2025-11-07 15:26:45 - root - INFO - Starting organ name identification
2025-11-07 15:26:45 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:26:45 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:26:45 - root - INFO - Starting organ label identification
2025-11-07 15:26:45 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:26:45 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:26:45 - root - DEBUG - Line 1: '64/12Hz' (conf: 1.000)
2025-11-07 15:26:45 - root - DEBUG - Line 2: '18cm/s' (conf: 0.991)
2025-11-07 15:26:45 - root - DEBUG - Line 3: 'Voluson' (conf: 0.998)
2025-11-07 15:26:45 - root - DEBUG - Line 4: 'Abdomen 1' (conf: 0.999)
2025-11-07 15:26:45 - root - DEBUG - Line 5: '58' (conf: 0.794)
2025-11-07 15:26:45 - root - DEBUG - Line 6: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:26:45 - root - DEBUG - Line 7: 'AO 100%' (conf: 0.938)
2025-11-07 15:26:45 - root - DEBUG - Line 8: 'Gn -14' (conf: 0.992)
2025-11-07 15:26:45 - root - DEBUG - Line 9: 'C7 / M15' (conf: 0.886)
2025-11-07 15:26:45 - root - DEBUG - Line 10: 'FF2/E2' (conf: 0.994)
2025-11-07 15:26:45 - root - DEBUG - Line 11: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:26:45 - root - DEBUG - Line 12: 'AO 100%' (conf: 0.938)
2025-11-07 15:26:45 - root - DEBUG - Line 13: 'Gn -4.4' (conf: 0.925)
2025-11-07 15:26:45 - root - DEBUG - Line 14: 'Frq mid' (conf: 1.000)
2025-11-07 15:26:45 - root - DEBUG - Line 15: 'Qual norm' (conf: 0.998)
2025-11-07 15:26:45 - root - DEBUG - Line 16: '18cm/s' (conf: 0.962)
2025-11-07 15:26:45 - root - DEBUG - Line 17: 'WMF low1' (conf: 0.985)
2025-11-07 15:26:45 - root - DEBUG - Line 18: 'PRF 1.3kHz' (conf: 1.000)
2025-11-07 15:26:45 - root - DEBUG - OCR completed. Processing 18 text lines for organ keywords
2025-11-07 15:26:45 - root - DEBUG - Line 0 text: '64/12Hz'
2025-11-07 15:26:45 - root - DEBUG - Line 1 text: '18cm/s'
2025-11-07 15:26:45 - root - DEBUG - Line 2 text: 'Voluson'
2025-11-07 15:26:45 - root - DEBUG - Line 3 text: 'Abdomen 1'
2025-11-07 15:26:45 - root - DEBUG - Line 4 text: '58'
2025-11-07 15:26:45 - root - DEBUG - Line 5 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:26:45 - root - DEBUG - Line 6 text: 'AO 100%'
2025-11-07 15:26:45 - root - DEBUG - Line 7 text: 'Gn -14'
2025-11-07 15:26:45 - root - DEBUG - Line 8 text: 'C7 / M15'
2025-11-07 15:26:45 - root - DEBUG - Line 9 text: 'FF2/E2'
2025-11-07 15:26:45 - root - DEBUG - Line 10 text: 'SRI II 2 / CRI 2'
2025-11-07 15:26:45 - root - DEBUG - Line 11 text: 'AO 100%'
2025-11-07 15:26:45 - root - DEBUG - Line 12 text: 'Gn -4.4'
2025-11-07 15:26:45 - root - DEBUG - Line 13 text: 'Frq mid'
2025-11-07 15:26:45 - root - DEBUG - Line 14 text: 'Qual norm'
2025-11-07 15:26:45 - root - DEBUG - Line 15 text: '18cm/s'
2025-11-07 15:26:45 - root - DEBUG - Line 16 text: 'WMF low1'
2025-11-07 15:26:45 - root - DEBUG - Line 17 text: 'PRF 1.3kHz'
2025-11-07 15:26:45 - root - DEBUG - Combined text for keyword search: '64/12hz 18cm/s voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -14 c7 / m15 ff2/e2 sri ii 2 / cri 2 ao 100% gn -4.4 frq mid qual norm 18cm/s wmf low1 prf 1.3khz'
2025-11-07 15:26:45 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:26:45 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:26:45 - root - INFO - Identified organs: []
2025-11-07 15:26:45 - root - WARNING - No organ name identified from the image
2025-11-07 15:26:45 - root - DEBUG - Organ identified: []
2025-11-07 15:26:45 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:26:45 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000005.dcm
2025-11-07 15:26:45 - root - INFO - Processing DICOM file 4/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000006.dcm
2025-11-07 15:26:45 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:26:45 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000006.dcm
2025-11-07 15:26:45 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:26:45 - root - INFO - DICOM file loaded successfully
2025-11-07 15:26:45 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:26:45 - root - INFO - Processing RGB format DICOM
2025-11-07 15:26:45 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:26:45 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:26:45 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:26:45 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:26:45 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:26:45 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:26:45 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:26:45 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:26:45 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:45 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:26:45 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:26:45 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:26:45 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:26:45 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:45 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:26:45 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:26:45 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:26:45 - root - INFO - Initializing OCRHandler
2025-11-07 15:26:45 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:26:45 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:26:45 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:26:45 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:26:45 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:26:45 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:26:45 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:26:46 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:26:46 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:26:46 - root - INFO - Initializing TableDetector
2025-11-07 15:26:46 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:26:46 - root - DEBUG - Default detection parameters:
2025-11-07 15:26:46 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:26:46 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:26:46 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:26:46 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:26:46 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:26:46 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:26:46 - root - INFO - TableDetector initialization completed
2025-11-07 15:26:46 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:26:46 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:26:46 - root - DEBUG - Text analysis configuration:
2025-11-07 15:26:46 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:26:46 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:26:46 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:26:46 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:26:46 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:26:46 - root - INFO - Initializing ContentExtractor
2025-11-07 15:26:46 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:26:46 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:26:46 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:26:46 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:26:47 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:26:47 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:26:47 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:26:47 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:26:47 - root - DEBUG - Edge detection completed
2025-11-07 15:26:47 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:26:47 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 328413
2025-11-07 15:26:47 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:26:47 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:26:47 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:26:47 - root - DEBUG - Line enhancement completed
2025-11-07 15:26:47 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:26:47 - root - DEBUG - Line thickening completed
2025-11-07 15:26:47 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:26:47 - root - DEBUG - Line combination completed
2025-11-07 15:26:47 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:26:47 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:26:47 - root - INFO - Found 933 contours
2025-11-07 15:26:47 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:26:47 - root - DEBUG - Contours drawn successfully
2025-11-07 15:26:47 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:26:47 - root - INFO - Rectangular region detection completed
2025-11-07 15:26:47 - root - INFO - Total candidate regions found: 99
2025-11-07 15:26:47 - root - DEBUG - Found 99 candidate regions
2025-11-07 15:26:47 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:26:49 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:26:49 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:26:49 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:26:49 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:26:49 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:26:49 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:26:49 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:26:49 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:26:49 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:26:49 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:26:49 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:26:49 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:26:49 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:26:49 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:26:49 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:26:49 - root - INFO - Final measurement score: 0
2025-11-07 15:26:49 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:26:49 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:26:49 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:26:49 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:26:49 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:26:49 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:26:49 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:26:49 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:26:49 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:26:49 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:26:49 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:26:49 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:26:49 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:26:49 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:26:49 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:26:49 - root - DEBUG - Table detection completed. Candidates found: 99
2025-11-07 15:26:49 - root - INFO - Identifying organ name from the image
2025-11-07 15:26:49 - root - INFO - Starting organ name identification
2025-11-07 15:26:49 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:26:49 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:26:49 - root - INFO - Starting organ label identification
2025-11-07 15:26:49 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:26:49 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:26:50 - root - DEBUG - Line 1: '64/12Hz' (conf: 1.000)
2025-11-07 15:26:50 - root - DEBUG - Line 2: '18cm/s' (conf: 0.999)
2025-11-07 15:26:50 - root - DEBUG - Line 3: 'Voluson' (conf: 0.998)
2025-11-07 15:26:50 - root - DEBUG - Line 4: 'Abdomen 1' (conf: 0.999)
2025-11-07 15:26:50 - root - DEBUG - Line 5: '58' (conf: 0.794)
2025-11-07 15:26:50 - root - DEBUG - Line 6: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:26:50 - root - DEBUG - Line 7: 'AO 100%' (conf: 0.938)
2025-11-07 15:26:50 - root - DEBUG - Line 8: 'Gn -11' (conf: 0.994)
2025-11-07 15:26:50 - root - DEBUG - Line 9: 'C7 / M15' (conf: 0.908)
2025-11-07 15:26:50 - root - DEBUG - Line 10: 'FF2/E2' (conf: 0.994)
2025-11-07 15:26:50 - root - DEBUG - Line 11: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:26:50 - root - DEBUG - Line 12: 'AO 100%' (conf: 0.975)
2025-11-07 15:26:50 - root - DEBUG - Line 13: 'Gn -4.4' (conf: 0.874)
2025-11-07 15:26:50 - root - DEBUG - Line 14: 'Frq mid' (conf: 1.000)
2025-11-07 15:26:50 - root - DEBUG - Line 15: 'Qual norm' (conf: 0.998)
2025-11-07 15:26:50 - root - DEBUG - Line 16: '18cm/s' (conf: 0.962)
2025-11-07 15:26:50 - root - DEBUG - Line 17: 'WMF low1' (conf: 0.985)
2025-11-07 15:26:50 - root - DEBUG - Line 18: 'PRF 1.3kHz' (conf: 1.000)
2025-11-07 15:26:50 - root - DEBUG - OCR completed. Processing 18 text lines for organ keywords
2025-11-07 15:26:50 - root - DEBUG - Line 0 text: '64/12Hz'
2025-11-07 15:26:50 - root - DEBUG - Line 1 text: '18cm/s'
2025-11-07 15:26:50 - root - DEBUG - Line 2 text: 'Voluson'
2025-11-07 15:26:50 - root - DEBUG - Line 3 text: 'Abdomen 1'
2025-11-07 15:26:50 - root - DEBUG - Line 4 text: '58'
2025-11-07 15:26:50 - root - DEBUG - Line 5 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:26:50 - root - DEBUG - Line 6 text: 'AO 100%'
2025-11-07 15:26:50 - root - DEBUG - Line 7 text: 'Gn -11'
2025-11-07 15:26:50 - root - DEBUG - Line 8 text: 'C7 / M15'
2025-11-07 15:26:50 - root - DEBUG - Line 9 text: 'FF2/E2'
2025-11-07 15:26:50 - root - DEBUG - Line 10 text: 'SRI II 2 / CRI 2'
2025-11-07 15:26:50 - root - DEBUG - Line 11 text: 'AO 100%'
2025-11-07 15:26:50 - root - DEBUG - Line 12 text: 'Gn -4.4'
2025-11-07 15:26:50 - root - DEBUG - Line 13 text: 'Frq mid'
2025-11-07 15:26:50 - root - DEBUG - Line 14 text: 'Qual norm'
2025-11-07 15:26:50 - root - DEBUG - Line 15 text: '18cm/s'
2025-11-07 15:26:50 - root - DEBUG - Line 16 text: 'WMF low1'
2025-11-07 15:26:50 - root - DEBUG - Line 17 text: 'PRF 1.3kHz'
2025-11-07 15:26:50 - root - DEBUG - Combined text for keyword search: '64/12hz 18cm/s voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -11 c7 / m15 ff2/e2 sri ii 2 / cri 2 ao 100% gn -4.4 frq mid qual norm 18cm/s wmf low1 prf 1.3khz'
2025-11-07 15:26:50 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:26:50 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:26:50 - root - INFO - Identified organs: []
2025-11-07 15:26:50 - root - WARNING - No organ name identified from the image
2025-11-07 15:26:50 - root - DEBUG - Organ identified: []
2025-11-07 15:26:50 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:26:50 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000006.dcm
2025-11-07 15:26:50 - root - INFO - Processing DICOM file 5/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000007.dcm
2025-11-07 15:26:50 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:26:50 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000007.dcm
2025-11-07 15:26:50 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:26:50 - root - INFO - DICOM file loaded successfully
2025-11-07 15:26:50 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:26:50 - root - INFO - Processing RGB format DICOM
2025-11-07 15:26:50 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:26:50 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:26:50 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:26:50 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:26:50 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:26:50 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:26:50 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:26:50 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:26:50 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:50 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:26:50 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:26:50 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:26:50 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:26:50 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:50 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:26:50 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:26:50 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:26:50 - root - INFO - Initializing OCRHandler
2025-11-07 15:26:50 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:26:50 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:26:50 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:26:50 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:26:50 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:26:50 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:26:50 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:26:51 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:26:51 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:26:51 - root - INFO - Initializing TableDetector
2025-11-07 15:26:51 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:26:51 - root - DEBUG - Default detection parameters:
2025-11-07 15:26:51 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:26:51 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:26:51 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:26:51 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:26:51 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:26:51 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:26:51 - root - INFO - TableDetector initialization completed
2025-11-07 15:26:51 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:26:51 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:26:51 - root - DEBUG - Text analysis configuration:
2025-11-07 15:26:51 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:26:51 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:26:51 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:26:51 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:26:51 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:26:51 - root - INFO - Initializing ContentExtractor
2025-11-07 15:26:51 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:26:51 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:26:51 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:26:51 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:26:51 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:26:51 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:26:51 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:26:51 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:26:51 - root - DEBUG - Edge detection completed
2025-11-07 15:26:51 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:26:51 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 164497
2025-11-07 15:26:51 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:26:51 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:26:51 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:26:51 - root - DEBUG - Line enhancement completed
2025-11-07 15:26:51 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:26:51 - root - DEBUG - Line thickening completed
2025-11-07 15:26:51 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:26:51 - root - DEBUG - Line combination completed
2025-11-07 15:26:51 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:26:51 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:26:51 - root - INFO - Found 462 contours
2025-11-07 15:26:51 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:26:51 - root - DEBUG - Contours drawn successfully
2025-11-07 15:26:51 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:26:51 - root - INFO - Rectangular region detection completed
2025-11-07 15:26:51 - root - INFO - Total candidate regions found: 42
2025-11-07 15:26:51 - root - DEBUG - Found 42 candidate regions
2025-11-07 15:26:51 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:26:52 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:26:52 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:26:52 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:26:52 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:26:52 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:26:52 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:26:52 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:26:52 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:26:52 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:26:52 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:26:52 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:26:52 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:26:52 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:26:52 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:26:52 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:26:52 - root - INFO - Final measurement score: 0
2025-11-07 15:26:52 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:26:52 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:26:52 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:26:52 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:26:52 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:26:52 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:26:52 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:26:52 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:26:52 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:26:52 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:26:52 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:26:52 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:26:52 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:26:52 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:26:52 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:26:52 - root - DEBUG - Table detection completed. Candidates found: 42
2025-11-07 15:26:52 - root - INFO - Identifying organ name from the image
2025-11-07 15:26:52 - root - INFO - Starting organ name identification
2025-11-07 15:26:52 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:26:52 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:26:52 - root - INFO - Starting organ label identification
2025-11-07 15:26:52 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:26:52 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:26:53 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:26:53 - root - DEBUG - Line 2: 'Voluson' (conf: 0.999)
2025-11-07 15:26:53 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.998)
2025-11-07 15:26:53 - root - DEBUG - Line 4: '58' (conf: 0.915)
2025-11-07 15:26:53 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:26:53 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.938)
2025-11-07 15:26:53 - root - DEBUG - Line 7: 'Gn 12' (conf: 0.999)
2025-11-07 15:26:53 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.886)
2025-11-07 15:26:53 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:26:53 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:26:53 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:26:53 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:26:53 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:26:53 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:26:53 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:26:53 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:26:53 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:26:53 - root - DEBUG - Line 6 text: 'Gn 12'
2025-11-07 15:26:53 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:26:53 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:26:53 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:26:53 - root - DEBUG - Combined text for keyword search: '64/19hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn 12 c7 / m15 ff2/e2 sri ii 2 / cri 2'
2025-11-07 15:26:53 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:26:53 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:26:53 - root - INFO - Identified organs: []
2025-11-07 15:26:53 - root - WARNING - No organ name identified from the image
2025-11-07 15:26:53 - root - DEBUG - Organ identified: []
2025-11-07 15:26:53 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:26:53 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000007.dcm
2025-11-07 15:26:53 - root - INFO - Processing DICOM file 6/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000008.dcm
2025-11-07 15:26:53 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:26:53 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000008.dcm
2025-11-07 15:26:53 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:26:53 - root - INFO - DICOM file loaded successfully
2025-11-07 15:26:53 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:26:53 - root - INFO - Processing RGB format DICOM
2025-11-07 15:26:53 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:26:53 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:26:53 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:26:53 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:26:53 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:26:53 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:26:53 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:26:53 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:26:53 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:53 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:26:53 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:26:53 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:26:53 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:26:53 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:53 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:26:53 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:26:53 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:26:53 - root - INFO - Initializing OCRHandler
2025-11-07 15:26:53 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:26:53 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:26:53 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:26:53 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:26:53 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:26:53 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:26:53 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:26:54 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:26:54 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:26:54 - root - INFO - Initializing TableDetector
2025-11-07 15:26:54 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:26:54 - root - DEBUG - Default detection parameters:
2025-11-07 15:26:54 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:26:54 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:26:54 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:26:54 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:26:54 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:26:54 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:26:54 - root - INFO - TableDetector initialization completed
2025-11-07 15:26:54 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:26:54 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:26:54 - root - DEBUG - Text analysis configuration:
2025-11-07 15:26:54 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:26:54 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:26:54 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:26:54 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:26:54 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:26:54 - root - INFO - Initializing ContentExtractor
2025-11-07 15:26:54 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:26:54 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:26:54 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:26:54 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:26:54 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:26:54 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:26:54 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:26:54 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:26:54 - root - DEBUG - Edge detection completed
2025-11-07 15:26:54 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:26:54 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 291242
2025-11-07 15:26:54 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:26:54 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:26:54 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:26:54 - root - DEBUG - Line enhancement completed
2025-11-07 15:26:54 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:26:54 - root - DEBUG - Line thickening completed
2025-11-07 15:26:54 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:26:54 - root - DEBUG - Line combination completed
2025-11-07 15:26:54 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:26:54 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:26:54 - root - INFO - Found 779 contours
2025-11-07 15:26:54 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:26:54 - root - DEBUG - Contours drawn successfully
2025-11-07 15:26:54 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:26:54 - root - INFO - Rectangular region detection completed
2025-11-07 15:26:54 - root - INFO - Total candidate regions found: 118
2025-11-07 15:26:54 - root - DEBUG - Found 118 candidate regions
2025-11-07 15:26:54 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:26:55 - root - DEBUG - Line 1: '1 D 9.10cm' (conf: 0.998)
2025-11-07 15:26:55 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:26:55 - root - DEBUG - Line 3: 'D 4.61cm' (conf: 0.999)
2025-11-07 15:26:55 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:26:55 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:26:55 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:26:55 - root - DEBUG - Combined text: '1 d 9.10cm 2  d 4.61cm'
2025-11-07 15:26:55 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:26:55 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:26:55 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:26:55 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:26:55 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:26:55 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:26:55 - root - DEBUG - Pattern 1 found matches: ['9.10cm', '4.61cm']
2025-11-07 15:26:55 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:26:55 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:26:55 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:26:55 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:26:55 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:26:55 - root - INFO - Final measurement score: 8
2025-11-07 15:26:56 - root - DEBUG - Line 1: '-' (conf: 0.598)
2025-11-07 15:26:56 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:26:56 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:26:56 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:26:56 - root - DEBUG - Combined text: '-'
2025-11-07 15:26:56 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:26:56 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:26:56 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:26:56 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:26:56 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:26:56 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:26:56 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:26:56 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:26:56 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:26:56 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:26:56 - root - INFO - Final measurement score: 0
2025-11-07 15:26:57 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:26:57 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:26:57 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:26:57 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:26:57 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:26:57 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:26:57 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:26:57 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:26:57 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:26:57 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:26:57 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:26:57 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:26:57 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:26:57 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:26:57 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:26:57 - root - INFO - Final measurement score: 0
2025-11-07 15:26:57 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:26:57 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:26:57 - root - DEBUG - Top 10 score indices: [1, 0, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:26:57 - root - DEBUG - Rank 1: Index 1, Score 8.000000
2025-11-07 15:26:57 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:26:57 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:26:57 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:26:57 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:26:57 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:26:57 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:26:57 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:26:57 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:26:57 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:26:57 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:26:57 - root - DEBUG - All top 10 scores:
2025-11-07 15:26:57 - root - DEBUG - Score index 1: 8.000000
2025-11-07 15:26:57 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:26:57 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:26:57 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:26:57 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:26:57 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:26:57 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:26:57 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:26:57 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:26:57 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:26:57 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:26:57 - root - DEBUG - Table detection completed. Candidates found: 118
2025-11-07 15:26:57 - root - INFO - Identifying organ name from the image
2025-11-07 15:26:57 - root - INFO - Starting organ name identification
2025-11-07 15:26:57 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:26:57 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:26:57 - root - INFO - Starting organ label identification
2025-11-07 15:26:57 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:26:57 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:26:58 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:26:58 - root - DEBUG - Line 2: 'Voluson' (conf: 1.000)
2025-11-07 15:26:58 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.999)
2025-11-07 15:26:58 - root - DEBUG - Line 4: '58' (conf: 0.915)
2025-11-07 15:26:58 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:26:58 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.941)
2025-11-07 15:26:58 - root - DEBUG - Line 7: 'Gn 0' (conf: 0.947)
2025-11-07 15:26:58 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.886)
2025-11-07 15:26:58 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:26:58 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:26:58 - root - DEBUG - Line 11: '1 D 9.10cm' (conf: 0.999)
2025-11-07 15:26:58 - root - DEBUG - Line 12: '2 D 4.61cm' (conf: 0.998)
2025-11-07 15:26:58 - root - DEBUG - OCR completed. Processing 12 text lines for organ keywords
2025-11-07 15:26:58 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:26:58 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:26:58 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:26:58 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:26:58 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:26:58 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:26:58 - root - DEBUG - Line 6 text: 'Gn 0'
2025-11-07 15:26:58 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:26:58 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:26:58 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:26:58 - root - DEBUG - Line 10 text: '1 D 9.10cm'
2025-11-07 15:26:58 - root - DEBUG - Line 11 text: '2 D 4.61cm'
2025-11-07 15:26:58 - root - DEBUG - Combined text for keyword search: '64/19hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn 0 c7 / m15 ff2/e2 sri ii 2 / cri 2 1 d 9.10cm 2 d 4.61cm'
2025-11-07 15:26:58 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:26:58 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:26:58 - root - INFO - Identified organs: []
2025-11-07 15:26:58 - root - WARNING - No organ name identified from the image
2025-11-07 15:26:58 - root - DEBUG - Organ identified: []
2025-11-07 15:26:58 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:26:58 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:26:58 - root - DEBUG - Best score index: 1
2025-11-07 15:26:58 - root - INFO - Extracting structured data from detected table
2025-11-07 15:26:58 - root - INFO - Starting table content extraction
2025-11-07 15:26:58 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:26:58 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:26:58 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:26:58 - root - INFO - Starting table content extraction
2025-11-07 15:26:58 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:26:58 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:26:58 - root - DEBUG - Line 1: '1 D 9.10cm' (conf: 0.998)
2025-11-07 15:26:58 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:26:58 - root - DEBUG - Line 3: 'D 4.61cm' (conf: 0.999)
2025-11-07 15:26:58 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:26:58 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:26:58 - root - INFO - Structuring extracted text data
2025-11-07 15:26:58 - root - INFO - Starting table data structuring
2025-11-07 15:26:58 - root - DEBUG - Element 1: text='1 D 9.10cm', x=153.00, y=43.00, conf=0.998
2025-11-07 15:26:58 - root - DEBUG - Element 2: text='2 ', x=55.00, y=130.00, conf=0.817
2025-11-07 15:26:58 - root - DEBUG - Element 3: text='D 4.61cm', x=180.00, y=126.00, conf=0.999
2025-11-07 15:26:58 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:26:58 - root - DEBUG - Processing element 1/3: '1 D 9.10cm' at (153.00, 43.00)
2025-11-07 15:26:58 - root - DEBUG - Processing element 2/3: 'D 4.61cm' at (180.00, 126.00)
2025-11-07 15:26:58 - root - DEBUG - Processing element 3/3: '2 ' at (55.00, 130.00)
2025-11-07 15:26:58 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:26:58 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:26:58 - root - DEBUG - Processing word 1/1: '1 D 9.10cm'
2025-11-07 15:26:58 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:26:58 - root - DEBUG - Input text: '1 D 9.10cm'
2025-11-07 15:26:58 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:26:58 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:26:58 - root - DEBUG - Pattern 1 groups: ('1', 'D', '9.10cm')
2025-11-07 15:26:58 - root - DEBUG - Pattern 1 result: ('1', 'D', '9.10cm')
2025-11-07 15:26:58 - root - INFO - Text split successful using pattern 1: ('1', 'D', '9.10cm')
2025-11-07 15:26:58 - root - DEBUG - Split measurement result: ('1', 'D', '9.10cm')
2025-11-07 15:26:58 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:26:58 - root - DEBUG - Processing word 1/2: '2 '
2025-11-07 15:26:58 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:26:58 - root - DEBUG - Input text: '2'
2025-11-07 15:26:58 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:26:58 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:26:58 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:26:58 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:26:58 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:26:58 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:26:58 - root - DEBUG - Split measurement result: None
2025-11-07 15:26:58 - root - DEBUG - Processing word 2/2: 'D 4.61cm'
2025-11-07 15:26:58 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:26:58 - root - DEBUG - Input text: 'D 4.61cm'
2025-11-07 15:26:58 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:26:58 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:26:58 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:26:58 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:26:58 - root - DEBUG - Pattern 2 groups: ('D', '4.61cm')
2025-11-07 15:26:58 - root - DEBUG - Pattern 2 result: ('D', '4.61cm')
2025-11-07 15:26:58 - root - INFO - Text split successful using pattern 2: ('D', '4.61cm')
2025-11-07 15:26:58 - root - DEBUG - Split measurement result: ('D', '4.61cm')
2025-11-07 15:26:58 - root - DEBUG - Final structured data:
2025-11-07 15:26:58 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '9.10cm']}'
2025-11-07 15:26:58 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '4.61cm']}'
2025-11-07 15:26:58 - root - INFO - Table content extraction completed successfully
2025-11-07 15:26:58 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:26:58 - root - DEBUG - Organ identified: []
2025-11-07 15:26:59 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000008.dcm
2025-11-07 15:26:59 - root - INFO - Organ identified: []
2025-11-07 15:26:59 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 D 9.10cm', '2 D 4.61cm']}
2025-11-07 15:26:59 - root - INFO - Processing DICOM file 7/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000009.dcm
2025-11-07 15:26:59 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:26:59 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000009.dcm
2025-11-07 15:26:59 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:26:59 - root - INFO - DICOM file loaded successfully
2025-11-07 15:26:59 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:26:59 - root - INFO - Processing RGB format DICOM
2025-11-07 15:26:59 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:26:59 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:26:59 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:26:59 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:26:59 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:26:59 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:26:59 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:26:59 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:26:59 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:59 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:26:59 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:26:59 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:26:59 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:26:59 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:26:59 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:26:59 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:26:59 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:26:59 - root - INFO - Initializing OCRHandler
2025-11-07 15:26:59 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:26:59 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:26:59 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:26:59 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:26:59 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:26:59 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:26:59 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:00 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:00 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:00 - root - INFO - Initializing TableDetector
2025-11-07 15:27:00 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:00 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:00 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:00 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:00 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:00 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:00 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:00 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:00 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:00 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:00 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:00 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:00 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:00 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:00 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:00 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:00 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:00 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:00 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:00 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:00 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:00 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:00 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:00 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:00 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:00 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:00 - root - DEBUG - Edge detection completed
2025-11-07 15:27:00 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:00 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 197777
2025-11-07 15:27:00 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:00 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:00 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:00 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:00 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:00 - root - DEBUG - Line thickening completed
2025-11-07 15:27:00 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:00 - root - DEBUG - Line combination completed
2025-11-07 15:27:00 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:00 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:00 - root - INFO - Found 692 contours
2025-11-07 15:27:00 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:00 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:00 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:00 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:00 - root - INFO - Total candidate regions found: 65
2025-11-07 15:27:00 - root - DEBUG - Found 65 candidate regions
2025-11-07 15:27:00 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:00 - root - DEBUG - Line 1: '1 D 9.12cm' (conf: 1.000)
2025-11-07 15:27:00 - root - DEBUG - Line 2: '2 ' (conf: 0.850)
2025-11-07 15:27:00 - root - DEBUG - Line 3: 'D 3.49cm' (conf: 0.970)
2025-11-07 15:27:00 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:00 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:27:00 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:27:00 - root - DEBUG - Combined text: '1 d 9.12cm 2  d 3.49cm'
2025-11-07 15:27:00 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:00 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:00 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:00 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:00 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:00 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:27:00 - root - DEBUG - Pattern 1 found matches: ['9.12cm', '3.49cm']
2025-11-07 15:27:00 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:27:00 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:27:00 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:27:00 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:27:00 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:00 - root - INFO - Final measurement score: 8
2025-11-07 15:27:01 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:01 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:01 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:01 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:01 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:01 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:01 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:01 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:01 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:01 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:01 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:01 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:01 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:01 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:01 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:01 - root - INFO - Final measurement score: 0
2025-11-07 15:27:02 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:02 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:02 - root - DEBUG - Top 10 score indices: [1, 0, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:02 - root - DEBUG - Rank 1: Index 1, Score 8.000000
2025-11-07 15:27:02 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:27:02 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:02 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:02 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:02 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:02 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:02 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:02 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:02 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:02 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:27:02 - root - DEBUG - All top 10 scores:
2025-11-07 15:27:02 - root - DEBUG - Score index 1: 8.000000
2025-11-07 15:27:02 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:27:02 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:27:02 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:27:02 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:27:02 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:27:02 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:27:02 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:27:02 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:27:02 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:27:02 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:27:02 - root - DEBUG - Table detection completed. Candidates found: 65
2025-11-07 15:27:02 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:02 - root - INFO - Starting organ name identification
2025-11-07 15:27:02 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:02 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:02 - root - INFO - Starting organ label identification
2025-11-07 15:27:02 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:02 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:02 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:27:02 - root - DEBUG - Line 2: 'Voluson' (conf: 1.000)
2025-11-07 15:27:02 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.999)
2025-11-07 15:27:02 - root - DEBUG - Line 4: '58' (conf: 0.891)
2025-11-07 15:27:02 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:27:02 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.935)
2025-11-07 15:27:02 - root - DEBUG - Line 7: 'Gn -2' (conf: 0.993)
2025-11-07 15:27:02 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.886)
2025-11-07 15:27:02 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:27:02 - root - DEBUG - Line 10: 'RT KIDNEY' (conf: 1.000)
2025-11-07 15:27:02 - root - DEBUG - Line 11: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:27:02 - root - DEBUG - Line 12: '1 D 9.12cm' (conf: 0.999)
2025-11-07 15:27:02 - root - DEBUG - Line 13: '2 D 3.49cm' (conf: 0.995)
2025-11-07 15:27:02 - root - DEBUG - OCR completed. Processing 13 text lines for organ keywords
2025-11-07 15:27:02 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:27:02 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:27:02 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:27:02 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:27:02 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:02 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:27:02 - root - DEBUG - Line 6 text: 'Gn -2'
2025-11-07 15:27:02 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:27:02 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:27:02 - root - DEBUG - Line 9 text: 'RT KIDNEY'
2025-11-07 15:27:02 - root - DEBUG - Line 10 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:02 - root - DEBUG - Line 11 text: '1 D 9.12cm'
2025-11-07 15:27:02 - root - DEBUG - Line 12 text: '2 D 3.49cm'
2025-11-07 15:27:02 - root - DEBUG - Combined text for keyword search: '64/19hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -2 c7 / m15 ff2/e2 rt kidney sri ii 2 / cri 2 1 d 9.12cm 2 d 3.49cm'
2025-11-07 15:27:02 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:02 - root - DEBUG - Found organ keyword: 'kidney'
2025-11-07 15:27:02 - root - INFO - Organ identification completed. Found 1 organ keywords
2025-11-07 15:27:02 - root - INFO - Identified organs: ['kidney']
2025-11-07 15:27:02 - root - INFO - Organ identification completed successfully: ['kidney']
2025-11-07 15:27:02 - root - DEBUG - Organ identified: ['kidney']
2025-11-07 15:27:02 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:27:02 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:27:02 - root - DEBUG - Best score index: 1
2025-11-07 15:27:02 - root - INFO - Extracting structured data from detected table
2025-11-07 15:27:02 - root - INFO - Starting table content extraction
2025-11-07 15:27:02 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:27:02 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:27:02 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:27:02 - root - INFO - Starting table content extraction
2025-11-07 15:27:02 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:27:02 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:27:03 - root - DEBUG - Line 1: '1 D 9.12cm' (conf: 1.000)
2025-11-07 15:27:03 - root - DEBUG - Line 2: '2 ' (conf: 0.850)
2025-11-07 15:27:03 - root - DEBUG - Line 3: 'D 3.49cm' (conf: 0.970)
2025-11-07 15:27:03 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:27:03 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:27:03 - root - INFO - Structuring extracted text data
2025-11-07 15:27:03 - root - INFO - Starting table data structuring
2025-11-07 15:27:03 - root - DEBUG - Element 1: text='1 D 9.12cm', x=154.00, y=43.00, conf=1.000
2025-11-07 15:27:03 - root - DEBUG - Element 2: text='2 ', x=55.00, y=129.50, conf=0.850
2025-11-07 15:27:03 - root - DEBUG - Element 3: text='D 3.49cm', x=179.50, y=125.50, conf=0.970
2025-11-07 15:27:03 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:27:03 - root - DEBUG - Processing element 1/3: '1 D 9.12cm' at (154.00, 43.00)
2025-11-07 15:27:03 - root - DEBUG - Processing element 2/3: 'D 3.49cm' at (179.50, 125.50)
2025-11-07 15:27:03 - root - DEBUG - Processing element 3/3: '2 ' at (55.00, 129.50)
2025-11-07 15:27:03 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:27:03 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:27:03 - root - DEBUG - Processing word 1/1: '1 D 9.12cm'
2025-11-07 15:27:03 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:03 - root - DEBUG - Input text: '1 D 9.12cm'
2025-11-07 15:27:03 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:03 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:27:03 - root - DEBUG - Pattern 1 groups: ('1', 'D', '9.12cm')
2025-11-07 15:27:03 - root - DEBUG - Pattern 1 result: ('1', 'D', '9.12cm')
2025-11-07 15:27:03 - root - INFO - Text split successful using pattern 1: ('1', 'D', '9.12cm')
2025-11-07 15:27:03 - root - DEBUG - Split measurement result: ('1', 'D', '9.12cm')
2025-11-07 15:27:03 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:27:03 - root - DEBUG - Processing word 1/2: '2 '
2025-11-07 15:27:03 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:03 - root - DEBUG - Input text: '2'
2025-11-07 15:27:03 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:03 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:27:03 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:03 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:27:03 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:27:03 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:27:03 - root - DEBUG - Split measurement result: None
2025-11-07 15:27:03 - root - DEBUG - Processing word 2/2: 'D 3.49cm'
2025-11-07 15:27:03 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:03 - root - DEBUG - Input text: 'D 3.49cm'
2025-11-07 15:27:03 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:03 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:27:03 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:03 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:27:03 - root - DEBUG - Pattern 2 groups: ('D', '3.49cm')
2025-11-07 15:27:03 - root - DEBUG - Pattern 2 result: ('D', '3.49cm')
2025-11-07 15:27:03 - root - INFO - Text split successful using pattern 2: ('D', '3.49cm')
2025-11-07 15:27:03 - root - DEBUG - Split measurement result: ('D', '3.49cm')
2025-11-07 15:27:03 - root - DEBUG - Final structured data:
2025-11-07 15:27:03 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '9.12cm']}'
2025-11-07 15:27:03 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '3.49cm']}'
2025-11-07 15:27:03 - root - INFO - Table content extraction completed successfully
2025-11-07 15:27:03 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:27:03 - root - DEBUG - Organ identified: ['kidney']
2025-11-07 15:27:03 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000009.dcm
2025-11-07 15:27:03 - root - INFO - Organ identified: ['kidney']
2025-11-07 15:27:03 - root - DEBUG - Structured data extracted: {'organLabel': ['kidney'], 'value': ['1 D 9.12cm', '2 D 3.49cm']}
2025-11-07 15:27:03 - root - INFO - Processing DICOM file 8/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000010.dcm
2025-11-07 15:27:03 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:03 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000010.dcm
2025-11-07 15:27:03 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:03 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:03 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:03 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:03 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:03 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:03 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:03 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:03 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:03 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:03 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:03 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:03 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:03 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:03 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:03 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:03 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:03 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:03 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:03 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:03 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:03 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:03 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:03 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:03 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:03 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:03 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:03 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:03 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:04 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:04 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:04 - root - INFO - Initializing TableDetector
2025-11-07 15:27:04 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:04 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:04 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:04 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:04 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:04 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:04 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:04 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:04 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:04 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:04 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:04 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:04 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:04 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:04 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:04 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:04 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:04 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:04 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:04 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:04 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:04 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:04 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:04 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:04 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:04 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:04 - root - DEBUG - Edge detection completed
2025-11-07 15:27:04 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:04 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 225432
2025-11-07 15:27:04 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:04 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:04 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:04 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:04 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:04 - root - DEBUG - Line thickening completed
2025-11-07 15:27:04 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:04 - root - DEBUG - Line combination completed
2025-11-07 15:27:04 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:04 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:04 - root - INFO - Found 719 contours
2025-11-07 15:27:04 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:04 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:04 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:04 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:04 - root - INFO - Total candidate regions found: 55
2025-11-07 15:27:04 - root - DEBUG - Found 55 candidate regions
2025-11-07 15:27:04 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:05 - root - DEBUG - Line 1: '-' (conf: 0.526)
2025-11-07 15:27:05 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:05 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:05 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:05 - root - DEBUG - Combined text: '-'
2025-11-07 15:27:05 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:05 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:05 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:05 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:05 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:05 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:05 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:05 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:05 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:05 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:05 - root - INFO - Final measurement score: 0
2025-11-07 15:27:06 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:06 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:06 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:06 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:27:06 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:27:06 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:06 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:06 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:06 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:06 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:06 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:06 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:06 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:06 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:27:06 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:27:06 - root - DEBUG - Table detection completed. Candidates found: 55
2025-11-07 15:27:06 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:06 - root - INFO - Starting organ name identification
2025-11-07 15:27:06 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:06 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:06 - root - INFO - Starting organ label identification
2025-11-07 15:27:06 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:06 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:07 - root - DEBUG - Line 1: '64/12Hz' (conf: 1.000)
2025-11-07 15:27:07 - root - DEBUG - Line 2: '18cm/s' (conf: 0.999)
2025-11-07 15:27:07 - root - DEBUG - Line 3: 'Voluson' (conf: 0.992)
2025-11-07 15:27:07 - root - DEBUG - Line 4: 'Abdomen 1' (conf: 0.999)
2025-11-07 15:27:07 - root - DEBUG - Line 5: '58' (conf: 0.891)
2025-11-07 15:27:07 - root - DEBUG - Line 6: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:27:07 - root - DEBUG - Line 7: 'AO 100%' (conf: 0.935)
2025-11-07 15:27:07 - root - DEBUG - Line 8: 'Gn -3' (conf: 0.961)
2025-11-07 15:27:07 - root - DEBUG - Line 9: 'C7 / M15' (conf: 0.886)
2025-11-07 15:27:07 - root - DEBUG - Line 10: 'FF2/E2' (conf: 0.994)
2025-11-07 15:27:07 - root - DEBUG - Line 11: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:27:07 - root - DEBUG - Line 12: 'AO 100%' (conf: 0.975)
2025-11-07 15:27:07 - root - DEBUG - Line 13: 'Gn -4.2' (conf: 0.937)
2025-11-07 15:27:07 - root - DEBUG - Line 14: 'Frq mid' (conf: 1.000)
2025-11-07 15:27:07 - root - DEBUG - Line 15: 'Qual norm' (conf: 0.998)
2025-11-07 15:27:07 - root - DEBUG - Line 16: '-18cmt/s' (conf: 0.847)
2025-11-07 15:27:07 - root - DEBUG - Line 17: 'WMF low1' (conf: 0.985)
2025-11-07 15:27:07 - root - DEBUG - Line 18: 'PRF 1.3kHz' (conf: 1.000)
2025-11-07 15:27:07 - root - DEBUG - OCR completed. Processing 18 text lines for organ keywords
2025-11-07 15:27:07 - root - DEBUG - Line 0 text: '64/12Hz'
2025-11-07 15:27:07 - root - DEBUG - Line 1 text: '18cm/s'
2025-11-07 15:27:07 - root - DEBUG - Line 2 text: 'Voluson'
2025-11-07 15:27:07 - root - DEBUG - Line 3 text: 'Abdomen 1'
2025-11-07 15:27:07 - root - DEBUG - Line 4 text: '58'
2025-11-07 15:27:07 - root - DEBUG - Line 5 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:07 - root - DEBUG - Line 6 text: 'AO 100%'
2025-11-07 15:27:07 - root - DEBUG - Line 7 text: 'Gn -3'
2025-11-07 15:27:07 - root - DEBUG - Line 8 text: 'C7 / M15'
2025-11-07 15:27:07 - root - DEBUG - Line 9 text: 'FF2/E2'
2025-11-07 15:27:07 - root - DEBUG - Line 10 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:07 - root - DEBUG - Line 11 text: 'AO 100%'
2025-11-07 15:27:07 - root - DEBUG - Line 12 text: 'Gn -4.2'
2025-11-07 15:27:07 - root - DEBUG - Line 13 text: 'Frq mid'
2025-11-07 15:27:07 - root - DEBUG - Line 14 text: 'Qual norm'
2025-11-07 15:27:07 - root - DEBUG - Line 15 text: '-18cmt/s'
2025-11-07 15:27:07 - root - DEBUG - Line 16 text: 'WMF low1'
2025-11-07 15:27:07 - root - DEBUG - Line 17 text: 'PRF 1.3kHz'
2025-11-07 15:27:07 - root - DEBUG - Combined text for keyword search: '64/12hz 18cm/s voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -3 c7 / m15 ff2/e2 sri ii 2 / cri 2 ao 100% gn -4.2 frq mid qual norm -18cmt/s wmf low1 prf 1.3khz'
2025-11-07 15:27:07 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:07 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:07 - root - INFO - Identified organs: []
2025-11-07 15:27:07 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:07 - root - DEBUG - Organ identified: []
2025-11-07 15:27:07 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:27:07 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000010.dcm
2025-11-07 15:27:07 - root - INFO - Processing DICOM file 9/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000011.dcm
2025-11-07 15:27:07 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:07 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000011.dcm
2025-11-07 15:27:07 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:07 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:07 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:07 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:07 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:07 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:07 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:07 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:07 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:07 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:07 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:07 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:07 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:07 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:07 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:07 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:07 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:07 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:07 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:07 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:07 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:07 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:07 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:07 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:07 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:07 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:07 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:07 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:07 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:08 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:08 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:08 - root - INFO - Initializing TableDetector
2025-11-07 15:27:08 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:08 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:08 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:08 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:08 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:08 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:08 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:08 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:08 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:08 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:08 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:08 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:08 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:08 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:08 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:08 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:08 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:08 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:08 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:08 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:08 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:08 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:08 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:08 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:08 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:08 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:08 - root - DEBUG - Edge detection completed
2025-11-07 15:27:08 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:08 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 360875
2025-11-07 15:27:08 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:08 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:08 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:08 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:08 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:08 - root - DEBUG - Line thickening completed
2025-11-07 15:27:08 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:08 - root - DEBUG - Line combination completed
2025-11-07 15:27:08 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:08 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:08 - root - INFO - Found 619 contours
2025-11-07 15:27:08 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:08 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:08 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:08 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:08 - root - INFO - Total candidate regions found: 152
2025-11-07 15:27:08 - root - DEBUG - Found 152 candidate regions
2025-11-07 15:27:08 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:10 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:10 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:10 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:10 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:10 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:10 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:10 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:10 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:10 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:10 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:10 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:10 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:10 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:10 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:10 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:10 - root - INFO - Final measurement score: 0
2025-11-07 15:27:11 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:11 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:11 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:11 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:27:11 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:27:11 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:11 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:11 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:11 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:11 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:11 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:11 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:11 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:11 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:27:11 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:27:11 - root - DEBUG - Table detection completed. Candidates found: 152
2025-11-07 15:27:11 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:11 - root - INFO - Starting organ name identification
2025-11-07 15:27:11 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:11 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:11 - root - INFO - Starting organ label identification
2025-11-07 15:27:11 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:11 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:12 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:27:12 - root - DEBUG - Line 2: 'Voluson' (conf: 1.000)
2025-11-07 15:27:12 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.989)
2025-11-07 15:27:12 - root - DEBUG - Line 4: '58' (conf: 0.915)
2025-11-07 15:27:12 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.927)
2025-11-07 15:27:12 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.935)
2025-11-07 15:27:12 - root - DEBUG - Line 7: 'Gn -6' (conf: 0.975)
2025-11-07 15:27:12 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.886)
2025-11-07 15:27:12 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:27:12 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.974)
2025-11-07 15:27:12 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:27:12 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:27:12 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:27:12 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:27:12 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:27:12 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:12 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:27:12 - root - DEBUG - Line 6 text: 'Gn -6'
2025-11-07 15:27:12 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:27:12 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:27:12 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:12 - root - DEBUG - Combined text for keyword search: '64/19hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -6 c7 / m15 ff2/e2 sri ii 2 / cri 2'
2025-11-07 15:27:12 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:12 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:12 - root - INFO - Identified organs: []
2025-11-07 15:27:12 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:12 - root - DEBUG - Organ identified: []
2025-11-07 15:27:12 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:27:12 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000011.dcm
2025-11-07 15:27:12 - root - INFO - Processing DICOM file 10/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000012.dcm
2025-11-07 15:27:12 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:12 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000012.dcm
2025-11-07 15:27:12 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:12 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:12 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:12 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:12 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:12 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:12 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:12 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:12 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:12 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:12 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:12 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:12 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:12 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:12 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:12 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:12 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:12 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:12 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:12 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:12 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:12 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:12 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:12 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:12 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:12 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:12 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:12 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:12 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:14 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:14 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:14 - root - INFO - Initializing TableDetector
2025-11-07 15:27:14 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:14 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:14 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:14 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:14 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:14 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:14 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:14 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:14 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:14 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:14 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:14 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:14 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:14 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:14 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:14 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:14 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:14 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:14 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:14 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:14 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:14 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:14 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:14 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:14 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:14 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:14 - root - DEBUG - Edge detection completed
2025-11-07 15:27:14 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:14 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 285006
2025-11-07 15:27:14 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:14 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:14 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:14 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:14 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:14 - root - DEBUG - Line thickening completed
2025-11-07 15:27:14 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:14 - root - DEBUG - Line combination completed
2025-11-07 15:27:14 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:14 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:14 - root - INFO - Found 549 contours
2025-11-07 15:27:14 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:14 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:14 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:14 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:14 - root - INFO - Total candidate regions found: 97
2025-11-07 15:27:14 - root - DEBUG - Found 97 candidate regions
2025-11-07 15:27:14 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:16 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:16 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:16 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:16 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:16 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:16 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:16 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:16 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:16 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:16 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:16 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:16 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:16 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:16 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:16 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:16 - root - INFO - Final measurement score: 0
2025-11-07 15:27:17 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:17 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:17 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:17 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:27:17 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:27:17 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:17 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:17 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:17 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:17 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:17 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:17 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:17 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:17 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:27:17 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:27:17 - root - DEBUG - Table detection completed. Candidates found: 97
2025-11-07 15:27:17 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:17 - root - INFO - Starting organ name identification
2025-11-07 15:27:17 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:17 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:17 - root - INFO - Starting organ label identification
2025-11-07 15:27:17 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:17 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:18 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:27:18 - root - DEBUG - Line 2: 'Voluson' (conf: 1.000)
2025-11-07 15:27:18 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.989)
2025-11-07 15:27:18 - root - DEBUG - Line 4: '58' (conf: 0.915)
2025-11-07 15:27:18 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.927)
2025-11-07 15:27:18 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.938)
2025-11-07 15:27:18 - root - DEBUG - Line 7: 'Gn -11' (conf: 0.980)
2025-11-07 15:27:18 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.908)
2025-11-07 15:27:18 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:27:18 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.974)
2025-11-07 15:27:18 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:27:18 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:27:18 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:27:18 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:27:18 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:27:18 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:18 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:27:18 - root - DEBUG - Line 6 text: 'Gn -11'
2025-11-07 15:27:18 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:27:18 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:27:18 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:18 - root - DEBUG - Combined text for keyword search: '64/19hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -11 c7 / m15 ff2/e2 sri ii 2 / cri 2'
2025-11-07 15:27:18 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:18 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:18 - root - INFO - Identified organs: []
2025-11-07 15:27:18 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:18 - root - DEBUG - Organ identified: []
2025-11-07 15:27:18 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:27:18 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000012.dcm
2025-11-07 15:27:18 - root - INFO - Processing DICOM file 11/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000013.dcm
2025-11-07 15:27:18 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:18 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000013.dcm
2025-11-07 15:27:18 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:18 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:18 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:18 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:18 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:18 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:18 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:18 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:18 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:18 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:18 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:18 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:18 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:18 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:18 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:18 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:18 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:18 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:18 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:18 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:18 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:18 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:18 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:18 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:18 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:18 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:18 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:18 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:18 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:19 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:19 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:19 - root - INFO - Initializing TableDetector
2025-11-07 15:27:19 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:19 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:19 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:19 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:19 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:19 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:19 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:19 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:19 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:19 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:19 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:19 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:19 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:19 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:19 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:19 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:19 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:19 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:19 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:19 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:19 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:19 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:19 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:19 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:19 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:19 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:19 - root - DEBUG - Edge detection completed
2025-11-07 15:27:19 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:19 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 341265
2025-11-07 15:27:19 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:19 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:19 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:20 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:20 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:20 - root - DEBUG - Line thickening completed
2025-11-07 15:27:20 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:20 - root - DEBUG - Line combination completed
2025-11-07 15:27:20 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:20 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:20 - root - INFO - Found 681 contours
2025-11-07 15:27:20 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:20 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:20 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:20 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:20 - root - INFO - Total candidate regions found: 137
2025-11-07 15:27:20 - root - DEBUG - Found 137 candidate regions
2025-11-07 15:27:20 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:22 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:22 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:22 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:22 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:22 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:22 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:22 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:22 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:22 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:22 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:22 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:22 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:22 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:22 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:22 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:22 - root - INFO - Final measurement score: 0
2025-11-07 15:27:22 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:22 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:22 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:22 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:27:22 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:27:22 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:22 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:22 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:22 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:22 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:22 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:22 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:22 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:22 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:27:22 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:27:22 - root - DEBUG - Table detection completed. Candidates found: 137
2025-11-07 15:27:22 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:22 - root - INFO - Starting organ name identification
2025-11-07 15:27:22 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:22 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:22 - root - INFO - Starting organ label identification
2025-11-07 15:27:22 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:22 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:23 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:27:23 - root - DEBUG - Line 2: 'Voluson' (conf: 1.000)
2025-11-07 15:27:23 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.989)
2025-11-07 15:27:23 - root - DEBUG - Line 4: '58' (conf: 0.915)
2025-11-07 15:27:23 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.927)
2025-11-07 15:27:23 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.938)
2025-11-07 15:27:23 - root - DEBUG - Line 7: 'Gn -11' (conf: 0.980)
2025-11-07 15:27:23 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.908)
2025-11-07 15:27:23 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.930)
2025-11-07 15:27:23 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.974)
2025-11-07 15:27:23 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:27:23 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:27:23 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:27:23 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:27:23 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:27:23 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:23 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:27:23 - root - DEBUG - Line 6 text: 'Gn -11'
2025-11-07 15:27:23 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:27:23 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:27:23 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:23 - root - DEBUG - Combined text for keyword search: '64/19hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -11 c7 / m15 ff2/e2 sri ii 2 / cri 2'
2025-11-07 15:27:23 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:23 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:23 - root - INFO - Identified organs: []
2025-11-07 15:27:23 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:23 - root - DEBUG - Organ identified: []
2025-11-07 15:27:23 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:27:23 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000013.dcm
2025-11-07 15:27:23 - root - INFO - Processing DICOM file 12/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000014.dcm
2025-11-07 15:27:23 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:23 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000014.dcm
2025-11-07 15:27:23 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:23 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:23 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:23 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:23 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:23 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:23 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:23 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:23 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:23 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:23 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:23 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:23 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:23 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:23 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:23 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:23 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:23 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:23 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:23 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:23 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:23 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:23 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:23 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:23 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:23 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:23 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:23 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:23 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:24 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:24 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:24 - root - INFO - Initializing TableDetector
2025-11-07 15:27:24 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:24 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:24 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:24 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:24 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:24 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:24 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:24 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:24 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:24 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:24 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:24 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:24 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:24 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:24 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:24 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:24 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:24 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:24 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:24 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:24 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:24 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:24 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:24 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:24 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:24 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:24 - root - DEBUG - Edge detection completed
2025-11-07 15:27:24 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:24 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 271872
2025-11-07 15:27:24 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:24 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:24 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:24 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:24 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:24 - root - DEBUG - Line thickening completed
2025-11-07 15:27:24 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:24 - root - DEBUG - Line combination completed
2025-11-07 15:27:24 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:24 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:24 - root - INFO - Found 530 contours
2025-11-07 15:27:24 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:24 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:24 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:24 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:24 - root - INFO - Total candidate regions found: 82
2025-11-07 15:27:24 - root - DEBUG - Found 82 candidate regions
2025-11-07 15:27:24 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:26 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:26 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:26 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:26 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:26 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:26 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:26 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:26 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:26 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:26 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:26 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:26 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:26 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:26 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:26 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:26 - root - INFO - Final measurement score: 0
2025-11-07 15:27:26 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:26 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:26 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:26 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:27:26 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:27:26 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:26 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:26 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:26 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:26 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:26 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:26 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:26 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:26 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:27:26 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:27:26 - root - DEBUG - Table detection completed. Candidates found: 82
2025-11-07 15:27:26 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:26 - root - INFO - Starting organ name identification
2025-11-07 15:27:26 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:26 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:26 - root - INFO - Starting organ label identification
2025-11-07 15:27:26 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:26 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:27 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:27:27 - root - DEBUG - Line 2: 'Abdomen 1' (conf: 0.989)
2025-11-07 15:27:27 - root - DEBUG - Line 3: 'Voluson' (conf: 0.996)
2025-11-07 15:27:27 - root - DEBUG - Line 4: '58' (conf: 0.891)
2025-11-07 15:27:27 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.927)
2025-11-07 15:27:27 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.938)
2025-11-07 15:27:27 - root - DEBUG - Line 7: 'Gn -10' (conf: 0.990)
2025-11-07 15:27:27 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.908)
2025-11-07 15:27:27 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.930)
2025-11-07 15:27:27 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.974)
2025-11-07 15:27:27 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:27:27 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:27:27 - root - DEBUG - Line 1 text: 'Abdomen 1'
2025-11-07 15:27:27 - root - DEBUG - Line 2 text: 'Voluson'
2025-11-07 15:27:27 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:27:27 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:27 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:27:27 - root - DEBUG - Line 6 text: 'Gn -10'
2025-11-07 15:27:27 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:27:27 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:27:27 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:27 - root - DEBUG - Combined text for keyword search: '64/19hz abdomen 1 voluson 58 hm pi 7.70 - 2.10 ao 100% gn -10 c7 / m15 ff2/e2 sri ii 2 / cri 2'
2025-11-07 15:27:27 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:27 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:27 - root - INFO - Identified organs: []
2025-11-07 15:27:27 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:27 - root - DEBUG - Organ identified: []
2025-11-07 15:27:27 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:27:27 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000014.dcm
2025-11-07 15:27:27 - root - INFO - Processing DICOM file 13/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000015.dcm
2025-11-07 15:27:27 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:27 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000015.dcm
2025-11-07 15:27:27 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:27 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:27 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:27 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:27 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:27 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:27 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:27 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:27 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:27 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:27 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:27 - root - DEBUG - Raw coordinates - minx0: [0, 569], miny0: [66, 66], maxx1: [567, 1136], maxy1: [852, 852]
2025-11-07 15:27:27 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:27 - root - INFO - Multiple regions detected (2 regions), calculating combined bounds
2025-11-07 15:27:27 - root - DEBUG - Combined bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:27 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:27 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:27 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:27 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:27 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:27 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:27 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:27 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:27 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:27 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:27 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:27 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:27 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:27 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:28 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:28 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:28 - root - INFO - Initializing TableDetector
2025-11-07 15:27:28 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:28 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:28 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:28 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:28 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:28 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:28 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:28 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:28 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:28 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:28 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:28 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:28 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:28 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:28 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:28 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:28 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:28 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:28 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:28 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:28 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:28 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:28 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:28 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:28 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:28 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:28 - root - DEBUG - Edge detection completed
2025-11-07 15:27:28 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:28 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 475008
2025-11-07 15:27:28 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:28 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:28 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:28 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:28 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:28 - root - DEBUG - Line thickening completed
2025-11-07 15:27:28 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:28 - root - DEBUG - Line combination completed
2025-11-07 15:27:28 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:28 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:28 - root - INFO - Found 1220 contours
2025-11-07 15:27:28 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:28 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:28 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:28 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:28 - root - INFO - Total candidate regions found: 200
2025-11-07 15:27:28 - root - DEBUG - Found 200 candidate regions
2025-11-07 15:27:28 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:28 - root - DEBUG - Line 1: '90' (conf: 0.996)
2025-11-07 15:27:28 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:28 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:28 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:28 - root - DEBUG - Combined text: '90'
2025-11-07 15:27:28 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:28 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:28 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:28 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:28 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:28 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:28 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:28 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:28 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:28 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:28 - root - INFO - Final measurement score: 0
2025-11-07 15:27:29 - root - DEBUG - Line 1: '1 L 9.18cm' (conf: 0.997)
2025-11-07 15:27:29 - root - DEBUG - Line 2: '2 L4.22cm' (conf: 1.000)
2025-11-07 15:27:29 - root - DEBUG - Line 3: '3 L 4.90cm' (conf: 0.980)
2025-11-07 15:27:29 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:29 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:27:29 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:27:29 - root - DEBUG - Combined text: '1 l 9.18cm 2 l4.22cm 3 l 4.90cm'
2025-11-07 15:27:29 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:29 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:29 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:29 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:29 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:29 - root - DEBUG - Pattern 1 matches: 3
2025-11-07 15:27:29 - root - DEBUG - Pattern 1 found matches: ['9.18cm', '4.22cm', '4.90cm']
2025-11-07 15:27:29 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:27:29 - root - DEBUG - Pattern 2 found matches: ['l', 'l']
2025-11-07 15:27:29 - root - DEBUG - Base score from pattern matching: 5
2025-11-07 15:27:29 - root - DEBUG - 'cm' occurrences: 3, bonus added: 6
2025-11-07 15:27:29 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:29 - root - INFO - Final measurement score: 11
2025-11-07 15:27:31 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:31 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:31 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:31 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:31 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:31 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:31 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:31 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:31 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:31 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:31 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:31 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:31 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:31 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:31 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:31 - root - INFO - Final measurement score: 0
2025-11-07 15:27:33 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:33 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:33 - root - DEBUG - Top 10 score indices: [5, 0, 1, 2, 3, 4, 6, 7, 8, 9]
2025-11-07 15:27:33 - root - DEBUG - Rank 1: Index 5, Score 11.000000
2025-11-07 15:27:33 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:27:33 - root - DEBUG - Rank 3: Index 1, Score 0.000000
2025-11-07 15:27:33 - root - DEBUG - Rank 4: Index 2, Score 0.000000
2025-11-07 15:27:33 - root - DEBUG - Rank 5: Index 3, Score 0.000000
2025-11-07 15:27:33 - root - DEBUG - Rank 6: Index 4, Score 0.000000
2025-11-07 15:27:33 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:33 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:33 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:33 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:33 - root - INFO - Best candidate meets threshold (>= 4). Score: 11.000000
2025-11-07 15:27:33 - root - DEBUG - All top 10 scores:
2025-11-07 15:27:33 - root - DEBUG - Score index 5: 11.000000
2025-11-07 15:27:33 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:27:33 - root - DEBUG - Score index 1: 0.000000
2025-11-07 15:27:33 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:27:33 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:27:33 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:27:33 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:27:33 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:27:33 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:27:33 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:27:33 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:27:33 - root - DEBUG - Table detection completed. Candidates found: 200
2025-11-07 15:27:33 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:33 - root - INFO - Starting organ name identification
2025-11-07 15:27:33 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:33 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:33 - root - INFO - Starting organ label identification
2025-11-07 15:27:33 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:33 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:34 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:27:34 - root - DEBUG - Line 2: 'Voluson' (conf: 0.995)
2025-11-07 15:27:34 - root - DEBUG - Line 3: 'Voluson' (conf: 0.993)
2025-11-07 15:27:34 - root - DEBUG - Line 4: 'Abdomen 1' (conf: 0.980)
2025-11-07 15:27:34 - root - DEBUG - Line 5: 'S8' (conf: 0.731)
2025-11-07 15:27:34 - root - DEBUG - Line 6: '58' (conf: 0.795)
2025-11-07 15:27:34 - root - DEBUG - Line 7: 'HM PI 7.70 - 2.10' (conf: 0.954)
2025-11-07 15:27:34 - root - DEBUG - Line 8: 'AO 100%' (conf: 0.931)
2025-11-07 15:27:34 - root - DEBUG - Line 9: 'Gn 5' (conf: 0.965)
2025-11-07 15:27:34 - root - DEBUG - Line 10: 'C7 /_M15' (conf: 0.984)
2025-11-07 15:27:34 - root - DEBUG - Line 11: 'FF2/E2' (conf: 0.994)
2025-11-07 15:27:34 - root - DEBUG - Line 12: 'SRI II 2 / CRI 2' (conf: 0.983)
2025-11-07 15:27:34 - root - DEBUG - Line 13: '4' (conf: 0.527)
2025-11-07 15:27:34 - root - DEBUG - Line 14: 'L 9.18cm' (conf: 0.996)
2025-11-07 15:27:34 - root - DEBUG - Line 15: 'L 4.22cm' (conf: 0.993)
2025-11-07 15:27:34 - root - DEBUG - Line 16: '3 L 4.90cm' (conf: 0.959)
2025-11-07 15:27:34 - root - DEBUG - OCR completed. Processing 16 text lines for organ keywords
2025-11-07 15:27:34 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:27:34 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:27:34 - root - DEBUG - Line 2 text: 'Voluson'
2025-11-07 15:27:34 - root - DEBUG - Line 3 text: 'Abdomen 1'
2025-11-07 15:27:34 - root - DEBUG - Line 4 text: 'S8'
2025-11-07 15:27:34 - root - DEBUG - Line 5 text: '58'
2025-11-07 15:27:34 - root - DEBUG - Line 6 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:34 - root - DEBUG - Line 7 text: 'AO 100%'
2025-11-07 15:27:34 - root - DEBUG - Line 8 text: 'Gn 5'
2025-11-07 15:27:34 - root - DEBUG - Line 9 text: 'C7 /_M15'
2025-11-07 15:27:34 - root - DEBUG - Line 10 text: 'FF2/E2'
2025-11-07 15:27:34 - root - DEBUG - Line 11 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:34 - root - DEBUG - Line 12 text: '4'
2025-11-07 15:27:34 - root - DEBUG - Line 13 text: 'L 9.18cm'
2025-11-07 15:27:34 - root - DEBUG - Line 14 text: 'L 4.22cm'
2025-11-07 15:27:34 - root - DEBUG - Line 15 text: '3 L 4.90cm'
2025-11-07 15:27:34 - root - DEBUG - Combined text for keyword search: '64/19hz voluson voluson abdomen 1 s8 58 hm pi 7.70 - 2.10 ao 100% gn 5 c7 /_m15 ff2/e2 sri ii 2 / cri 2 4 l 9.18cm l 4.22cm 3 l 4.90cm'
2025-11-07 15:27:34 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:34 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:34 - root - INFO - Identified organs: []
2025-11-07 15:27:34 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:34 - root - DEBUG - Organ identified: []
2025-11-07 15:27:34 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:27:34 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:27:34 - root - DEBUG - Best score index: 5
2025-11-07 15:27:34 - root - INFO - Extracting structured data from detected table
2025-11-07 15:27:34 - root - INFO - Starting table content extraction
2025-11-07 15:27:34 - root - DEBUG - Bounding box coordinates: (3122, 2057, 282, 246)
2025-11-07 15:27:34 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:27:34 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:27:34 - root - INFO - Starting table content extraction
2025-11-07 15:27:34 - root - DEBUG - Bounding box coordinates: (3122, 2057, 282, 246)
2025-11-07 15:27:34 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:27:34 - root - DEBUG - Line 1: '1 L 9.18cm' (conf: 0.997)
2025-11-07 15:27:34 - root - DEBUG - Line 2: '2 L4.22cm' (conf: 1.000)
2025-11-07 15:27:34 - root - DEBUG - Line 3: '3 L 4.90cm' (conf: 0.980)
2025-11-07 15:27:34 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:27:34 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:27:34 - root - INFO - Structuring extracted text data
2025-11-07 15:27:34 - root - INFO - Starting table data structuring
2025-11-07 15:27:34 - root - DEBUG - Element 1: text='1 L 9.18cm', x=149.00, y=42.00, conf=0.997
2025-11-07 15:27:34 - root - DEBUG - Element 2: text='2 L4.22cm', x=147.00, y=126.00, conf=1.000
2025-11-07 15:27:34 - root - DEBUG - Element 3: text='3 L 4.90cm', x=146.00, y=211.00, conf=0.980
2025-11-07 15:27:34 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:27:34 - root - DEBUG - Processing element 1/3: '1 L 9.18cm' at (149.00, 42.00)
2025-11-07 15:27:34 - root - DEBUG - Processing element 2/3: '2 L4.22cm' at (147.00, 126.00)
2025-11-07 15:27:34 - root - DEBUG - Processing element 3/3: '3 L 4.90cm' at (146.00, 211.00)
2025-11-07 15:27:34 - root - INFO - Line grouping completed - Total lines: 3
2025-11-07 15:27:34 - root - DEBUG - Processing line 1/3 with 1 elements
2025-11-07 15:27:34 - root - DEBUG - Processing word 1/1: '1 L 9.18cm'
2025-11-07 15:27:34 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:34 - root - DEBUG - Input text: '1 L 9.18cm'
2025-11-07 15:27:34 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:34 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:27:34 - root - DEBUG - Pattern 1 groups: ('1', 'L', '9.18cm')
2025-11-07 15:27:34 - root - DEBUG - Pattern 1 result: ('1', 'L', '9.18cm')
2025-11-07 15:27:34 - root - INFO - Text split successful using pattern 1: ('1', 'L', '9.18cm')
2025-11-07 15:27:34 - root - DEBUG - Split measurement result: ('1', 'L', '9.18cm')
2025-11-07 15:27:34 - root - DEBUG - Processing line 2/3 with 1 elements
2025-11-07 15:27:34 - root - DEBUG - Processing word 1/1: '2 L4.22cm'
2025-11-07 15:27:34 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:34 - root - DEBUG - Input text: '2 L4.22cm'
2025-11-07 15:27:34 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:34 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:27:34 - root - DEBUG - Pattern 1 groups: ('2', 'L4', '22cm')
2025-11-07 15:27:34 - root - DEBUG - Pattern 1 result: ('2', 'L4', '22cm')
2025-11-07 15:27:34 - root - INFO - Text split successful using pattern 1: ('2', 'L4', '22cm')
2025-11-07 15:27:34 - root - DEBUG - Split measurement result: ('2', 'L4', '22cm')
2025-11-07 15:27:34 - root - DEBUG - Processing line 3/3 with 1 elements
2025-11-07 15:27:34 - root - DEBUG - Processing word 1/1: '3 L 4.90cm'
2025-11-07 15:27:34 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:34 - root - DEBUG - Input text: '3 L 4.90cm'
2025-11-07 15:27:34 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:34 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:27:34 - root - DEBUG - Pattern 1 groups: ('3', 'L', '4.90cm')
2025-11-07 15:27:34 - root - DEBUG - Pattern 1 result: ('3', 'L', '4.90cm')
2025-11-07 15:27:34 - root - INFO - Text split successful using pattern 1: ('3', 'L', '4.90cm')
2025-11-07 15:27:34 - root - DEBUG - Split measurement result: ('3', 'L', '4.90cm')
2025-11-07 15:27:34 - root - DEBUG - Final structured data:
2025-11-07 15:27:34 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'L', '9.18cm']}'
2025-11-07 15:27:34 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'L4', '22cm']}'
2025-11-07 15:27:34 - root - DEBUG - Item 3 (text): '{'Value3': ['3', 'L', '4.90cm']}'
2025-11-07 15:27:34 - root - INFO - Table content extraction completed successfully
2025-11-07 15:27:34 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:27:34 - root - DEBUG - Organ identified: []
2025-11-07 15:27:34 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000015.dcm
2025-11-07 15:27:34 - root - INFO - Organ identified: []
2025-11-07 15:27:34 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 L 9.18cm', '2 L4 22cm', '3 L 4.90cm']}
2025-11-07 15:27:34 - root - INFO - Processing DICOM file 14/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000016.dcm
2025-11-07 15:27:34 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:34 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000016.dcm
2025-11-07 15:27:34 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:34 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:34 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:34 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:34 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:34 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:34 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:34 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:34 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:34 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:34 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:34 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:34 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:34 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:34 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:34 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:34 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:34 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:34 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:34 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:34 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:34 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:34 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:34 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:34 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:34 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:34 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:34 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:34 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:35 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:35 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:35 - root - INFO - Initializing TableDetector
2025-11-07 15:27:35 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:35 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:35 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:35 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:35 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:35 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:35 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:35 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:35 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:35 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:35 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:35 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:35 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:35 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:35 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:35 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:35 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:35 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:35 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:35 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:35 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:35 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:35 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:35 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:35 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:35 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:35 - root - DEBUG - Edge detection completed
2025-11-07 15:27:35 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:35 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 228385
2025-11-07 15:27:35 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:35 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:35 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:35 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:35 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:35 - root - DEBUG - Line thickening completed
2025-11-07 15:27:35 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:35 - root - DEBUG - Line combination completed
2025-11-07 15:27:35 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:35 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:35 - root - INFO - Found 557 contours
2025-11-07 15:27:35 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:35 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:35 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:35 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:35 - root - INFO - Total candidate regions found: 87
2025-11-07 15:27:35 - root - DEBUG - Found 87 candidate regions
2025-11-07 15:27:35 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:37 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:37 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:37 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:37 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:37 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:37 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:37 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:37 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:37 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:37 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:37 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:37 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:37 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:37 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:37 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:37 - root - INFO - Final measurement score: 0
2025-11-07 15:27:38 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:38 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:38 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:38 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:27:38 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:27:38 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:38 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:38 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:38 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:38 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:38 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:38 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:38 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:38 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:27:38 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:27:38 - root - DEBUG - Table detection completed. Candidates found: 87
2025-11-07 15:27:38 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:38 - root - INFO - Starting organ name identification
2025-11-07 15:27:38 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:38 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:38 - root - INFO - Starting organ label identification
2025-11-07 15:27:38 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:38 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:39 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:27:39 - root - DEBUG - Line 2: 'Voluson' (conf: 0.995)
2025-11-07 15:27:39 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.997)
2025-11-07 15:27:39 - root - DEBUG - Line 4: '58' (conf: 0.915)
2025-11-07 15:27:39 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:27:39 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.938)
2025-11-07 15:27:39 - root - DEBUG - Line 7: 'Gn -19' (conf: 0.993)
2025-11-07 15:27:39 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.908)
2025-11-07 15:27:39 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.930)
2025-11-07 15:27:39 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:27:39 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:27:39 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:27:39 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:27:39 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:27:39 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:27:39 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:39 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:27:39 - root - DEBUG - Line 6 text: 'Gn -19'
2025-11-07 15:27:39 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:27:39 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:27:39 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:39 - root - DEBUG - Combined text for keyword search: '64/19hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -19 c7 / m15 ff2/e2 sri ii 2 / cri 2'
2025-11-07 15:27:39 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:39 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:39 - root - INFO - Identified organs: []
2025-11-07 15:27:39 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:39 - root - DEBUG - Organ identified: []
2025-11-07 15:27:39 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:27:39 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000016.dcm
2025-11-07 15:27:39 - root - INFO - Processing DICOM file 15/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000017.dcm
2025-11-07 15:27:39 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:39 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000017.dcm
2025-11-07 15:27:39 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:39 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:39 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:39 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:39 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:39 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:39 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:39 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:39 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:39 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:39 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:39 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:39 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:39 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:39 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:39 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:39 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:39 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:39 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:39 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:39 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:39 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:39 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:39 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:39 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:39 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:39 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:39 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:39 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:40 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:40 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:40 - root - INFO - Initializing TableDetector
2025-11-07 15:27:40 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:40 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:40 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:40 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:40 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:40 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:40 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:40 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:40 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:40 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:40 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:40 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:40 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:40 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:40 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:40 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:40 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:40 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:40 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:40 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:40 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:40 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:40 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:40 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:40 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:40 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:40 - root - DEBUG - Edge detection completed
2025-11-07 15:27:40 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:40 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 410775
2025-11-07 15:27:40 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:40 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:40 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:40 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:40 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:40 - root - DEBUG - Line thickening completed
2025-11-07 15:27:40 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:40 - root - DEBUG - Line combination completed
2025-11-07 15:27:40 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:40 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:40 - root - INFO - Found 696 contours
2025-11-07 15:27:40 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:40 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:40 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:40 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:40 - root - INFO - Total candidate regions found: 137
2025-11-07 15:27:40 - root - DEBUG - Found 137 candidate regions
2025-11-07 15:27:40 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:43 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:43 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:43 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:43 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:43 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:43 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:43 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:43 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:43 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:43 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:43 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:43 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:43 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:43 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:43 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:43 - root - INFO - Final measurement score: 0
2025-11-07 15:27:44 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:44 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:44 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:44 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:27:44 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:27:44 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:44 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:44 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:44 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:44 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:44 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:44 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:44 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:44 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:27:44 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:27:44 - root - DEBUG - Table detection completed. Candidates found: 137
2025-11-07 15:27:44 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:44 - root - INFO - Starting organ name identification
2025-11-07 15:27:44 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:44 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:44 - root - INFO - Starting organ label identification
2025-11-07 15:27:44 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:44 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:45 - root - DEBUG - Line 1: '64/ 21Hz' (conf: 0.957)
2025-11-07 15:27:45 - root - DEBUG - Line 2: 'Voluson' (conf: 0.973)
2025-11-07 15:27:45 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.989)
2025-11-07 15:27:45 - root - DEBUG - Line 4: '58' (conf: 0.768)
2025-11-07 15:27:45 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.927)
2025-11-07 15:27:45 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.938)
2025-11-07 15:27:45 - root - DEBUG - Line 7: 'Gn -13' (conf: 0.951)
2025-11-07 15:27:45 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.908)
2025-11-07 15:27:45 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.930)
2025-11-07 15:27:45 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.974)
2025-11-07 15:27:45 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:27:45 - root - DEBUG - Line 0 text: '64/ 21Hz'
2025-11-07 15:27:45 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:27:45 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:27:45 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:27:45 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:45 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:27:45 - root - DEBUG - Line 6 text: 'Gn -13'
2025-11-07 15:27:45 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:27:45 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:27:45 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:45 - root - DEBUG - Combined text for keyword search: '64/ 21hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -13 c7 / m15 ff2/e2 sri ii 2 / cri 2'
2025-11-07 15:27:45 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:45 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:45 - root - INFO - Identified organs: []
2025-11-07 15:27:45 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:45 - root - DEBUG - Organ identified: []
2025-11-07 15:27:45 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:27:45 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000017.dcm
2025-11-07 15:27:45 - root - INFO - Processing DICOM file 16/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000018.dcm
2025-11-07 15:27:45 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:45 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000018.dcm
2025-11-07 15:27:45 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:45 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:45 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:45 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:45 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:45 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:45 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:45 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:45 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:45 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:45 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:45 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:45 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:45 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:45 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:45 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:45 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:45 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:45 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:45 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:45 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:45 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:45 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:45 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:45 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:45 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:45 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:45 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:45 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:46 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:46 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:46 - root - INFO - Initializing TableDetector
2025-11-07 15:27:46 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:46 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:46 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:46 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:46 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:46 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:46 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:46 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:46 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:46 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:46 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:46 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:46 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:46 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:46 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:46 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:46 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:46 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:46 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:46 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:46 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:46 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:46 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:46 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:46 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:46 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:46 - root - DEBUG - Edge detection completed
2025-11-07 15:27:46 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:46 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 220805
2025-11-07 15:27:46 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:46 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:46 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:46 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:46 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:46 - root - DEBUG - Line thickening completed
2025-11-07 15:27:46 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:46 - root - DEBUG - Line combination completed
2025-11-07 15:27:46 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:46 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:46 - root - INFO - Found 625 contours
2025-11-07 15:27:46 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:46 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:46 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:46 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:46 - root - INFO - Total candidate regions found: 90
2025-11-07 15:27:46 - root - DEBUG - Found 90 candidate regions
2025-11-07 15:27:46 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:46 - root - DEBUG - Line 1: '1 D 1.75cm' (conf: 0.997)
2025-11-07 15:27:46 - root - DEBUG - Line 2: '2 ' (conf: 0.949)
2025-11-07 15:27:46 - root - DEBUG - Line 3: 'D 2.20cm' (conf: 0.999)
2025-11-07 15:27:46 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:46 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:27:46 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:27:46 - root - DEBUG - Combined text: '1 d 1.75cm 2  d 2.20cm'
2025-11-07 15:27:46 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:46 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:46 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:46 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:46 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:46 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:27:46 - root - DEBUG - Pattern 1 found matches: ['1.75cm', '2.20cm']
2025-11-07 15:27:46 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:27:46 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:27:46 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:27:46 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:27:46 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:46 - root - INFO - Final measurement score: 8
2025-11-07 15:27:48 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:48 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:48 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:48 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:48 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:48 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:48 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:48 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:48 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:48 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:48 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:48 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:48 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:48 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:48 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:48 - root - INFO - Final measurement score: 0
2025-11-07 15:27:48 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:48 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:48 - root - DEBUG - Top 10 score indices: [1, 0, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:48 - root - DEBUG - Rank 1: Index 1, Score 8.000000
2025-11-07 15:27:48 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:27:48 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:48 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:48 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:48 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:48 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:48 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:48 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:48 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:48 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:27:48 - root - DEBUG - All top 10 scores:
2025-11-07 15:27:48 - root - DEBUG - Score index 1: 8.000000
2025-11-07 15:27:48 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:27:48 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:27:48 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:27:48 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:27:48 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:27:48 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:27:48 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:27:48 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:27:48 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:27:48 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:27:48 - root - DEBUG - Table detection completed. Candidates found: 90
2025-11-07 15:27:48 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:48 - root - INFO - Starting organ name identification
2025-11-07 15:27:48 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:48 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:48 - root - INFO - Starting organ label identification
2025-11-07 15:27:48 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:48 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:49 - root - DEBUG - Line 1: '64/ 21Hz' (conf: 0.954)
2025-11-07 15:27:49 - root - DEBUG - Line 2: 'Voluson' (conf: 1.000)
2025-11-07 15:27:49 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.999)
2025-11-07 15:27:49 - root - DEBUG - Line 4: '58' (conf: 0.768)
2025-11-07 15:27:49 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:27:49 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.938)
2025-11-07 15:27:49 - root - DEBUG - Line 7: 'Gn -20' (conf: 0.972)
2025-11-07 15:27:49 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.908)
2025-11-07 15:27:49 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:27:49 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:27:49 - root - DEBUG - Line 11: '1 D 1.75cm' (conf: 0.987)
2025-11-07 15:27:49 - root - DEBUG - Line 12: '2 D 2.20cm' (conf: 0.996)
2025-11-07 15:27:49 - root - DEBUG - OCR completed. Processing 12 text lines for organ keywords
2025-11-07 15:27:49 - root - DEBUG - Line 0 text: '64/ 21Hz'
2025-11-07 15:27:49 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:27:49 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:27:49 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:27:49 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:49 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:27:49 - root - DEBUG - Line 6 text: 'Gn -20'
2025-11-07 15:27:49 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:27:49 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:27:49 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:49 - root - DEBUG - Line 10 text: '1 D 1.75cm'
2025-11-07 15:27:49 - root - DEBUG - Line 11 text: '2 D 2.20cm'
2025-11-07 15:27:49 - root - DEBUG - Combined text for keyword search: '64/ 21hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -20 c7 / m15 ff2/e2 sri ii 2 / cri 2 1 d 1.75cm 2 d 2.20cm'
2025-11-07 15:27:49 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:49 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:49 - root - INFO - Identified organs: []
2025-11-07 15:27:49 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:49 - root - DEBUG - Organ identified: []
2025-11-07 15:27:49 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:27:49 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:27:49 - root - DEBUG - Best score index: 1
2025-11-07 15:27:49 - root - INFO - Extracting structured data from detected table
2025-11-07 15:27:49 - root - INFO - Starting table content extraction
2025-11-07 15:27:49 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:27:49 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:27:49 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:27:49 - root - INFO - Starting table content extraction
2025-11-07 15:27:49 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:27:49 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:27:50 - root - DEBUG - Line 1: '1 D 1.75cm' (conf: 0.997)
2025-11-07 15:27:50 - root - DEBUG - Line 2: '2 ' (conf: 0.949)
2025-11-07 15:27:50 - root - DEBUG - Line 3: 'D 2.20cm' (conf: 0.999)
2025-11-07 15:27:50 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:27:50 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:27:50 - root - INFO - Structuring extracted text data
2025-11-07 15:27:50 - root - INFO - Starting table data structuring
2025-11-07 15:27:50 - root - DEBUG - Element 1: text='1 D 1.75cm', x=153.50, y=43.00, conf=0.997
2025-11-07 15:27:50 - root - DEBUG - Element 2: text='2 ', x=53.00, y=129.50, conf=0.949
2025-11-07 15:27:50 - root - DEBUG - Element 3: text='D 2.20cm', x=180.00, y=126.00, conf=0.999
2025-11-07 15:27:50 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:27:50 - root - DEBUG - Processing element 1/3: '1 D 1.75cm' at (153.50, 43.00)
2025-11-07 15:27:50 - root - DEBUG - Processing element 2/3: 'D 2.20cm' at (180.00, 126.00)
2025-11-07 15:27:50 - root - DEBUG - Processing element 3/3: '2 ' at (53.00, 129.50)
2025-11-07 15:27:50 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:27:50 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:27:50 - root - DEBUG - Processing word 1/1: '1 D 1.75cm'
2025-11-07 15:27:50 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:50 - root - DEBUG - Input text: '1 D 1.75cm'
2025-11-07 15:27:50 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:50 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:27:50 - root - DEBUG - Pattern 1 groups: ('1', 'D', '1.75cm')
2025-11-07 15:27:50 - root - DEBUG - Pattern 1 result: ('1', 'D', '1.75cm')
2025-11-07 15:27:50 - root - INFO - Text split successful using pattern 1: ('1', 'D', '1.75cm')
2025-11-07 15:27:50 - root - DEBUG - Split measurement result: ('1', 'D', '1.75cm')
2025-11-07 15:27:50 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:27:50 - root - DEBUG - Processing word 1/2: '2 '
2025-11-07 15:27:50 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:50 - root - DEBUG - Input text: '2'
2025-11-07 15:27:50 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:50 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:27:50 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:50 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:27:50 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:27:50 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:27:50 - root - DEBUG - Split measurement result: None
2025-11-07 15:27:50 - root - DEBUG - Processing word 2/2: 'D 2.20cm'
2025-11-07 15:27:50 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:50 - root - DEBUG - Input text: 'D 2.20cm'
2025-11-07 15:27:50 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:50 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:27:50 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:50 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:27:50 - root - DEBUG - Pattern 2 groups: ('D', '2.20cm')
2025-11-07 15:27:50 - root - DEBUG - Pattern 2 result: ('D', '2.20cm')
2025-11-07 15:27:50 - root - INFO - Text split successful using pattern 2: ('D', '2.20cm')
2025-11-07 15:27:50 - root - DEBUG - Split measurement result: ('D', '2.20cm')
2025-11-07 15:27:50 - root - DEBUG - Final structured data:
2025-11-07 15:27:50 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '1.75cm']}'
2025-11-07 15:27:50 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '2.20cm']}'
2025-11-07 15:27:50 - root - INFO - Table content extraction completed successfully
2025-11-07 15:27:50 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:27:50 - root - DEBUG - Organ identified: []
2025-11-07 15:27:50 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000018.dcm
2025-11-07 15:27:50 - root - INFO - Organ identified: []
2025-11-07 15:27:50 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 D 1.75cm', '2 D 2.20cm']}
2025-11-07 15:27:50 - root - INFO - Processing DICOM file 17/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000019.dcm
2025-11-07 15:27:50 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:50 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000019.dcm
2025-11-07 15:27:50 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:50 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:50 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:50 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:50 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:50 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:50 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:50 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:50 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:50 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:50 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:50 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:50 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:50 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:50 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:50 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:50 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:50 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:50 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:50 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:50 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:50 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:50 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:50 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:50 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:50 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:50 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:50 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:50 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:51 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:51 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:51 - root - INFO - Initializing TableDetector
2025-11-07 15:27:51 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:51 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:51 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:51 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:51 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:51 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:51 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:51 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:51 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:51 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:51 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:51 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:51 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:51 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:51 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:51 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:51 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:51 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:51 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:51 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:51 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:51 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:51 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:51 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:51 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:51 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:51 - root - DEBUG - Edge detection completed
2025-11-07 15:27:51 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:51 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 193019
2025-11-07 15:27:51 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:51 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:51 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:51 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:51 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:51 - root - DEBUG - Line thickening completed
2025-11-07 15:27:51 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:51 - root - DEBUG - Line combination completed
2025-11-07 15:27:51 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:51 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:51 - root - INFO - Found 581 contours
2025-11-07 15:27:51 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:51 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:51 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:51 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:51 - root - INFO - Total candidate regions found: 60
2025-11-07 15:27:51 - root - DEBUG - Found 60 candidate regions
2025-11-07 15:27:51 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:51 - root - DEBUG - Line 1: '1 D 3.03cm' (conf: 0.999)
2025-11-07 15:27:51 - root - DEBUG - Line 2: '2 ' (conf: 0.850)
2025-11-07 15:27:51 - root - DEBUG - Line 3: 'D 1.70cm' (conf: 0.999)
2025-11-07 15:27:51 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:51 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:27:51 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:27:51 - root - DEBUG - Combined text: '1 d 3.03cm 2  d 1.70cm'
2025-11-07 15:27:51 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:51 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:51 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:51 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:51 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:51 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:27:51 - root - DEBUG - Pattern 1 found matches: ['3.03cm', '1.70cm']
2025-11-07 15:27:51 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:27:51 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:27:51 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:27:51 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:27:51 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:51 - root - INFO - Final measurement score: 8
2025-11-07 15:27:53 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:53 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:53 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:53 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:53 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:53 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:53 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:53 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:53 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:53 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:53 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:53 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:53 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:53 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:53 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:53 - root - INFO - Final measurement score: 0
2025-11-07 15:27:53 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:27:53 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:27:53 - root - DEBUG - Top 10 score indices: [1, 0, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:27:53 - root - DEBUG - Rank 1: Index 1, Score 8.000000
2025-11-07 15:27:53 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:27:53 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:27:53 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:27:53 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:27:53 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:27:53 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:27:53 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:27:53 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:27:53 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:27:53 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:27:53 - root - DEBUG - All top 10 scores:
2025-11-07 15:27:53 - root - DEBUG - Score index 1: 8.000000
2025-11-07 15:27:53 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:27:53 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:27:53 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:27:53 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:27:53 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:27:53 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:27:53 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:27:53 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:27:53 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:27:53 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:27:53 - root - DEBUG - Table detection completed. Candidates found: 60
2025-11-07 15:27:53 - root - INFO - Identifying organ name from the image
2025-11-07 15:27:53 - root - INFO - Starting organ name identification
2025-11-07 15:27:53 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:27:53 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:27:53 - root - INFO - Starting organ label identification
2025-11-07 15:27:53 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:27:53 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:27:54 - root - DEBUG - Line 1: '64/ 21Hz' (conf: 0.954)
2025-11-07 15:27:54 - root - DEBUG - Line 2: 'Voluson' (conf: 1.000)
2025-11-07 15:27:54 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.997)
2025-11-07 15:27:54 - root - DEBUG - Line 4: '58' (conf: 0.768)
2025-11-07 15:27:54 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:27:54 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.938)
2025-11-07 15:27:54 - root - DEBUG - Line 7: 'Gn -20' (conf: 0.972)
2025-11-07 15:27:54 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.908)
2025-11-07 15:27:54 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:27:54 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:27:54 - root - DEBUG - Line 11: '1 D 3.03cm' (conf: 0.999)
2025-11-07 15:27:54 - root - DEBUG - Line 12: '2 D 1.70cm' (conf: 0.996)
2025-11-07 15:27:54 - root - DEBUG - OCR completed. Processing 12 text lines for organ keywords
2025-11-07 15:27:54 - root - DEBUG - Line 0 text: '64/ 21Hz'
2025-11-07 15:27:54 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:27:54 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:27:54 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:27:54 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:27:54 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:27:54 - root - DEBUG - Line 6 text: 'Gn -20'
2025-11-07 15:27:54 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:27:54 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:27:54 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:27:54 - root - DEBUG - Line 10 text: '1 D 3.03cm'
2025-11-07 15:27:54 - root - DEBUG - Line 11 text: '2 D 1.70cm'
2025-11-07 15:27:54 - root - DEBUG - Combined text for keyword search: '64/ 21hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -20 c7 / m15 ff2/e2 sri ii 2 / cri 2 1 d 3.03cm 2 d 1.70cm'
2025-11-07 15:27:54 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:27:54 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:27:54 - root - INFO - Identified organs: []
2025-11-07 15:27:54 - root - WARNING - No organ name identified from the image
2025-11-07 15:27:54 - root - DEBUG - Organ identified: []
2025-11-07 15:27:54 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:27:54 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:27:54 - root - DEBUG - Best score index: 1
2025-11-07 15:27:54 - root - INFO - Extracting structured data from detected table
2025-11-07 15:27:54 - root - INFO - Starting table content extraction
2025-11-07 15:27:54 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:27:54 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:27:54 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:27:54 - root - INFO - Starting table content extraction
2025-11-07 15:27:54 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:27:54 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:27:54 - root - DEBUG - Line 1: '1 D 3.03cm' (conf: 0.999)
2025-11-07 15:27:54 - root - DEBUG - Line 2: '2 ' (conf: 0.850)
2025-11-07 15:27:54 - root - DEBUG - Line 3: 'D 1.70cm' (conf: 0.999)
2025-11-07 15:27:54 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:27:54 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:27:54 - root - INFO - Structuring extracted text data
2025-11-07 15:27:54 - root - INFO - Starting table data structuring
2025-11-07 15:27:54 - root - DEBUG - Element 1: text='1 D 3.03cm', x=154.00, y=43.00, conf=0.999
2025-11-07 15:27:54 - root - DEBUG - Element 2: text='2 ', x=55.00, y=129.50, conf=0.850
2025-11-07 15:27:54 - root - DEBUG - Element 3: text='D 1.70cm', x=180.00, y=126.00, conf=0.999
2025-11-07 15:27:54 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:27:54 - root - DEBUG - Processing element 1/3: '1 D 3.03cm' at (154.00, 43.00)
2025-11-07 15:27:54 - root - DEBUG - Processing element 2/3: 'D 1.70cm' at (180.00, 126.00)
2025-11-07 15:27:54 - root - DEBUG - Processing element 3/3: '2 ' at (55.00, 129.50)
2025-11-07 15:27:54 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:27:54 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:27:54 - root - DEBUG - Processing word 1/1: '1 D 3.03cm'
2025-11-07 15:27:54 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:54 - root - DEBUG - Input text: '1 D 3.03cm'
2025-11-07 15:27:54 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:54 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:27:54 - root - DEBUG - Pattern 1 groups: ('1', 'D', '3.03cm')
2025-11-07 15:27:54 - root - DEBUG - Pattern 1 result: ('1', 'D', '3.03cm')
2025-11-07 15:27:54 - root - INFO - Text split successful using pattern 1: ('1', 'D', '3.03cm')
2025-11-07 15:27:54 - root - DEBUG - Split measurement result: ('1', 'D', '3.03cm')
2025-11-07 15:27:54 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:27:54 - root - DEBUG - Processing word 1/2: '2 '
2025-11-07 15:27:54 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:54 - root - DEBUG - Input text: '2'
2025-11-07 15:27:54 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:54 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:27:54 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:54 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:27:54 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:27:54 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:27:54 - root - DEBUG - Split measurement result: None
2025-11-07 15:27:54 - root - DEBUG - Processing word 2/2: 'D 1.70cm'
2025-11-07 15:27:54 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:27:54 - root - DEBUG - Input text: 'D 1.70cm'
2025-11-07 15:27:54 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:54 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:27:54 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:27:54 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:27:54 - root - DEBUG - Pattern 2 groups: ('D', '1.70cm')
2025-11-07 15:27:54 - root - DEBUG - Pattern 2 result: ('D', '1.70cm')
2025-11-07 15:27:54 - root - INFO - Text split successful using pattern 2: ('D', '1.70cm')
2025-11-07 15:27:54 - root - DEBUG - Split measurement result: ('D', '1.70cm')
2025-11-07 15:27:54 - root - DEBUG - Final structured data:
2025-11-07 15:27:54 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '3.03cm']}'
2025-11-07 15:27:54 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '1.70cm']}'
2025-11-07 15:27:54 - root - INFO - Table content extraction completed successfully
2025-11-07 15:27:54 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:27:54 - root - DEBUG - Organ identified: []
2025-11-07 15:27:55 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000019.dcm
2025-11-07 15:27:55 - root - INFO - Organ identified: []
2025-11-07 15:27:55 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 D 3.03cm', '2 D 1.70cm']}
2025-11-07 15:27:55 - root - INFO - Processing DICOM file 18/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000020.dcm
2025-11-07 15:27:55 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:27:55 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000020.dcm
2025-11-07 15:27:55 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:27:55 - root - INFO - DICOM file loaded successfully
2025-11-07 15:27:55 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:27:55 - root - INFO - Processing RGB format DICOM
2025-11-07 15:27:55 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:27:55 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:27:55 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:27:55 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:27:55 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:27:55 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:27:55 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:27:55 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:27:55 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:55 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:27:55 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:27:55 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:27:55 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:27:55 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:27:55 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:27:55 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:27:55 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:27:55 - root - INFO - Initializing OCRHandler
2025-11-07 15:27:55 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:27:55 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:27:55 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:27:55 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:27:55 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:27:55 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:27:55 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:27:56 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:27:56 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:27:56 - root - INFO - Initializing TableDetector
2025-11-07 15:27:56 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:27:56 - root - DEBUG - Default detection parameters:
2025-11-07 15:27:56 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:27:56 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:27:56 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:27:56 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:27:56 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:27:56 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:27:56 - root - INFO - TableDetector initialization completed
2025-11-07 15:27:56 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:27:56 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:27:56 - root - DEBUG - Text analysis configuration:
2025-11-07 15:27:56 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:27:56 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:27:56 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:27:56 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:27:56 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:27:56 - root - INFO - Initializing ContentExtractor
2025-11-07 15:27:56 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:27:56 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:27:56 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:27:56 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:27:56 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:27:56 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:27:56 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:27:56 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:27:56 - root - DEBUG - Edge detection completed
2025-11-07 15:27:56 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:27:56 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 401326
2025-11-07 15:27:56 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:27:56 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:27:56 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:27:56 - root - DEBUG - Line enhancement completed
2025-11-07 15:27:56 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:27:56 - root - DEBUG - Line thickening completed
2025-11-07 15:27:56 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:27:56 - root - DEBUG - Line combination completed
2025-11-07 15:27:56 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:27:56 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:27:56 - root - INFO - Found 832 contours
2025-11-07 15:27:56 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:27:56 - root - DEBUG - Contours drawn successfully
2025-11-07 15:27:56 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:27:56 - root - INFO - Rectangular region detection completed
2025-11-07 15:27:56 - root - INFO - Total candidate regions found: 161
2025-11-07 15:27:56 - root - DEBUG - Found 161 candidate regions
2025-11-07 15:27:56 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:27:56 - root - DEBUG - Line 1: '1 D 1.51cm' (conf: 0.984)
2025-11-07 15:27:56 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:27:56 - root - DEBUG - Line 3: 'D 0.99cm' (conf: 0.966)
2025-11-07 15:27:56 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:56 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:27:56 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:27:56 - root - DEBUG - Combined text: '1 d 1.51cm 2  d 0.99cm'
2025-11-07 15:27:56 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:56 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:56 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:56 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:56 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:56 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:27:56 - root - DEBUG - Pattern 1 found matches: ['1.51cm', '0.99cm']
2025-11-07 15:27:56 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:27:56 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:27:56 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:27:56 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:27:56 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:56 - root - INFO - Final measurement score: 8
2025-11-07 15:27:59 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:27:59 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:27:59 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:27:59 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:27:59 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:27:59 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:27:59 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:27:59 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:27:59 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:27:59 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:27:59 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:27:59 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:27:59 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:27:59 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:27:59 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:27:59 - root - INFO - Final measurement score: 0
2025-11-07 15:28:00 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:00 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:00 - root - DEBUG - Top 10 score indices: [1, 0, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:28:00 - root - DEBUG - Rank 1: Index 1, Score 8.000000
2025-11-07 15:28:00 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:28:00 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:28:00 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:28:00 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:28:00 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:28:00 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:28:00 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:28:00 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:28:00 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:28:00 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:28:00 - root - DEBUG - All top 10 scores:
2025-11-07 15:28:00 - root - DEBUG - Score index 1: 8.000000
2025-11-07 15:28:00 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:28:00 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:28:00 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:28:00 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:28:00 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:28:00 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:28:00 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:28:00 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:28:00 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:28:00 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:28:00 - root - DEBUG - Table detection completed. Candidates found: 161
2025-11-07 15:28:00 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:00 - root - INFO - Starting organ name identification
2025-11-07 15:28:00 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:00 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:00 - root - INFO - Starting organ label identification
2025-11-07 15:28:00 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:00 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:28:01 - root - DEBUG - Line 1: '64/ 24Hz' (conf: 0.945)
2025-11-07 15:28:01 - root - DEBUG - Line 2: 'Voluson' (conf: 0.998)
2025-11-07 15:28:01 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.984)
2025-11-07 15:28:01 - root - DEBUG - Line 4: '58' (conf: 0.697)
2025-11-07 15:28:01 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.927)
2025-11-07 15:28:01 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.935)
2025-11-07 15:28:01 - root - DEBUG - Line 7: 'Gn -8' (conf: 0.992)
2025-11-07 15:28:01 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.909)
2025-11-07 15:28:01 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:28:01 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.974)
2025-11-07 15:28:01 - root - DEBUG - Line 11: '1 D 1.51cm' (conf: 0.998)
2025-11-07 15:28:01 - root - DEBUG - Line 12: '2 D 0.99cm' (conf: 0.978)
2025-11-07 15:28:01 - root - DEBUG - OCR completed. Processing 12 text lines for organ keywords
2025-11-07 15:28:01 - root - DEBUG - Line 0 text: '64/ 24Hz'
2025-11-07 15:28:01 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:28:01 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:28:01 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:28:01 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:28:01 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:28:01 - root - DEBUG - Line 6 text: 'Gn -8'
2025-11-07 15:28:01 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:28:01 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:28:01 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:28:01 - root - DEBUG - Line 10 text: '1 D 1.51cm'
2025-11-07 15:28:01 - root - DEBUG - Line 11 text: '2 D 0.99cm'
2025-11-07 15:28:01 - root - DEBUG - Combined text for keyword search: '64/ 24hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -8 c7 / m15 ff2/e2 sri ii 2 / cri 2 1 d 1.51cm 2 d 0.99cm'
2025-11-07 15:28:01 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:28:01 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:28:01 - root - INFO - Identified organs: []
2025-11-07 15:28:01 - root - WARNING - No organ name identified from the image
2025-11-07 15:28:01 - root - DEBUG - Organ identified: []
2025-11-07 15:28:01 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:28:01 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:28:01 - root - DEBUG - Best score index: 1
2025-11-07 15:28:01 - root - INFO - Extracting structured data from detected table
2025-11-07 15:28:01 - root - INFO - Starting table content extraction
2025-11-07 15:28:01 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:28:01 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:28:01 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:28:01 - root - INFO - Starting table content extraction
2025-11-07 15:28:01 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:28:01 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:28:02 - root - DEBUG - Line 1: '1 D 1.51cm' (conf: 0.984)
2025-11-07 15:28:02 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:28:02 - root - DEBUG - Line 3: 'D 0.99cm' (conf: 0.966)
2025-11-07 15:28:02 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:28:02 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:28:02 - root - INFO - Structuring extracted text data
2025-11-07 15:28:02 - root - INFO - Starting table data structuring
2025-11-07 15:28:02 - root - DEBUG - Element 1: text='1 D 1.51cm', x=153.00, y=43.00, conf=0.984
2025-11-07 15:28:02 - root - DEBUG - Element 2: text='2 ', x=55.00, y=130.00, conf=0.817
2025-11-07 15:28:02 - root - DEBUG - Element 3: text='D 0.99cm', x=180.50, y=126.00, conf=0.966
2025-11-07 15:28:02 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:28:02 - root - DEBUG - Processing element 1/3: '1 D 1.51cm' at (153.00, 43.00)
2025-11-07 15:28:02 - root - DEBUG - Processing element 2/3: 'D 0.99cm' at (180.50, 126.00)
2025-11-07 15:28:02 - root - DEBUG - Processing element 3/3: '2 ' at (55.00, 130.00)
2025-11-07 15:28:02 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:28:02 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:28:02 - root - DEBUG - Processing word 1/1: '1 D 1.51cm'
2025-11-07 15:28:02 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:02 - root - DEBUG - Input text: '1 D 1.51cm'
2025-11-07 15:28:02 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:02 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:28:02 - root - DEBUG - Pattern 1 groups: ('1', 'D', '1.51cm')
2025-11-07 15:28:02 - root - DEBUG - Pattern 1 result: ('1', 'D', '1.51cm')
2025-11-07 15:28:02 - root - INFO - Text split successful using pattern 1: ('1', 'D', '1.51cm')
2025-11-07 15:28:02 - root - DEBUG - Split measurement result: ('1', 'D', '1.51cm')
2025-11-07 15:28:02 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:28:02 - root - DEBUG - Processing word 1/2: '2 '
2025-11-07 15:28:02 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:02 - root - DEBUG - Input text: '2'
2025-11-07 15:28:02 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:02 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:28:02 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:02 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:28:02 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:28:02 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:28:02 - root - DEBUG - Split measurement result: None
2025-11-07 15:28:02 - root - DEBUG - Processing word 2/2: 'D 0.99cm'
2025-11-07 15:28:02 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:02 - root - DEBUG - Input text: 'D 0.99cm'
2025-11-07 15:28:02 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:02 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:28:02 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:02 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:28:02 - root - DEBUG - Pattern 2 groups: ('D', '0.99cm')
2025-11-07 15:28:02 - root - DEBUG - Pattern 2 result: ('D', '0.99cm')
2025-11-07 15:28:02 - root - INFO - Text split successful using pattern 2: ('D', '0.99cm')
2025-11-07 15:28:02 - root - DEBUG - Split measurement result: ('D', '0.99cm')
2025-11-07 15:28:02 - root - DEBUG - Final structured data:
2025-11-07 15:28:02 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '1.51cm']}'
2025-11-07 15:28:02 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '0.99cm']}'
2025-11-07 15:28:02 - root - INFO - Table content extraction completed successfully
2025-11-07 15:28:02 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:28:02 - root - DEBUG - Organ identified: []
2025-11-07 15:28:02 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000020.dcm
2025-11-07 15:28:02 - root - INFO - Organ identified: []
2025-11-07 15:28:02 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 D 1.51cm', '2 D 0.99cm']}
2025-11-07 15:28:02 - root - INFO - Processing DICOM file 19/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000021.dcm
2025-11-07 15:28:02 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:28:02 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000021.dcm
2025-11-07 15:28:02 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:28:02 - root - INFO - DICOM file loaded successfully
2025-11-07 15:28:02 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:28:02 - root - INFO - Processing RGB format DICOM
2025-11-07 15:28:02 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:28:02 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:28:02 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:28:02 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:28:02 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:28:02 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:28:02 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:28:02 - root - DEBUG - Raw coordinates - minx0: [0, 569], miny0: [66, 66], maxx1: [567, 1136], maxy1: [852, 852]
2025-11-07 15:28:02 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:02 - root - INFO - Multiple regions detected (2 regions), calculating combined bounds
2025-11-07 15:28:02 - root - DEBUG - Combined bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:28:02 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:28:02 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:28:02 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:02 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:28:02 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:28:02 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:28:02 - root - INFO - Initializing OCRHandler
2025-11-07 15:28:02 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:28:02 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:28:02 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:28:02 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:28:02 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:28:02 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:28:02 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:28:04 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:28:04 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:28:04 - root - INFO - Initializing TableDetector
2025-11-07 15:28:04 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:28:04 - root - DEBUG - Default detection parameters:
2025-11-07 15:28:04 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:28:04 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:28:04 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:28:04 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:28:04 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:28:04 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:28:04 - root - INFO - TableDetector initialization completed
2025-11-07 15:28:04 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:28:04 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:28:04 - root - DEBUG - Text analysis configuration:
2025-11-07 15:28:04 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:28:04 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:28:04 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:28:04 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:28:04 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:28:04 - root - INFO - Initializing ContentExtractor
2025-11-07 15:28:04 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:28:04 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:28:04 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:28:04 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:28:04 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:28:04 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:28:04 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:28:04 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:28:04 - root - DEBUG - Edge detection completed
2025-11-07 15:28:04 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:28:04 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 593983
2025-11-07 15:28:04 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:28:04 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:28:04 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:28:04 - root - DEBUG - Line enhancement completed
2025-11-07 15:28:04 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:28:04 - root - DEBUG - Line thickening completed
2025-11-07 15:28:04 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:28:04 - root - DEBUG - Line combination completed
2025-11-07 15:28:04 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:28:04 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:28:04 - root - INFO - Found 1315 contours
2025-11-07 15:28:04 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:28:04 - root - DEBUG - Contours drawn successfully
2025-11-07 15:28:04 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:28:04 - root - INFO - Rectangular region detection completed
2025-11-07 15:28:04 - root - INFO - Total candidate regions found: 207
2025-11-07 15:28:04 - root - DEBUG - Found 207 candidate regions
2025-11-07 15:28:04 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:28:04 - root - DEBUG - Line 1: '1 L 7.74cm' (conf: 0.984)
2025-11-07 15:28:04 - root - DEBUG - Line 2: '2 L 3.69cm' (conf: 0.997)
2025-11-07 15:28:04 - root - DEBUG - Line 3: '3 L 3.70cm' (conf: 0.995)
2025-11-07 15:28:04 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:04 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:28:04 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:28:04 - root - DEBUG - Combined text: '1 l 7.74cm 2 l 3.69cm 3 l 3.70cm'
2025-11-07 15:28:04 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:04 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:04 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:04 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:04 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:04 - root - DEBUG - Pattern 1 matches: 3
2025-11-07 15:28:04 - root - DEBUG - Pattern 1 found matches: ['7.74cm', '3.69cm', '3.70cm']
2025-11-07 15:28:04 - root - DEBUG - Pattern 2 matches: 3
2025-11-07 15:28:04 - root - DEBUG - Pattern 2 found matches: ['l', 'l', 'l']
2025-11-07 15:28:04 - root - DEBUG - Base score from pattern matching: 6
2025-11-07 15:28:04 - root - DEBUG - 'cm' occurrences: 3, bonus added: 6
2025-11-07 15:28:04 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:04 - root - INFO - Final measurement score: 12
2025-11-07 15:28:08 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:28:08 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:08 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:08 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:08 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:28:08 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:08 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:08 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:08 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:08 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:08 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:08 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:08 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:08 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:08 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:08 - root - INFO - Final measurement score: 0
2025-11-07 15:28:10 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:10 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:10 - root - DEBUG - Top 10 score indices: [2, 0, 1, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:28:10 - root - DEBUG - Rank 1: Index 2, Score 12.000000
2025-11-07 15:28:10 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:28:10 - root - DEBUG - Rank 3: Index 1, Score 0.000000
2025-11-07 15:28:10 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:28:10 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:28:10 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:28:10 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:28:10 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:28:10 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:28:10 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:28:10 - root - INFO - Best candidate meets threshold (>= 4). Score: 12.000000
2025-11-07 15:28:10 - root - DEBUG - All top 10 scores:
2025-11-07 15:28:10 - root - DEBUG - Score index 2: 12.000000
2025-11-07 15:28:10 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:28:10 - root - DEBUG - Score index 1: 0.000000
2025-11-07 15:28:10 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:28:10 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:28:10 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:28:10 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:28:10 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:28:10 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:28:10 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:28:10 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:28:10 - root - DEBUG - Table detection completed. Candidates found: 207
2025-11-07 15:28:10 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:10 - root - INFO - Starting organ name identification
2025-11-07 15:28:10 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:10 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:10 - root - INFO - Starting organ label identification
2025-11-07 15:28:10 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:10 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:28:11 - root - DEBUG - Line 1: '64/18Hz' (conf: 1.000)
2025-11-07 15:28:11 - root - DEBUG - Line 2: 'Voluson' (conf: 0.995)
2025-11-07 15:28:11 - root - DEBUG - Line 3: 'Voluson' (conf: 0.991)
2025-11-07 15:28:11 - root - DEBUG - Line 4: 'Abdomen 1' (conf: 0.988)
2025-11-07 15:28:11 - root - DEBUG - Line 5: 'S8' (conf: 0.731)
2025-11-07 15:28:11 - root - DEBUG - Line 6: '58' (conf: 0.697)
2025-11-07 15:28:11 - root - DEBUG - Line 7: 'HM PI 7.70 - 2.10' (conf: 0.928)
2025-11-07 15:28:11 - root - DEBUG - Line 8: 'AO 100%' (conf: 0.939)
2025-11-07 15:28:11 - root - DEBUG - Line 9: 'Gn -6' (conf: 0.993)
2025-11-07 15:28:11 - root - DEBUG - Line 10: 'C7 /-M15' (conf: 0.981)
2025-11-07 15:28:11 - root - DEBUG - Line 11: 'FF2/E2' (conf: 0.995)
2025-11-07 15:28:11 - root - DEBUG - Line 12: 'SRI II 2 / CRI 2' (conf: 0.972)
2025-11-07 15:28:11 - root - DEBUG - Line 13: 'L 7.74cm' (conf: 0.993)
2025-11-07 15:28:11 - root - DEBUG - Line 14: 'L 3.69cm' (conf: 0.999)
2025-11-07 15:28:11 - root - DEBUG - Line 15: '3 L 3.70cm' (conf: 0.970)
2025-11-07 15:28:11 - root - DEBUG - OCR completed. Processing 15 text lines for organ keywords
2025-11-07 15:28:11 - root - DEBUG - Line 0 text: '64/18Hz'
2025-11-07 15:28:11 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:28:11 - root - DEBUG - Line 2 text: 'Voluson'
2025-11-07 15:28:11 - root - DEBUG - Line 3 text: 'Abdomen 1'
2025-11-07 15:28:11 - root - DEBUG - Line 4 text: 'S8'
2025-11-07 15:28:11 - root - DEBUG - Line 5 text: '58'
2025-11-07 15:28:11 - root - DEBUG - Line 6 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:28:11 - root - DEBUG - Line 7 text: 'AO 100%'
2025-11-07 15:28:11 - root - DEBUG - Line 8 text: 'Gn -6'
2025-11-07 15:28:11 - root - DEBUG - Line 9 text: 'C7 /-M15'
2025-11-07 15:28:11 - root - DEBUG - Line 10 text: 'FF2/E2'
2025-11-07 15:28:11 - root - DEBUG - Line 11 text: 'SRI II 2 / CRI 2'
2025-11-07 15:28:11 - root - DEBUG - Line 12 text: 'L 7.74cm'
2025-11-07 15:28:11 - root - DEBUG - Line 13 text: 'L 3.69cm'
2025-11-07 15:28:11 - root - DEBUG - Line 14 text: '3 L 3.70cm'
2025-11-07 15:28:11 - root - DEBUG - Combined text for keyword search: '64/18hz voluson voluson abdomen 1 s8 58 hm pi 7.70 - 2.10 ao 100% gn -6 c7 /-m15 ff2/e2 sri ii 2 / cri 2 l 7.74cm l 3.69cm 3 l 3.70cm'
2025-11-07 15:28:11 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:28:11 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:28:11 - root - INFO - Identified organs: []
2025-11-07 15:28:11 - root - WARNING - No organ name identified from the image
2025-11-07 15:28:11 - root - DEBUG - Organ identified: []
2025-11-07 15:28:11 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:28:11 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:28:11 - root - DEBUG - Best score index: 2
2025-11-07 15:28:11 - root - INFO - Extracting structured data from detected table
2025-11-07 15:28:11 - root - INFO - Starting table content extraction
2025-11-07 15:28:11 - root - DEBUG - Bounding box coordinates: (3121, 2056, 283, 248)
2025-11-07 15:28:11 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:28:11 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:28:11 - root - INFO - Starting table content extraction
2025-11-07 15:28:11 - root - DEBUG - Bounding box coordinates: (3121, 2056, 283, 248)
2025-11-07 15:28:11 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:28:11 - root - DEBUG - Line 1: '1 L 7.74cm' (conf: 0.984)
2025-11-07 15:28:11 - root - DEBUG - Line 2: '2 L 3.69cm' (conf: 0.997)
2025-11-07 15:28:11 - root - DEBUG - Line 3: '3 L 3.70cm' (conf: 0.995)
2025-11-07 15:28:11 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:28:11 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:28:11 - root - INFO - Structuring extracted text data
2025-11-07 15:28:11 - root - INFO - Starting table data structuring
2025-11-07 15:28:11 - root - DEBUG - Element 1: text='1 L 7.74cm', x=149.50, y=44.50, conf=0.984
2025-11-07 15:28:11 - root - DEBUG - Element 2: text='2 L 3.69cm', x=149.00, y=128.00, conf=0.997
2025-11-07 15:28:11 - root - DEBUG - Element 3: text='3 L 3.70cm', x=147.00, y=211.50, conf=0.995
2025-11-07 15:28:11 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:28:11 - root - DEBUG - Processing element 1/3: '1 L 7.74cm' at (149.50, 44.50)
2025-11-07 15:28:11 - root - DEBUG - Processing element 2/3: '2 L 3.69cm' at (149.00, 128.00)
2025-11-07 15:28:11 - root - DEBUG - Processing element 3/3: '3 L 3.70cm' at (147.00, 211.50)
2025-11-07 15:28:11 - root - INFO - Line grouping completed - Total lines: 3
2025-11-07 15:28:11 - root - DEBUG - Processing line 1/3 with 1 elements
2025-11-07 15:28:11 - root - DEBUG - Processing word 1/1: '1 L 7.74cm'
2025-11-07 15:28:11 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:11 - root - DEBUG - Input text: '1 L 7.74cm'
2025-11-07 15:28:11 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:11 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:28:11 - root - DEBUG - Pattern 1 groups: ('1', 'L', '7.74cm')
2025-11-07 15:28:11 - root - DEBUG - Pattern 1 result: ('1', 'L', '7.74cm')
2025-11-07 15:28:11 - root - INFO - Text split successful using pattern 1: ('1', 'L', '7.74cm')
2025-11-07 15:28:11 - root - DEBUG - Split measurement result: ('1', 'L', '7.74cm')
2025-11-07 15:28:11 - root - DEBUG - Processing line 2/3 with 1 elements
2025-11-07 15:28:11 - root - DEBUG - Processing word 1/1: '2 L 3.69cm'
2025-11-07 15:28:11 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:11 - root - DEBUG - Input text: '2 L 3.69cm'
2025-11-07 15:28:11 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:11 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:28:11 - root - DEBUG - Pattern 1 groups: ('2', 'L', '3.69cm')
2025-11-07 15:28:11 - root - DEBUG - Pattern 1 result: ('2', 'L', '3.69cm')
2025-11-07 15:28:11 - root - INFO - Text split successful using pattern 1: ('2', 'L', '3.69cm')
2025-11-07 15:28:11 - root - DEBUG - Split measurement result: ('2', 'L', '3.69cm')
2025-11-07 15:28:11 - root - DEBUG - Processing line 3/3 with 1 elements
2025-11-07 15:28:11 - root - DEBUG - Processing word 1/1: '3 L 3.70cm'
2025-11-07 15:28:11 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:11 - root - DEBUG - Input text: '3 L 3.70cm'
2025-11-07 15:28:11 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:11 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:28:11 - root - DEBUG - Pattern 1 groups: ('3', 'L', '3.70cm')
2025-11-07 15:28:11 - root - DEBUG - Pattern 1 result: ('3', 'L', '3.70cm')
2025-11-07 15:28:11 - root - INFO - Text split successful using pattern 1: ('3', 'L', '3.70cm')
2025-11-07 15:28:11 - root - DEBUG - Split measurement result: ('3', 'L', '3.70cm')
2025-11-07 15:28:11 - root - DEBUG - Final structured data:
2025-11-07 15:28:11 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'L', '7.74cm']}'
2025-11-07 15:28:11 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'L', '3.69cm']}'
2025-11-07 15:28:11 - root - DEBUG - Item 3 (text): '{'Value3': ['3', 'L', '3.70cm']}'
2025-11-07 15:28:11 - root - INFO - Table content extraction completed successfully
2025-11-07 15:28:11 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:28:11 - root - DEBUG - Organ identified: []
2025-11-07 15:28:11 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000021.dcm
2025-11-07 15:28:11 - root - INFO - Organ identified: []
2025-11-07 15:28:11 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 L 7.74cm', '2 L 3.69cm', '3 L 3.70cm']}
2025-11-07 15:28:11 - root - INFO - Processing DICOM file 20/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000022.dcm
2025-11-07 15:28:11 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:28:11 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000022.dcm
2025-11-07 15:28:11 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:28:11 - root - INFO - DICOM file loaded successfully
2025-11-07 15:28:11 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:28:11 - root - INFO - Processing RGB format DICOM
2025-11-07 15:28:11 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:28:11 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:28:11 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:28:11 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:28:11 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:28:11 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:28:11 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:28:11 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:28:11 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:11 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:28:11 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:28:11 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:28:11 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:28:11 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:11 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:28:11 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:28:11 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:28:11 - root - INFO - Initializing OCRHandler
2025-11-07 15:28:11 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:28:11 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:28:11 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:28:11 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:28:11 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:28:11 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:28:11 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:28:12 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:28:12 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:28:12 - root - INFO - Initializing TableDetector
2025-11-07 15:28:12 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:28:12 - root - DEBUG - Default detection parameters:
2025-11-07 15:28:12 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:28:12 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:28:12 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:28:12 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:28:12 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:28:12 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:28:12 - root - INFO - TableDetector initialization completed
2025-11-07 15:28:12 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:28:12 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:28:12 - root - DEBUG - Text analysis configuration:
2025-11-07 15:28:12 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:28:12 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:28:12 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:28:12 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:28:12 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:28:12 - root - INFO - Initializing ContentExtractor
2025-11-07 15:28:12 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:28:12 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:28:12 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:28:12 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:28:12 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:28:12 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:28:12 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:28:12 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:28:12 - root - DEBUG - Edge detection completed
2025-11-07 15:28:12 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:28:12 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 210399
2025-11-07 15:28:12 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:28:12 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:28:12 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:28:12 - root - DEBUG - Line enhancement completed
2025-11-07 15:28:12 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:28:12 - root - DEBUG - Line thickening completed
2025-11-07 15:28:12 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:28:12 - root - DEBUG - Line combination completed
2025-11-07 15:28:12 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:28:12 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:28:12 - root - INFO - Found 582 contours
2025-11-07 15:28:12 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:28:12 - root - DEBUG - Contours drawn successfully
2025-11-07 15:28:12 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:28:12 - root - INFO - Rectangular region detection completed
2025-11-07 15:28:12 - root - INFO - Total candidate regions found: 70
2025-11-07 15:28:12 - root - DEBUG - Found 70 candidate regions
2025-11-07 15:28:12 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:28:13 - root - DEBUG - Line 1: '1 D 2.11cm' (conf: 0.997)
2025-11-07 15:28:13 - root - DEBUG - Line 2: '2 ' (conf: 0.949)
2025-11-07 15:28:13 - root - DEBUG - Line 3: 'D 1.54cm' (conf: 0.999)
2025-11-07 15:28:13 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:13 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:28:13 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:28:13 - root - DEBUG - Combined text: '1 d 2.11cm 2  d 1.54cm'
2025-11-07 15:28:13 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:13 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:13 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:13 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:13 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:13 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:28:13 - root - DEBUG - Pattern 1 found matches: ['2.11cm', '1.54cm']
2025-11-07 15:28:13 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:28:13 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:28:13 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:28:13 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:28:13 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:13 - root - INFO - Final measurement score: 8
2025-11-07 15:28:15 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:28:15 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:15 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:15 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:15 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:28:15 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:15 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:15 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:15 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:15 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:15 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:15 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:15 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:15 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:15 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:15 - root - INFO - Final measurement score: 0
2025-11-07 15:28:15 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:15 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:15 - root - DEBUG - Top 10 score indices: [1, 0, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:28:15 - root - DEBUG - Rank 1: Index 1, Score 8.000000
2025-11-07 15:28:15 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:28:15 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:28:15 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:28:15 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:28:15 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:28:15 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:28:15 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:28:15 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:28:15 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:28:15 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:28:15 - root - DEBUG - All top 10 scores:
2025-11-07 15:28:15 - root - DEBUG - Score index 1: 8.000000
2025-11-07 15:28:15 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:28:15 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:28:15 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:28:15 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:28:15 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:28:15 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:28:15 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:28:15 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:28:15 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:28:15 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:28:15 - root - DEBUG - Table detection completed. Candidates found: 70
2025-11-07 15:28:15 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:15 - root - INFO - Starting organ name identification
2025-11-07 15:28:15 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:15 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:15 - root - INFO - Starting organ label identification
2025-11-07 15:28:15 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:15 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:28:16 - root - DEBUG - Line 1: '64/ 21Hz' (conf: 0.954)
2025-11-07 15:28:16 - root - DEBUG - Line 2: 'Voluson' (conf: 1.000)
2025-11-07 15:28:16 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.999)
2025-11-07 15:28:16 - root - DEBUG - Line 4: '58' (conf: 0.768)
2025-11-07 15:28:16 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:28:16 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.938)
2025-11-07 15:28:16 - root - DEBUG - Line 7: 'Gn -20' (conf: 0.952)
2025-11-07 15:28:16 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.908)
2025-11-07 15:28:16 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:28:16 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:28:16 - root - DEBUG - Line 11: '1 D 2.11cm' (conf: 0.998)
2025-11-07 15:28:16 - root - DEBUG - Line 12: '2 D 1.54cm' (conf: 0.992)
2025-11-07 15:28:16 - root - DEBUG - OCR completed. Processing 12 text lines for organ keywords
2025-11-07 15:28:16 - root - DEBUG - Line 0 text: '64/ 21Hz'
2025-11-07 15:28:16 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:28:16 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:28:16 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:28:16 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:28:16 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:28:16 - root - DEBUG - Line 6 text: 'Gn -20'
2025-11-07 15:28:16 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:28:16 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:28:16 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:28:16 - root - DEBUG - Line 10 text: '1 D 2.11cm'
2025-11-07 15:28:16 - root - DEBUG - Line 11 text: '2 D 1.54cm'
2025-11-07 15:28:16 - root - DEBUG - Combined text for keyword search: '64/ 21hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -20 c7 / m15 ff2/e2 sri ii 2 / cri 2 1 d 2.11cm 2 d 1.54cm'
2025-11-07 15:28:16 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:28:16 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:28:16 - root - INFO - Identified organs: []
2025-11-07 15:28:16 - root - WARNING - No organ name identified from the image
2025-11-07 15:28:16 - root - DEBUG - Organ identified: []
2025-11-07 15:28:16 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:28:16 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:28:16 - root - DEBUG - Best score index: 1
2025-11-07 15:28:16 - root - INFO - Extracting structured data from detected table
2025-11-07 15:28:16 - root - INFO - Starting table content extraction
2025-11-07 15:28:16 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:28:16 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:28:16 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:28:16 - root - INFO - Starting table content extraction
2025-11-07 15:28:16 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:28:16 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:28:17 - root - DEBUG - Line 1: '1 D 2.11cm' (conf: 0.997)
2025-11-07 15:28:17 - root - DEBUG - Line 2: '2 ' (conf: 0.949)
2025-11-07 15:28:17 - root - DEBUG - Line 3: 'D 1.54cm' (conf: 0.999)
2025-11-07 15:28:17 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:28:17 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:28:17 - root - INFO - Structuring extracted text data
2025-11-07 15:28:17 - root - INFO - Starting table data structuring
2025-11-07 15:28:17 - root - DEBUG - Element 1: text='1 D 2.11cm', x=153.00, y=42.50, conf=0.997
2025-11-07 15:28:17 - root - DEBUG - Element 2: text='2 ', x=53.00, y=129.50, conf=0.949
2025-11-07 15:28:17 - root - DEBUG - Element 3: text='D 1.54cm', x=181.50, y=126.00, conf=0.999
2025-11-07 15:28:17 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:28:17 - root - DEBUG - Processing element 1/3: '1 D 2.11cm' at (153.00, 42.50)
2025-11-07 15:28:17 - root - DEBUG - Processing element 2/3: 'D 1.54cm' at (181.50, 126.00)
2025-11-07 15:28:17 - root - DEBUG - Processing element 3/3: '2 ' at (53.00, 129.50)
2025-11-07 15:28:17 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:28:17 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:28:17 - root - DEBUG - Processing word 1/1: '1 D 2.11cm'
2025-11-07 15:28:17 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:17 - root - DEBUG - Input text: '1 D 2.11cm'
2025-11-07 15:28:17 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:17 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:28:17 - root - DEBUG - Pattern 1 groups: ('1', 'D', '2.11cm')
2025-11-07 15:28:17 - root - DEBUG - Pattern 1 result: ('1', 'D', '2.11cm')
2025-11-07 15:28:17 - root - INFO - Text split successful using pattern 1: ('1', 'D', '2.11cm')
2025-11-07 15:28:17 - root - DEBUG - Split measurement result: ('1', 'D', '2.11cm')
2025-11-07 15:28:17 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:28:17 - root - DEBUG - Processing word 1/2: '2 '
2025-11-07 15:28:17 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:17 - root - DEBUG - Input text: '2'
2025-11-07 15:28:17 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:17 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:28:17 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:17 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:28:17 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:28:17 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:28:17 - root - DEBUG - Split measurement result: None
2025-11-07 15:28:17 - root - DEBUG - Processing word 2/2: 'D 1.54cm'
2025-11-07 15:28:17 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:17 - root - DEBUG - Input text: 'D 1.54cm'
2025-11-07 15:28:17 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:17 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:28:17 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:17 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:28:17 - root - DEBUG - Pattern 2 groups: ('D', '1.54cm')
2025-11-07 15:28:17 - root - DEBUG - Pattern 2 result: ('D', '1.54cm')
2025-11-07 15:28:17 - root - INFO - Text split successful using pattern 2: ('D', '1.54cm')
2025-11-07 15:28:17 - root - DEBUG - Split measurement result: ('D', '1.54cm')
2025-11-07 15:28:17 - root - DEBUG - Final structured data:
2025-11-07 15:28:17 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '2.11cm']}'
2025-11-07 15:28:17 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '1.54cm']}'
2025-11-07 15:28:17 - root - INFO - Table content extraction completed successfully
2025-11-07 15:28:17 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:28:17 - root - DEBUG - Organ identified: []
2025-11-07 15:28:17 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000022.dcm
2025-11-07 15:28:17 - root - INFO - Organ identified: []
2025-11-07 15:28:17 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 D 2.11cm', '2 D 1.54cm']}
2025-11-07 15:28:17 - root - INFO - Processing DICOM file 21/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000023.dcm
2025-11-07 15:28:17 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:28:17 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000023.dcm
2025-11-07 15:28:17 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:28:17 - root - INFO - DICOM file loaded successfully
2025-11-07 15:28:17 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:28:17 - root - INFO - Processing RGB format DICOM
2025-11-07 15:28:17 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:28:17 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:28:17 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:28:17 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:28:17 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:28:17 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:28:17 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:28:17 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:28:17 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:17 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:28:17 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:28:17 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:28:17 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:28:17 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:17 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:28:17 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:28:17 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:28:17 - root - INFO - Initializing OCRHandler
2025-11-07 15:28:17 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:28:17 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:28:17 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:28:17 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:28:17 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:28:17 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:28:17 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:28:18 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:28:18 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:28:18 - root - INFO - Initializing TableDetector
2025-11-07 15:28:18 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:28:18 - root - DEBUG - Default detection parameters:
2025-11-07 15:28:18 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:28:18 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:28:18 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:28:18 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:28:18 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:28:18 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:28:18 - root - INFO - TableDetector initialization completed
2025-11-07 15:28:18 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:28:18 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:28:18 - root - DEBUG - Text analysis configuration:
2025-11-07 15:28:18 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:28:18 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:28:18 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:28:18 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:28:18 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:28:18 - root - INFO - Initializing ContentExtractor
2025-11-07 15:28:18 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:28:18 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:28:18 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:28:18 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:28:18 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:28:18 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:28:18 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:28:18 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:28:19 - root - DEBUG - Edge detection completed
2025-11-07 15:28:19 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:28:19 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 151647
2025-11-07 15:28:19 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:28:19 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:28:19 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:28:19 - root - DEBUG - Line enhancement completed
2025-11-07 15:28:19 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:28:19 - root - DEBUG - Line thickening completed
2025-11-07 15:28:19 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:28:19 - root - DEBUG - Line combination completed
2025-11-07 15:28:19 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:28:19 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:28:19 - root - INFO - Found 405 contours
2025-11-07 15:28:19 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:28:19 - root - DEBUG - Contours drawn successfully
2025-11-07 15:28:19 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:28:19 - root - INFO - Rectangular region detection completed
2025-11-07 15:28:19 - root - INFO - Total candidate regions found: 48
2025-11-07 15:28:19 - root - DEBUG - Found 48 candidate regions
2025-11-07 15:28:19 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:28:20 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:20 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:20 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:28:20 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:28:20 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:28:20 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:28:20 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:28:20 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:28:20 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:28:20 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:28:20 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:28:20 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:28:20 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:28:20 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:28:20 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:28:20 - root - DEBUG - Table detection completed. Candidates found: 48
2025-11-07 15:28:20 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:20 - root - INFO - Starting organ name identification
2025-11-07 15:28:20 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:20 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:20 - root - INFO - Starting organ label identification
2025-11-07 15:28:20 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:20 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:28:21 - root - DEBUG - Line 1: '55%/27Hz' (conf: 0.932)
2025-11-07 15:28:21 - root - DEBUG - Line 2: 'Voluson' (conf: 1.000)
2025-11-07 15:28:21 - root - DEBUG - Line 3: 'Uterus' (conf: 0.999)
2025-11-07 15:28:21 - root - DEBUG - Line 4: 'S8' (conf: 0.754)
2025-11-07 15:28:21 - root - DEBUG - Line 5: 'HM PI6.80 -2.70' (conf: 0.897)
2025-11-07 15:28:21 - root - DEBUG - Line 6: 'AO 95%' (conf: 0.947)
2025-11-07 15:28:21 - root - DEBUG - Line 7: 'Gn -13' (conf: 0.940)
2025-11-07 15:28:21 - root - DEBUG - Line 8: 'C6 /M4' (conf: 0.931)
2025-11-07 15:28:21 - root - DEBUG - Line 9: 'FF1/E1' (conf: 0.997)
2025-11-07 15:28:21 - root - DEBUG - Line 10: 'SRI II 3 / CRI 1' (conf: 0.962)
2025-11-07 15:28:21 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:28:21 - root - DEBUG - Line 0 text: '55%/27Hz'
2025-11-07 15:28:21 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:28:21 - root - DEBUG - Line 2 text: 'Uterus'
2025-11-07 15:28:21 - root - DEBUG - Line 3 text: 'S8'
2025-11-07 15:28:21 - root - DEBUG - Line 4 text: 'HM PI6.80 -2.70'
2025-11-07 15:28:21 - root - DEBUG - Line 5 text: 'AO 95%'
2025-11-07 15:28:21 - root - DEBUG - Line 6 text: 'Gn -13'
2025-11-07 15:28:21 - root - DEBUG - Line 7 text: 'C6 /M4'
2025-11-07 15:28:21 - root - DEBUG - Line 8 text: 'FF1/E1'
2025-11-07 15:28:21 - root - DEBUG - Line 9 text: 'SRI II 3 / CRI 1'
2025-11-07 15:28:21 - root - DEBUG - Combined text for keyword search: '55%/27hz voluson uterus s8 hm pi6.80 -2.70 ao 95% gn -13 c6 /m4 ff1/e1 sri ii 3 / cri 1'
2025-11-07 15:28:21 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:28:21 - root - DEBUG - Found organ keyword: 'uterus'
2025-11-07 15:28:21 - root - INFO - Organ identification completed. Found 1 organ keywords
2025-11-07 15:28:21 - root - INFO - Identified organs: ['uterus']
2025-11-07 15:28:21 - root - INFO - Organ identification completed successfully: ['uterus']
2025-11-07 15:28:21 - root - DEBUG - Organ identified: ['uterus']
2025-11-07 15:28:21 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:28:21 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000023.dcm
2025-11-07 15:28:21 - root - INFO - Processing DICOM file 22/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000024.dcm
2025-11-07 15:28:21 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:28:21 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000024.dcm
2025-11-07 15:28:21 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:28:21 - root - INFO - DICOM file loaded successfully
2025-11-07 15:28:21 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:28:21 - root - INFO - Processing RGB format DICOM
2025-11-07 15:28:21 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:28:21 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:28:21 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:28:21 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:28:21 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:28:21 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:28:21 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:28:21 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:28:21 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:21 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:28:21 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:28:21 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:28:21 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:28:21 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:21 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:28:21 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:28:21 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:28:21 - root - INFO - Initializing OCRHandler
2025-11-07 15:28:21 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:28:21 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:28:21 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:28:21 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:28:21 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:28:21 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:28:21 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:28:22 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:28:22 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:28:22 - root - INFO - Initializing TableDetector
2025-11-07 15:28:22 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:28:22 - root - DEBUG - Default detection parameters:
2025-11-07 15:28:22 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:28:22 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:28:22 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:28:22 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:28:22 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:28:22 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:28:22 - root - INFO - TableDetector initialization completed
2025-11-07 15:28:22 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:28:22 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:28:22 - root - DEBUG - Text analysis configuration:
2025-11-07 15:28:22 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:28:22 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:28:22 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:28:22 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:28:22 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:28:22 - root - INFO - Initializing ContentExtractor
2025-11-07 15:28:22 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:28:22 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:28:22 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:28:22 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:28:22 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:28:22 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:28:22 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:28:22 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:28:22 - root - DEBUG - Edge detection completed
2025-11-07 15:28:22 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:28:22 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 289894
2025-11-07 15:28:22 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:28:22 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:28:22 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:28:22 - root - DEBUG - Line enhancement completed
2025-11-07 15:28:22 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:28:22 - root - DEBUG - Line thickening completed
2025-11-07 15:28:22 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:28:22 - root - DEBUG - Line combination completed
2025-11-07 15:28:22 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:28:22 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:28:22 - root - INFO - Found 786 contours
2025-11-07 15:28:22 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:28:22 - root - DEBUG - Contours drawn successfully
2025-11-07 15:28:22 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:28:22 - root - INFO - Rectangular region detection completed
2025-11-07 15:28:22 - root - INFO - Total candidate regions found: 97
2025-11-07 15:28:22 - root - DEBUG - Found 97 candidate regions
2025-11-07 15:28:22 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:28:23 - root - DEBUG - Line 1: '1 D 2.18cm' (conf: 0.989)
2025-11-07 15:28:23 - root - DEBUG - Line 2: '2' (conf: 1.000)
2025-11-07 15:28:23 - root - DEBUG - Line 3: 'D 1.15cm' (conf: 1.000)
2025-11-07 15:28:23 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:23 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:28:23 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:28:23 - root - DEBUG - Combined text: '1 d 2.18cm 2 d 1.15cm'
2025-11-07 15:28:23 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:23 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:23 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:23 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:23 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:23 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:28:23 - root - DEBUG - Pattern 1 found matches: ['2.18cm', '1.15cm']
2025-11-07 15:28:23 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:28:23 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:28:23 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:28:23 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:28:23 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:23 - root - INFO - Final measurement score: 8
2025-11-07 15:28:25 - root - DEBUG - Line 1: 'E2' (conf: 0.998)
2025-11-07 15:28:25 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:25 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:25 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:25 - root - DEBUG - Combined text: 'e2'
2025-11-07 15:28:25 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:25 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:25 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:25 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:25 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:25 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:25 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:25 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:25 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:25 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:25 - root - INFO - Final measurement score: 0
2025-11-07 15:28:26 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:26 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:26 - root - DEBUG - Top 10 score indices: [1, 0, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:28:26 - root - DEBUG - Rank 1: Index 1, Score 8.000000
2025-11-07 15:28:26 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:28:26 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:28:26 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:28:26 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:28:26 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:28:26 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:28:26 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:28:26 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:28:26 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:28:26 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:28:26 - root - DEBUG - All top 10 scores:
2025-11-07 15:28:26 - root - DEBUG - Score index 1: 8.000000
2025-11-07 15:28:26 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:28:26 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:28:26 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:28:26 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:28:26 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:28:26 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:28:26 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:28:26 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:28:26 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:28:26 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:28:26 - root - DEBUG - Table detection completed. Candidates found: 97
2025-11-07 15:28:26 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:26 - root - INFO - Starting organ name identification
2025-11-07 15:28:26 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:26 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:26 - root - INFO - Starting organ label identification
2025-11-07 15:28:26 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:26 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:28:27 - root - DEBUG - Line 1: '64/19Hz' (conf: 1.000)
2025-11-07 15:28:27 - root - DEBUG - Line 2: 'Voluson' (conf: 0.995)
2025-11-07 15:28:27 - root - DEBUG - Line 3: 'Abdomen 1' (conf: 0.999)
2025-11-07 15:28:27 - root - DEBUG - Line 4: '58' (conf: 0.891)
2025-11-07 15:28:27 - root - DEBUG - Line 5: 'HM PI 7.70 - 2.10' (conf: 0.977)
2025-11-07 15:28:27 - root - DEBUG - Line 6: 'AO 100%' (conf: 0.935)
2025-11-07 15:28:27 - root - DEBUG - Line 7: 'Gn -9' (conf: 0.897)
2025-11-07 15:28:27 - root - DEBUG - Line 8: 'C7 / M15' (conf: 0.886)
2025-11-07 15:28:27 - root - DEBUG - Line 9: 'FF2/E2' (conf: 0.994)
2025-11-07 15:28:27 - root - DEBUG - Line 10: 'SRI II 2 / CRI 2' (conf: 0.964)
2025-11-07 15:28:27 - root - DEBUG - Line 11: 'RT OVARY' (conf: 1.000)
2025-11-07 15:28:27 - root - DEBUG - Line 12: '1 D 2.18cm' (conf: 0.987)
2025-11-07 15:28:27 - root - DEBUG - Line 13: '2 D 1.15cm' (conf: 0.998)
2025-11-07 15:28:27 - root - DEBUG - OCR completed. Processing 13 text lines for organ keywords
2025-11-07 15:28:27 - root - DEBUG - Line 0 text: '64/19Hz'
2025-11-07 15:28:27 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:28:27 - root - DEBUG - Line 2 text: 'Abdomen 1'
2025-11-07 15:28:27 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:28:27 - root - DEBUG - Line 4 text: 'HM PI 7.70 - 2.10'
2025-11-07 15:28:27 - root - DEBUG - Line 5 text: 'AO 100%'
2025-11-07 15:28:27 - root - DEBUG - Line 6 text: 'Gn -9'
2025-11-07 15:28:27 - root - DEBUG - Line 7 text: 'C7 / M15'
2025-11-07 15:28:27 - root - DEBUG - Line 8 text: 'FF2/E2'
2025-11-07 15:28:27 - root - DEBUG - Line 9 text: 'SRI II 2 / CRI 2'
2025-11-07 15:28:27 - root - DEBUG - Line 10 text: 'RT OVARY'
2025-11-07 15:28:27 - root - DEBUG - Line 11 text: '1 D 2.18cm'
2025-11-07 15:28:27 - root - DEBUG - Line 12 text: '2 D 1.15cm'
2025-11-07 15:28:27 - root - DEBUG - Combined text for keyword search: '64/19hz voluson abdomen 1 58 hm pi 7.70 - 2.10 ao 100% gn -9 c7 / m15 ff2/e2 sri ii 2 / cri 2 rt ovary 1 d 2.18cm 2 d 1.15cm'
2025-11-07 15:28:27 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:28:27 - root - DEBUG - Found organ keyword: 'rt ovary'
2025-11-07 15:28:27 - root - INFO - Organ identification completed. Found 1 organ keywords
2025-11-07 15:28:27 - root - INFO - Identified organs: ['rt ovary']
2025-11-07 15:28:27 - root - INFO - Organ identification completed successfully: ['rt ovary']
2025-11-07 15:28:27 - root - DEBUG - Organ identified: ['rt ovary']
2025-11-07 15:28:27 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:28:27 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:28:27 - root - DEBUG - Best score index: 1
2025-11-07 15:28:27 - root - INFO - Extracting structured data from detected table
2025-11-07 15:28:27 - root - INFO - Starting table content extraction
2025-11-07 15:28:27 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:28:27 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:28:27 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:28:27 - root - INFO - Starting table content extraction
2025-11-07 15:28:27 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 162)
2025-11-07 15:28:27 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:28:27 - root - DEBUG - Line 1: '1 D 2.18cm' (conf: 0.989)
2025-11-07 15:28:27 - root - DEBUG - Line 2: '2' (conf: 1.000)
2025-11-07 15:28:27 - root - DEBUG - Line 3: 'D 1.15cm' (conf: 1.000)
2025-11-07 15:28:27 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:28:27 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:28:27 - root - INFO - Structuring extracted text data
2025-11-07 15:28:27 - root - INFO - Starting table data structuring
2025-11-07 15:28:27 - root - DEBUG - Element 1: text='1 D 2.18cm', x=153.00, y=43.00, conf=0.989
2025-11-07 15:28:27 - root - DEBUG - Element 2: text='2', x=43.00, y=129.50, conf=1.000
2025-11-07 15:28:27 - root - DEBUG - Element 3: text='D 1.15cm', x=181.50, y=126.00, conf=1.000
2025-11-07 15:28:27 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:28:27 - root - DEBUG - Processing element 1/3: '1 D 2.18cm' at (153.00, 43.00)
2025-11-07 15:28:27 - root - DEBUG - Processing element 2/3: 'D 1.15cm' at (181.50, 126.00)
2025-11-07 15:28:27 - root - DEBUG - Processing element 3/3: '2' at (43.00, 129.50)
2025-11-07 15:28:27 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:28:27 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:28:27 - root - DEBUG - Processing word 1/1: '1 D 2.18cm'
2025-11-07 15:28:27 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:27 - root - DEBUG - Input text: '1 D 2.18cm'
2025-11-07 15:28:27 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:27 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:28:27 - root - DEBUG - Pattern 1 groups: ('1', 'D', '2.18cm')
2025-11-07 15:28:27 - root - DEBUG - Pattern 1 result: ('1', 'D', '2.18cm')
2025-11-07 15:28:27 - root - INFO - Text split successful using pattern 1: ('1', 'D', '2.18cm')
2025-11-07 15:28:27 - root - DEBUG - Split measurement result: ('1', 'D', '2.18cm')
2025-11-07 15:28:27 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:28:27 - root - DEBUG - Processing word 1/2: '2'
2025-11-07 15:28:27 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:27 - root - DEBUG - Input text: '2'
2025-11-07 15:28:27 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:27 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:28:27 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:27 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:28:27 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:28:27 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:28:27 - root - DEBUG - Split measurement result: None
2025-11-07 15:28:27 - root - DEBUG - Processing word 2/2: 'D 1.15cm'
2025-11-07 15:28:27 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:27 - root - DEBUG - Input text: 'D 1.15cm'
2025-11-07 15:28:27 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:27 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:28:27 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:27 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:28:27 - root - DEBUG - Pattern 2 groups: ('D', '1.15cm')
2025-11-07 15:28:27 - root - DEBUG - Pattern 2 result: ('D', '1.15cm')
2025-11-07 15:28:27 - root - INFO - Text split successful using pattern 2: ('D', '1.15cm')
2025-11-07 15:28:27 - root - DEBUG - Split measurement result: ('D', '1.15cm')
2025-11-07 15:28:27 - root - DEBUG - Final structured data:
2025-11-07 15:28:27 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '2.18cm']}'
2025-11-07 15:28:27 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '1.15cm']}'
2025-11-07 15:28:27 - root - INFO - Table content extraction completed successfully
2025-11-07 15:28:27 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:28:27 - root - DEBUG - Organ identified: ['rt ovary']
2025-11-07 15:28:27 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000024.dcm
2025-11-07 15:28:27 - root - INFO - Organ identified: ['rt ovary']
2025-11-07 15:28:27 - root - DEBUG - Structured data extracted: {'organLabel': ['rt ovary'], 'value': ['1 D 2.18cm', '2 D 1.15cm']}
2025-11-07 15:28:27 - root - INFO - Processing DICOM file 23/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000025.dcm
2025-11-07 15:28:27 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:28:27 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000025.dcm
2025-11-07 15:28:27 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:28:27 - root - INFO - DICOM file loaded successfully
2025-11-07 15:28:27 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:28:27 - root - INFO - Processing RGB format DICOM
2025-11-07 15:28:27 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:28:27 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:28:27 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:28:27 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:28:27 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:28:27 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:28:27 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:28:27 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:28:27 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:27 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:28:27 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:28:27 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:28:27 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:28:27 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:27 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:28:27 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:28:27 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:28:27 - root - INFO - Initializing OCRHandler
2025-11-07 15:28:27 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:28:27 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:28:27 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:28:27 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:28:27 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:28:27 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:28:27 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:28:28 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:28:28 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:28:28 - root - INFO - Initializing TableDetector
2025-11-07 15:28:28 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:28:28 - root - DEBUG - Default detection parameters:
2025-11-07 15:28:28 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:28:28 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:28:28 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:28:28 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:28:28 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:28:28 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:28:28 - root - INFO - TableDetector initialization completed
2025-11-07 15:28:28 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:28:28 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:28:28 - root - DEBUG - Text analysis configuration:
2025-11-07 15:28:28 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:28:28 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:28:28 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:28:28 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:28:28 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:28:28 - root - INFO - Initializing ContentExtractor
2025-11-07 15:28:28 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:28:28 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:28:28 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:28:28 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:28:28 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:28:28 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:28:28 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:28:28 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:28:28 - root - DEBUG - Edge detection completed
2025-11-07 15:28:28 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:28:28 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 265250
2025-11-07 15:28:28 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:28:28 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:28:28 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:28:28 - root - DEBUG - Line enhancement completed
2025-11-07 15:28:28 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:28:28 - root - DEBUG - Line thickening completed
2025-11-07 15:28:28 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:28:28 - root - DEBUG - Line combination completed
2025-11-07 15:28:28 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:28:28 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:28:28 - root - INFO - Found 581 contours
2025-11-07 15:28:28 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:28:28 - root - DEBUG - Contours drawn successfully
2025-11-07 15:28:28 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:28:28 - root - INFO - Rectangular region detection completed
2025-11-07 15:28:28 - root - INFO - Total candidate regions found: 86
2025-11-07 15:28:28 - root - DEBUG - Found 86 candidate regions
2025-11-07 15:28:28 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:28:31 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:31 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:31 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:28:31 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:28:31 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:28:31 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:28:31 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:28:31 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:28:31 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:28:31 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:28:31 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:28:31 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:28:31 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:28:31 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:28:31 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:28:31 - root - DEBUG - Table detection completed. Candidates found: 86
2025-11-07 15:28:31 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:31 - root - INFO - Starting organ name identification
2025-11-07 15:28:31 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:31 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:31 - root - INFO - Starting organ label identification
2025-11-07 15:28:31 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:31 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:28:32 - root - DEBUG - Line 1: '55/ 29Hz' (conf: 0.983)
2025-11-07 15:28:32 - root - DEBUG - Line 2: 'Routine Sepia' (conf: 0.999)
2025-11-07 15:28:32 - root - DEBUG - Line 3: 'Voluson' (conf: 0.995)
2025-11-07 15:28:32 - root - DEBUG - Line 4: 'S8' (conf: 0.651)
2025-11-07 15:28:32 - root - DEBUG - Line 5: 'HM PI6.80 -2.70' (conf: 0.897)
2025-11-07 15:28:32 - root - DEBUG - Line 6: 'AO 95%' (conf: 0.972)
2025-11-07 15:28:32 - root - DEBUG - Line 7: 'Gn -8' (conf: 0.948)
2025-11-07 15:28:32 - root - DEBUG - Line 8: 'C7 / M4' (conf: 0.937)
2025-11-07 15:28:32 - root - DEBUG - Line 9: 'FF1/E1' (conf: 0.997)
2025-11-07 15:28:32 - root - DEBUG - Line 10: 'SRI II 3 / CRI 1' (conf: 0.962)
2025-11-07 15:28:32 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:28:32 - root - DEBUG - Line 0 text: '55/ 29Hz'
2025-11-07 15:28:32 - root - DEBUG - Line 1 text: 'Routine Sepia'
2025-11-07 15:28:32 - root - DEBUG - Line 2 text: 'Voluson'
2025-11-07 15:28:32 - root - DEBUG - Line 3 text: 'S8'
2025-11-07 15:28:32 - root - DEBUG - Line 4 text: 'HM PI6.80 -2.70'
2025-11-07 15:28:32 - root - DEBUG - Line 5 text: 'AO 95%'
2025-11-07 15:28:32 - root - DEBUG - Line 6 text: 'Gn -8'
2025-11-07 15:28:32 - root - DEBUG - Line 7 text: 'C7 / M4'
2025-11-07 15:28:32 - root - DEBUG - Line 8 text: 'FF1/E1'
2025-11-07 15:28:32 - root - DEBUG - Line 9 text: 'SRI II 3 / CRI 1'
2025-11-07 15:28:32 - root - DEBUG - Combined text for keyword search: '55/ 29hz routine sepia voluson s8 hm pi6.80 -2.70 ao 95% gn -8 c7 / m4 ff1/e1 sri ii 3 / cri 1'
2025-11-07 15:28:32 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:28:32 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:28:32 - root - INFO - Identified organs: []
2025-11-07 15:28:32 - root - WARNING - No organ name identified from the image
2025-11-07 15:28:32 - root - DEBUG - Organ identified: []
2025-11-07 15:28:32 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:28:32 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000025.dcm
2025-11-07 15:28:32 - root - INFO - Processing DICOM file 24/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000026.dcm
2025-11-07 15:28:32 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:28:32 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000026.dcm
2025-11-07 15:28:32 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:28:32 - root - INFO - DICOM file loaded successfully
2025-11-07 15:28:32 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:28:32 - root - INFO - Processing RGB format DICOM
2025-11-07 15:28:32 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:28:32 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:28:32 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:28:32 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:28:32 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:28:32 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:28:32 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:28:32 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:28:32 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:32 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:28:32 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:28:32 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:28:32 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:28:32 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:32 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:28:32 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:28:32 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:28:32 - root - INFO - Initializing OCRHandler
2025-11-07 15:28:32 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:28:32 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:28:32 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:28:32 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:28:32 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:28:32 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:28:32 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:28:33 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:28:33 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:28:33 - root - INFO - Initializing TableDetector
2025-11-07 15:28:33 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:28:33 - root - DEBUG - Default detection parameters:
2025-11-07 15:28:33 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:28:33 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:28:33 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:28:33 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:28:33 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:28:33 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:28:33 - root - INFO - TableDetector initialization completed
2025-11-07 15:28:33 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:28:33 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:28:33 - root - DEBUG - Text analysis configuration:
2025-11-07 15:28:33 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:28:33 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:28:33 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:28:33 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:28:33 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:28:33 - root - INFO - Initializing ContentExtractor
2025-11-07 15:28:33 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:28:33 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:28:33 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:28:33 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:28:33 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:28:33 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:28:33 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:28:33 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:28:33 - root - DEBUG - Edge detection completed
2025-11-07 15:28:33 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:28:33 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 236961
2025-11-07 15:28:33 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:28:33 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:28:33 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:28:33 - root - DEBUG - Line enhancement completed
2025-11-07 15:28:33 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:28:33 - root - DEBUG - Line thickening completed
2025-11-07 15:28:33 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:28:33 - root - DEBUG - Line combination completed
2025-11-07 15:28:33 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:28:33 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:28:33 - root - INFO - Found 599 contours
2025-11-07 15:28:33 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:28:33 - root - DEBUG - Contours drawn successfully
2025-11-07 15:28:33 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:28:33 - root - INFO - Rectangular region detection completed
2025-11-07 15:28:33 - root - INFO - Total candidate regions found: 76
2025-11-07 15:28:33 - root - DEBUG - Found 76 candidate regions
2025-11-07 15:28:33 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:28:33 - root - DEBUG - Line 1: '1 D 0.39cm' (conf: 0.996)
2025-11-07 15:28:33 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:33 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:33 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:33 - root - DEBUG - Combined text: '1 d 0.39cm'
2025-11-07 15:28:33 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:33 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:33 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:33 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:33 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:33 - root - DEBUG - Pattern 1 matches: 1
2025-11-07 15:28:33 - root - DEBUG - Pattern 1 found matches: ['0.39cm']
2025-11-07 15:28:33 - root - DEBUG - Pattern 2 matches: 1
2025-11-07 15:28:33 - root - DEBUG - Pattern 2 found matches: ['d']
2025-11-07 15:28:33 - root - DEBUG - Base score from pattern matching: 2
2025-11-07 15:28:33 - root - DEBUG - 'cm' occurrences: 1, bonus added: 2
2025-11-07 15:28:33 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:33 - root - INFO - Final measurement score: 4
2025-11-07 15:28:36 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:36 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:36 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:28:36 - root - DEBUG - Rank 1: Index 0, Score 4.000000
2025-11-07 15:28:36 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:28:36 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:28:36 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:28:36 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:28:36 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:28:36 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:28:36 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:28:36 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:28:36 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:28:36 - root - INFO - Best candidate meets threshold (>= 4). Score: 4.000000
2025-11-07 15:28:36 - root - DEBUG - All top 10 scores:
2025-11-07 15:28:36 - root - DEBUG - Score index 0: 4.000000
2025-11-07 15:28:36 - root - DEBUG - Score index 1: 0.000000
2025-11-07 15:28:36 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:28:36 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:28:36 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:28:36 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:28:36 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:28:36 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:28:36 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:28:36 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:28:36 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:28:36 - root - DEBUG - Table detection completed. Candidates found: 76
2025-11-07 15:28:36 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:36 - root - INFO - Starting organ name identification
2025-11-07 15:28:36 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:36 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:36 - root - INFO - Starting organ label identification
2025-11-07 15:28:36 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:36 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:28:37 - root - DEBUG - Line 1: '55/ 29Hz' (conf: 0.983)
2025-11-07 15:28:37 - root - DEBUG - Line 2: ' Routine Sepia' (conf: 0.936)
2025-11-07 15:28:37 - root - DEBUG - Line 3: 'Voluson' (conf: 0.995)
2025-11-07 15:28:37 - root - DEBUG - Line 4: 'S8' (conf: 0.815)
2025-11-07 15:28:37 - root - DEBUG - Line 5: 'HM PI6.80 -2.70' (conf: 0.897)
2025-11-07 15:28:37 - root - DEBUG - Line 6: 'AO 95%' (conf: 0.972)
2025-11-07 15:28:37 - root - DEBUG - Line 7: 'Gn -8' (conf: 0.948)
2025-11-07 15:28:37 - root - DEBUG - Line 8: 'C7 / M4' (conf: 0.937)
2025-11-07 15:28:37 - root - DEBUG - Line 9: 'FF1/E1' (conf: 0.997)
2025-11-07 15:28:37 - root - DEBUG - Line 10: 'SRI II 3 / CRI 1' (conf: 0.962)
2025-11-07 15:28:37 - root - DEBUG - Line 11: '1 D 0.39cm' (conf: 0.996)
2025-11-07 15:28:37 - root - DEBUG - OCR completed. Processing 11 text lines for organ keywords
2025-11-07 15:28:37 - root - DEBUG - Line 0 text: '55/ 29Hz'
2025-11-07 15:28:37 - root - DEBUG - Line 1 text: ' Routine Sepia'
2025-11-07 15:28:37 - root - DEBUG - Line 2 text: 'Voluson'
2025-11-07 15:28:37 - root - DEBUG - Line 3 text: 'S8'
2025-11-07 15:28:37 - root - DEBUG - Line 4 text: 'HM PI6.80 -2.70'
2025-11-07 15:28:37 - root - DEBUG - Line 5 text: 'AO 95%'
2025-11-07 15:28:37 - root - DEBUG - Line 6 text: 'Gn -8'
2025-11-07 15:28:37 - root - DEBUG - Line 7 text: 'C7 / M4'
2025-11-07 15:28:37 - root - DEBUG - Line 8 text: 'FF1/E1'
2025-11-07 15:28:37 - root - DEBUG - Line 9 text: 'SRI II 3 / CRI 1'
2025-11-07 15:28:37 - root - DEBUG - Line 10 text: '1 D 0.39cm'
2025-11-07 15:28:37 - root - DEBUG - Combined text for keyword search: '55/ 29hz  routine sepia voluson s8 hm pi6.80 -2.70 ao 95% gn -8 c7 / m4 ff1/e1 sri ii 3 / cri 1 1 d 0.39cm'
2025-11-07 15:28:37 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:28:37 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:28:37 - root - INFO - Identified organs: []
2025-11-07 15:28:37 - root - WARNING - No organ name identified from the image
2025-11-07 15:28:37 - root - DEBUG - Organ identified: []
2025-11-07 15:28:37 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:28:37 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:28:37 - root - DEBUG - Best score index: 0
2025-11-07 15:28:37 - root - INFO - Extracting structured data from detected table
2025-11-07 15:28:37 - root - INFO - Starting table content extraction
2025-11-07 15:28:37 - root - DEBUG - Bounding box coordinates: (3110, 2225, 294, 78)
2025-11-07 15:28:37 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:28:37 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:28:37 - root - INFO - Starting table content extraction
2025-11-07 15:28:37 - root - DEBUG - Bounding box coordinates: (3110, 2225, 294, 78)
2025-11-07 15:28:37 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:28:37 - root - DEBUG - Line 1: '1 D 0.39cm' (conf: 0.996)
2025-11-07 15:28:37 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:28:37 - root - INFO - Extracted 1 text elements from table region
2025-11-07 15:28:37 - root - INFO - Structuring extracted text data
2025-11-07 15:28:37 - root - INFO - Starting table data structuring
2025-11-07 15:28:37 - root - DEBUG - Element 1: text='1 D 0.39cm', x=154.00, y=42.50, conf=0.996
2025-11-07 15:28:37 - root - INFO - Filtered 0 elements, 1 remaining
2025-11-07 15:28:37 - root - DEBUG - Processing element 1/1: '1 D 0.39cm' at (154.00, 42.50)
2025-11-07 15:28:37 - root - INFO - Line grouping completed - Total lines: 1
2025-11-07 15:28:37 - root - DEBUG - Processing line 1/1 with 1 elements
2025-11-07 15:28:37 - root - DEBUG - Processing word 1/1: '1 D 0.39cm'
2025-11-07 15:28:37 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:37 - root - DEBUG - Input text: '1 D 0.39cm'
2025-11-07 15:28:37 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:37 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:28:37 - root - DEBUG - Pattern 1 groups: ('1', 'D', '0.39cm')
2025-11-07 15:28:37 - root - DEBUG - Pattern 1 result: ('1', 'D', '0.39cm')
2025-11-07 15:28:37 - root - INFO - Text split successful using pattern 1: ('1', 'D', '0.39cm')
2025-11-07 15:28:37 - root - DEBUG - Split measurement result: ('1', 'D', '0.39cm')
2025-11-07 15:28:37 - root - DEBUG - Final structured data:
2025-11-07 15:28:37 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '0.39cm']}'
2025-11-07 15:28:37 - root - INFO - Table content extraction completed successfully
2025-11-07 15:28:37 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:28:37 - root - DEBUG - Organ identified: []
2025-11-07 15:28:37 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000026.dcm
2025-11-07 15:28:37 - root - INFO - Organ identified: []
2025-11-07 15:28:37 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 D 0.39cm']}
2025-11-07 15:28:37 - root - INFO - Processing DICOM file 25/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000027.dcm
2025-11-07 15:28:37 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:28:37 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000027.dcm
2025-11-07 15:28:37 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:28:37 - root - INFO - DICOM file loaded successfully
2025-11-07 15:28:37 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:28:37 - root - INFO - Processing RGB format DICOM
2025-11-07 15:28:37 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:28:37 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:28:37 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:28:37 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:28:37 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:28:37 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:28:37 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:28:37 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:28:37 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:37 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:28:37 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:28:37 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:28:37 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:28:37 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:37 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:28:37 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:28:37 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:28:37 - root - INFO - Initializing OCRHandler
2025-11-07 15:28:37 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:28:37 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:28:37 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:28:37 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:28:37 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:28:37 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:28:37 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:28:39 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:28:39 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:28:39 - root - INFO - Initializing TableDetector
2025-11-07 15:28:39 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:28:39 - root - DEBUG - Default detection parameters:
2025-11-07 15:28:39 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:28:39 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:28:39 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:28:39 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:28:39 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:28:39 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:28:39 - root - INFO - TableDetector initialization completed
2025-11-07 15:28:39 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:28:39 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:28:39 - root - DEBUG - Text analysis configuration:
2025-11-07 15:28:39 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:28:39 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:28:39 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:28:39 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:28:39 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:28:39 - root - INFO - Initializing ContentExtractor
2025-11-07 15:28:39 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:28:39 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:28:39 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:28:39 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:28:39 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:28:39 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:28:39 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:28:39 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:28:39 - root - DEBUG - Edge detection completed
2025-11-07 15:28:39 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:28:39 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 314769
2025-11-07 15:28:39 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:28:39 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:28:39 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:28:39 - root - DEBUG - Line enhancement completed
2025-11-07 15:28:39 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:28:39 - root - DEBUG - Line thickening completed
2025-11-07 15:28:39 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:28:39 - root - DEBUG - Line combination completed
2025-11-07 15:28:39 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:28:39 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:28:39 - root - INFO - Found 1008 contours
2025-11-07 15:28:39 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:28:39 - root - DEBUG - Contours drawn successfully
2025-11-07 15:28:39 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:28:39 - root - INFO - Rectangular region detection completed
2025-11-07 15:28:39 - root - INFO - Total candidate regions found: 47
2025-11-07 15:28:39 - root - DEBUG - Found 47 candidate regions
2025-11-07 15:28:39 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:28:41 - root - DEBUG - Line 1: '80' (conf: 0.995)
2025-11-07 15:28:41 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:41 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:41 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:41 - root - DEBUG - Combined text: '80'
2025-11-07 15:28:41 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:41 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:41 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:41 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:41 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:41 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:41 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:41 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:41 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:41 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:41 - root - INFO - Final measurement score: 0
2025-11-07 15:28:42 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:42 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:42 - root - DEBUG - Top 10 score indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:28:42 - root - DEBUG - Rank 1: Index 0, Score 0.000000
2025-11-07 15:28:42 - root - DEBUG - Rank 2: Index 1, Score 0.000000
2025-11-07 15:28:42 - root - DEBUG - Rank 3: Index 2, Score 0.000000
2025-11-07 15:28:42 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:28:42 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:28:42 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:28:42 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:28:42 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:28:42 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:28:42 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:28:42 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 0.000000
2025-11-07 15:28:42 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:28:42 - root - DEBUG - Table detection completed. Candidates found: 47
2025-11-07 15:28:42 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:42 - root - INFO - Starting organ name identification
2025-11-07 15:28:42 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:42 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:42 - root - INFO - Starting organ label identification
2025-11-07 15:28:42 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:42 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:28:43 - root - DEBUG - Line 1: '180/21Hz' (conf: 1.000)
2025-11-07 15:28:43 - root - DEBUG - Line 2: 'Routine HI' (conf: 0.999)
2025-11-07 15:28:43 - root - DEBUG - Line 3: '58' (conf: 0.849)
2025-11-07 15:28:43 - root - DEBUG - Line 4: 'HM PI 11.80 - 2.50' (conf: 0.955)
2025-11-07 15:28:43 - root - DEBUG - Line 5: 'AO100%' (conf: 0.987)
2025-11-07 15:28:43 - root - DEBUG - Line 6: 'Gn 11' (conf: 0.898)
2025-11-07 15:28:43 - root - DEBUG - Line 7: 'C6/M7' (conf: 0.992)
2025-11-07 15:28:43 - root - DEBUG - Line 8: 'FF1/E2' (conf: 0.969)
2025-11-07 15:28:43 - root - DEBUG - Line 9: 'SRI II 3/CRI 1' (conf: 0.897)
2025-11-07 15:28:43 - root - DEBUG - OCR completed. Processing 9 text lines for organ keywords
2025-11-07 15:28:43 - root - DEBUG - Line 0 text: '180/21Hz'
2025-11-07 15:28:43 - root - DEBUG - Line 1 text: 'Routine HI'
2025-11-07 15:28:43 - root - DEBUG - Line 2 text: '58'
2025-11-07 15:28:43 - root - DEBUG - Line 3 text: 'HM PI 11.80 - 2.50'
2025-11-07 15:28:43 - root - DEBUG - Line 4 text: 'AO100%'
2025-11-07 15:28:43 - root - DEBUG - Line 5 text: 'Gn 11'
2025-11-07 15:28:43 - root - DEBUG - Line 6 text: 'C6/M7'
2025-11-07 15:28:43 - root - DEBUG - Line 7 text: 'FF1/E2'
2025-11-07 15:28:43 - root - DEBUG - Line 8 text: 'SRI II 3/CRI 1'
2025-11-07 15:28:43 - root - DEBUG - Combined text for keyword search: '180/21hz routine hi 58 hm pi 11.80 - 2.50 ao100% gn 11 c6/m7 ff1/e2 sri ii 3/cri 1'
2025-11-07 15:28:43 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:28:43 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:28:43 - root - INFO - Identified organs: []
2025-11-07 15:28:43 - root - WARNING - No organ name identified from the image
2025-11-07 15:28:43 - root - DEBUG - Organ identified: []
2025-11-07 15:28:43 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:28:43 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000027.dcm
2025-11-07 15:28:43 - root - INFO - Processing DICOM file 26/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000028.dcm
2025-11-07 15:28:43 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:28:43 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000028.dcm
2025-11-07 15:28:43 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:28:43 - root - INFO - DICOM file loaded successfully
2025-11-07 15:28:43 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:28:43 - root - INFO - Processing RGB format DICOM
2025-11-07 15:28:43 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:28:43 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:28:43 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:28:43 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:28:43 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:28:43 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:28:43 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:28:43 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:28:43 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:43 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:28:43 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:28:43 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:28:43 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:28:43 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:43 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:28:43 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:28:43 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:28:43 - root - INFO - Initializing OCRHandler
2025-11-07 15:28:43 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:28:43 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:28:43 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:28:43 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:28:43 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:28:43 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:28:43 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:28:44 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:28:44 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:28:44 - root - INFO - Initializing TableDetector
2025-11-07 15:28:44 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:28:44 - root - DEBUG - Default detection parameters:
2025-11-07 15:28:44 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:28:44 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:28:44 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:28:44 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:28:44 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:28:44 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:28:44 - root - INFO - TableDetector initialization completed
2025-11-07 15:28:44 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:28:44 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:28:44 - root - DEBUG - Text analysis configuration:
2025-11-07 15:28:44 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:28:44 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:28:44 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:28:44 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:28:44 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:28:44 - root - INFO - Initializing ContentExtractor
2025-11-07 15:28:44 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:28:44 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:28:44 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:28:44 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:28:44 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:28:44 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:28:44 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:28:44 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:28:44 - root - DEBUG - Edge detection completed
2025-11-07 15:28:44 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:28:44 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 316076
2025-11-07 15:28:44 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:28:44 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:28:44 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:28:44 - root - DEBUG - Line enhancement completed
2025-11-07 15:28:44 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:28:44 - root - DEBUG - Line thickening completed
2025-11-07 15:28:44 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:28:44 - root - DEBUG - Line combination completed
2025-11-07 15:28:44 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:28:44 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:28:44 - root - INFO - Found 880 contours
2025-11-07 15:28:44 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:28:44 - root - DEBUG - Contours drawn successfully
2025-11-07 15:28:44 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:28:44 - root - INFO - Rectangular region detection completed
2025-11-07 15:28:44 - root - INFO - Total candidate regions found: 79
2025-11-07 15:28:44 - root - DEBUG - Found 79 candidate regions
2025-11-07 15:28:44 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:28:45 - root - DEBUG - Line 1: '00c' (conf: 0.838)
2025-11-07 15:28:45 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:45 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:45 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:45 - root - DEBUG - Combined text: '00c'
2025-11-07 15:28:45 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:45 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:45 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:45 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:45 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:45 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:45 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:45 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:45 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:45 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:45 - root - INFO - Final measurement score: 0
2025-11-07 15:28:45 - root - DEBUG - Line 1: '1 D 2.00cm' (conf: 0.998)
2025-11-07 15:28:45 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:28:45 - root - DEBUG - Line 3: 'D 1.61cm' (conf: 0.999)
2025-11-07 15:28:45 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:45 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:28:45 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:28:45 - root - DEBUG - Combined text: '1 d 2.00cm 2  d 1.61cm'
2025-11-07 15:28:45 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:45 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:45 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:45 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:45 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:45 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:28:45 - root - DEBUG - Pattern 1 found matches: ['2.00cm', '1.61cm']
2025-11-07 15:28:45 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:28:45 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:28:45 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:28:45 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:28:45 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:45 - root - INFO - Final measurement score: 8
2025-11-07 15:28:48 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:48 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:48 - root - DEBUG - Top 10 score indices: [4, 0, 1, 2, 3, 5, 6, 7, 8, 9]
2025-11-07 15:28:48 - root - DEBUG - Rank 1: Index 4, Score 8.000000
2025-11-07 15:28:48 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:28:48 - root - DEBUG - Rank 3: Index 1, Score 0.000000
2025-11-07 15:28:48 - root - DEBUG - Rank 4: Index 2, Score 0.000000
2025-11-07 15:28:48 - root - DEBUG - Rank 5: Index 3, Score 0.000000
2025-11-07 15:28:48 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:28:48 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:28:48 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:28:48 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:28:48 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:28:48 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:28:48 - root - DEBUG - All top 10 scores:
2025-11-07 15:28:48 - root - DEBUG - Score index 4: 8.000000
2025-11-07 15:28:48 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:28:48 - root - DEBUG - Score index 1: 0.000000
2025-11-07 15:28:48 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:28:48 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:28:48 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:28:48 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:28:48 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:28:48 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:28:48 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:28:48 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:28:48 - root - DEBUG - Table detection completed. Candidates found: 79
2025-11-07 15:28:48 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:48 - root - INFO - Starting organ name identification
2025-11-07 15:28:48 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:48 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:48 - root - INFO - Starting organ label identification
2025-11-07 15:28:48 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:48 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:28:49 - root - DEBUG - Line 1: '180/21Hz' (conf: 1.000)
2025-11-07 15:28:49 - root - DEBUG - Line 2: 'Voluson' (conf: 0.994)
2025-11-07 15:28:49 - root - DEBUG - Line 3: 'Routine HI' (conf: 0.994)
2025-11-07 15:28:49 - root - DEBUG - Line 4: '58' (conf: 0.888)
2025-11-07 15:28:49 - root - DEBUG - Line 5: 'HM PI 11.80 - 2.50' (conf: 0.967)
2025-11-07 15:28:49 - root - DEBUG - Line 6: 'AO100%' (conf: 0.997)
2025-11-07 15:28:49 - root - DEBUG - Line 7: 'Gn15' (conf: 0.998)
2025-11-07 15:28:49 - root - DEBUG - Line 8: 'C6/M7' (conf: 0.993)
2025-11-07 15:28:49 - root - DEBUG - Line 9: 'FF1/E2' (conf: 0.984)
2025-11-07 15:28:49 - root - DEBUG - Line 10: 'SRI II 3/CRI 1' (conf: 0.915)
2025-11-07 15:28:49 - root - DEBUG - Line 11: '1 D 2.00cm' (conf: 0.992)
2025-11-07 15:28:49 - root - DEBUG - Line 12: '2 D 1.61cm' (conf: 0.998)
2025-11-07 15:28:49 - root - DEBUG - OCR completed. Processing 12 text lines for organ keywords
2025-11-07 15:28:49 - root - DEBUG - Line 0 text: '180/21Hz'
2025-11-07 15:28:49 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:28:49 - root - DEBUG - Line 2 text: 'Routine HI'
2025-11-07 15:28:49 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:28:49 - root - DEBUG - Line 4 text: 'HM PI 11.80 - 2.50'
2025-11-07 15:28:49 - root - DEBUG - Line 5 text: 'AO100%'
2025-11-07 15:28:49 - root - DEBUG - Line 6 text: 'Gn15'
2025-11-07 15:28:49 - root - DEBUG - Line 7 text: 'C6/M7'
2025-11-07 15:28:49 - root - DEBUG - Line 8 text: 'FF1/E2'
2025-11-07 15:28:49 - root - DEBUG - Line 9 text: 'SRI II 3/CRI 1'
2025-11-07 15:28:49 - root - DEBUG - Line 10 text: '1 D 2.00cm'
2025-11-07 15:28:49 - root - DEBUG - Line 11 text: '2 D 1.61cm'
2025-11-07 15:28:49 - root - DEBUG - Combined text for keyword search: '180/21hz voluson routine hi 58 hm pi 11.80 - 2.50 ao100% gn15 c6/m7 ff1/e2 sri ii 3/cri 1 1 d 2.00cm 2 d 1.61cm'
2025-11-07 15:28:49 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:28:49 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:28:49 - root - INFO - Identified organs: []
2025-11-07 15:28:49 - root - WARNING - No organ name identified from the image
2025-11-07 15:28:49 - root - DEBUG - Organ identified: []
2025-11-07 15:28:49 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:28:49 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:28:49 - root - DEBUG - Best score index: 4
2025-11-07 15:28:49 - root - INFO - Extracting structured data from detected table
2025-11-07 15:28:49 - root - INFO - Starting table content extraction
2025-11-07 15:28:49 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:28:49 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:28:49 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:28:49 - root - INFO - Starting table content extraction
2025-11-07 15:28:49 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:28:49 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:28:49 - root - DEBUG - Line 1: '1 D 2.00cm' (conf: 0.998)
2025-11-07 15:28:49 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:28:49 - root - DEBUG - Line 3: 'D 1.61cm' (conf: 0.999)
2025-11-07 15:28:49 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:28:49 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:28:49 - root - INFO - Structuring extracted text data
2025-11-07 15:28:49 - root - INFO - Starting table data structuring
2025-11-07 15:28:49 - root - DEBUG - Element 1: text='1 D 2.00cm', x=153.00, y=43.00, conf=0.998
2025-11-07 15:28:49 - root - DEBUG - Element 2: text='2 ', x=55.00, y=130.00, conf=0.817
2025-11-07 15:28:49 - root - DEBUG - Element 3: text='D 1.61cm', x=180.00, y=126.00, conf=0.999
2025-11-07 15:28:49 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:28:49 - root - DEBUG - Processing element 1/3: '1 D 2.00cm' at (153.00, 43.00)
2025-11-07 15:28:49 - root - DEBUG - Processing element 2/3: 'D 1.61cm' at (180.00, 126.00)
2025-11-07 15:28:49 - root - DEBUG - Processing element 3/3: '2 ' at (55.00, 130.00)
2025-11-07 15:28:49 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:28:49 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:28:49 - root - DEBUG - Processing word 1/1: '1 D 2.00cm'
2025-11-07 15:28:49 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:49 - root - DEBUG - Input text: '1 D 2.00cm'
2025-11-07 15:28:49 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:49 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:28:49 - root - DEBUG - Pattern 1 groups: ('1', 'D', '2.00cm')
2025-11-07 15:28:49 - root - DEBUG - Pattern 1 result: ('1', 'D', '2.00cm')
2025-11-07 15:28:49 - root - INFO - Text split successful using pattern 1: ('1', 'D', '2.00cm')
2025-11-07 15:28:49 - root - DEBUG - Split measurement result: ('1', 'D', '2.00cm')
2025-11-07 15:28:49 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:28:49 - root - DEBUG - Processing word 1/2: '2 '
2025-11-07 15:28:49 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:49 - root - DEBUG - Input text: '2'
2025-11-07 15:28:49 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:49 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:28:49 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:49 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:28:49 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:28:49 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:28:49 - root - DEBUG - Split measurement result: None
2025-11-07 15:28:49 - root - DEBUG - Processing word 2/2: 'D 1.61cm'
2025-11-07 15:28:49 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:28:49 - root - DEBUG - Input text: 'D 1.61cm'
2025-11-07 15:28:49 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:49 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:28:49 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:28:49 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:28:49 - root - DEBUG - Pattern 2 groups: ('D', '1.61cm')
2025-11-07 15:28:49 - root - DEBUG - Pattern 2 result: ('D', '1.61cm')
2025-11-07 15:28:49 - root - INFO - Text split successful using pattern 2: ('D', '1.61cm')
2025-11-07 15:28:49 - root - DEBUG - Split measurement result: ('D', '1.61cm')
2025-11-07 15:28:49 - root - DEBUG - Final structured data:
2025-11-07 15:28:49 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '2.00cm']}'
2025-11-07 15:28:49 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '1.61cm']}'
2025-11-07 15:28:49 - root - INFO - Table content extraction completed successfully
2025-11-07 15:28:49 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:28:49 - root - DEBUG - Organ identified: []
2025-11-07 15:28:49 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000028.dcm
2025-11-07 15:28:49 - root - INFO - Organ identified: []
2025-11-07 15:28:49 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 D 2.00cm', '2 D 1.61cm']}
2025-11-07 15:28:49 - root - INFO - Processing DICOM file 27/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000029.dcm
2025-11-07 15:28:49 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:28:49 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000029.dcm
2025-11-07 15:28:49 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:28:49 - root - INFO - DICOM file loaded successfully
2025-11-07 15:28:49 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:28:49 - root - INFO - Processing RGB format DICOM
2025-11-07 15:28:49 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:28:49 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:28:49 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:28:49 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:28:49 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:28:49 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:28:49 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:28:49 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:28:49 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:49 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:28:49 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:28:49 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:28:49 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:28:49 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:28:49 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:28:49 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:28:49 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:28:49 - root - INFO - Initializing OCRHandler
2025-11-07 15:28:49 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:28:49 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:28:49 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:28:49 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:28:49 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:28:49 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:28:49 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:28:51 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:28:51 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:28:51 - root - INFO - Initializing TableDetector
2025-11-07 15:28:51 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:28:51 - root - DEBUG - Default detection parameters:
2025-11-07 15:28:51 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:28:51 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:28:51 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:28:51 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:28:51 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:28:51 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:28:51 - root - INFO - TableDetector initialization completed
2025-11-07 15:28:51 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:28:51 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:28:51 - root - DEBUG - Text analysis configuration:
2025-11-07 15:28:51 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:28:51 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:28:51 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:28:51 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:28:51 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:28:51 - root - INFO - Initializing ContentExtractor
2025-11-07 15:28:51 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:28:51 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:28:51 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:28:51 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:28:51 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:28:51 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:28:51 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:28:51 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:28:51 - root - DEBUG - Edge detection completed
2025-11-07 15:28:51 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:28:51 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 640360
2025-11-07 15:28:51 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:28:51 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:28:51 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:28:51 - root - DEBUG - Line enhancement completed
2025-11-07 15:28:51 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:28:51 - root - DEBUG - Line thickening completed
2025-11-07 15:28:51 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:28:51 - root - DEBUG - Line combination completed
2025-11-07 15:28:51 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:28:51 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:28:51 - root - INFO - Found 1574 contours
2025-11-07 15:28:51 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:28:51 - root - DEBUG - Contours drawn successfully
2025-11-07 15:28:51 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:28:51 - root - INFO - Rectangular region detection completed
2025-11-07 15:28:51 - root - INFO - Total candidate regions found: 173
2025-11-07 15:28:51 - root - DEBUG - Found 173 candidate regions
2025-11-07 15:28:51 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:28:55 - root - DEBUG - Line 1: '51' (conf: 0.909)
2025-11-07 15:28:55 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:55 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:55 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:55 - root - DEBUG - Combined text: '51'
2025-11-07 15:28:55 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:55 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:55 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:55 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:55 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:55 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:55 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:55 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:55 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:55 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:55 - root - INFO - Final measurement score: 0
2025-11-07 15:28:56 - root - DEBUG - Line 1: 'Gn' (conf: 0.995)
2025-11-07 15:28:56 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:56 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:56 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:56 - root - DEBUG - Combined text: 'gn'
2025-11-07 15:28:56 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:56 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:56 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:56 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:56 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:56 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:56 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:56 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:56 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:56 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:56 - root - INFO - Final measurement score: 0
2025-11-07 15:28:56 - root - DEBUG - Line 1: '98%' (conf: 0.897)
2025-11-07 15:28:56 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:56 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:56 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:56 - root - DEBUG - Combined text: '98%'
2025-11-07 15:28:56 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:56 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:56 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:56 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:56 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:56 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:56 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:56 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:56 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:56 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:56 - root - INFO - Final measurement score: 0
2025-11-07 15:28:57 - root - DEBUG - Line 1: '80' (conf: 0.996)
2025-11-07 15:28:57 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:57 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:57 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:57 - root - DEBUG - Combined text: '80'
2025-11-07 15:28:57 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:57 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:57 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:57 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:57 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:57 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:57 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:57 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:57 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:57 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:57 - root - INFO - Final measurement score: 0
2025-11-07 15:28:58 - root - DEBUG - Line 1: 'P 9' (conf: 0.951)
2025-11-07 15:28:58 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:58 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:58 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:58 - root - DEBUG - Combined text: 'p 9'
2025-11-07 15:28:58 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:58 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:58 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:58 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:58 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:58 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:58 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:58 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:58 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:58 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:58 - root - INFO - Final measurement score: 0
2025-11-07 15:28:58 - root - DEBUG - Line 1: 'Voluso' (conf: 0.995)
2025-11-07 15:28:58 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:58 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:58 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:58 - root - DEBUG - Combined text: 'voluso'
2025-11-07 15:28:58 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:58 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:58 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:58 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:58 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:58 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:58 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:58 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:58 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:58 - root - DEBUG - 'vol' occurrences: 1, bonus added: 2
2025-11-07 15:28:58 - root - INFO - Final measurement score: 2
2025-11-07 15:28:58 - root - DEBUG - Line 1: 'Vol' (conf: 0.988)
2025-11-07 15:28:58 - root - DEBUG - Line 2: 'S' (conf: 0.767)
2025-11-07 15:28:58 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:58 - root - DEBUG - Number of text lines detected: 2
2025-11-07 15:28:58 - root - DEBUG - Text extraction completed - Lines processed: 2
2025-11-07 15:28:58 - root - DEBUG - Combined text: 'vol s'
2025-11-07 15:28:58 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:58 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:58 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:58 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:58 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:58 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:58 - root - DEBUG - Pattern 2 matches: 1
2025-11-07 15:28:58 - root - DEBUG - Pattern 2 found matches: ['vol']
2025-11-07 15:28:58 - root - DEBUG - Base score from pattern matching: 1
2025-11-07 15:28:58 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:58 - root - DEBUG - 'vol' occurrences: 1, bonus added: 2
2025-11-07 15:28:58 - root - INFO - Final measurement score: 3
2025-11-07 15:28:59 - root - DEBUG - Line 1: 'tion' (conf: 0.999)
2025-11-07 15:28:59 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:28:59 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:28:59 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:28:59 - root - DEBUG - Combined text: 'tion'
2025-11-07 15:28:59 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:28:59 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:28:59 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:28:59 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:28:59 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:28:59 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:28:59 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:28:59 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:28:59 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:28:59 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:28:59 - root - INFO - Final measurement score: 0
2025-11-07 15:28:59 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:28:59 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:28:59 - root - DEBUG - Top 10 score indices: [164, 163, 0, 1, 2, 3, 4, 5, 6, 7]
2025-11-07 15:28:59 - root - DEBUG - Rank 1: Index 164, Score 3.000000
2025-11-07 15:28:59 - root - DEBUG - Rank 2: Index 163, Score 2.000000
2025-11-07 15:28:59 - root - DEBUG - Rank 3: Index 0, Score 0.000000
2025-11-07 15:28:59 - root - DEBUG - Rank 4: Index 1, Score 0.000000
2025-11-07 15:28:59 - root - DEBUG - Rank 5: Index 2, Score 0.000000
2025-11-07 15:28:59 - root - DEBUG - Rank 6: Index 3, Score 0.000000
2025-11-07 15:28:59 - root - DEBUG - Rank 7: Index 4, Score 0.000000
2025-11-07 15:28:59 - root - DEBUG - Rank 8: Index 5, Score 0.000000
2025-11-07 15:28:59 - root - DEBUG - Rank 9: Index 6, Score 0.000000
2025-11-07 15:28:59 - root - DEBUG - Rank 10: Index 7, Score 0.000000
2025-11-07 15:28:59 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 3.000000
2025-11-07 15:28:59 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:28:59 - root - DEBUG - Table detection completed. Candidates found: 173
2025-11-07 15:28:59 - root - INFO - Identifying organ name from the image
2025-11-07 15:28:59 - root - INFO - Starting organ name identification
2025-11-07 15:28:59 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:28:59 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:28:59 - root - INFO - Starting organ label identification
2025-11-07 15:28:59 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:28:59 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:29:00 - root - DEBUG - Line 1: '180/29Hz' (conf: 1.000)
2025-11-07 15:29:00 - root - DEBUG - Line 2: 'Voluson' (conf: 0.979)
2025-11-07 15:29:00 - root - DEBUG - Line 3: 'Penetration' (conf: 0.999)
2025-11-07 15:29:00 - root - DEBUG - Line 4: '58' (conf: 0.879)
2025-11-07 15:29:00 - root - DEBUG - Line 5: 'P9.70-3.80' (conf: 0.960)
2025-11-07 15:29:00 - root - DEBUG - Line 6: 'AO 98%' (conf: 0.913)
2025-11-07 15:29:00 - root - DEBUG - Line 7: 'Gn15' (conf: 0.999)
2025-11-07 15:29:00 - root - DEBUG - Line 8: 'C7/M5' (conf: 0.985)
2025-11-07 15:29:00 - root - DEBUG - Line 9: 'P5/E1' (conf: 0.988)
2025-11-07 15:29:00 - root - DEBUG - Line 10: 'SRIII2' (conf: 0.923)
2025-11-07 15:29:00 - root - DEBUG - OCR completed. Processing 10 text lines for organ keywords
2025-11-07 15:29:00 - root - DEBUG - Line 0 text: '180/29Hz'
2025-11-07 15:29:00 - root - DEBUG - Line 1 text: 'Voluson'
2025-11-07 15:29:00 - root - DEBUG - Line 2 text: 'Penetration'
2025-11-07 15:29:00 - root - DEBUG - Line 3 text: '58'
2025-11-07 15:29:00 - root - DEBUG - Line 4 text: 'P9.70-3.80'
2025-11-07 15:29:00 - root - DEBUG - Line 5 text: 'AO 98%'
2025-11-07 15:29:00 - root - DEBUG - Line 6 text: 'Gn15'
2025-11-07 15:29:00 - root - DEBUG - Line 7 text: 'C7/M5'
2025-11-07 15:29:00 - root - DEBUG - Line 8 text: 'P5/E1'
2025-11-07 15:29:00 - root - DEBUG - Line 9 text: 'SRIII2'
2025-11-07 15:29:00 - root - DEBUG - Combined text for keyword search: '180/29hz voluson penetration 58 p9.70-3.80 ao 98% gn15 c7/m5 p5/e1 sriii2'
2025-11-07 15:29:00 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:29:00 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:29:00 - root - INFO - Identified organs: []
2025-11-07 15:29:00 - root - WARNING - No organ name identified from the image
2025-11-07 15:29:00 - root - DEBUG - Organ identified: []
2025-11-07 15:29:00 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:29:00 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000029.dcm
2025-11-07 15:29:00 - root - INFO - Processing DICOM file 28/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000030.dcm
2025-11-07 15:29:00 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:29:00 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000030.dcm
2025-11-07 15:29:00 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:29:00 - root - INFO - DICOM file loaded successfully
2025-11-07 15:29:00 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:29:00 - root - INFO - Processing RGB format DICOM
2025-11-07 15:29:00 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:29:00 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:29:00 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:29:00 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:29:00 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:29:00 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:29:00 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:29:00 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:29:00 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:29:00 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:29:00 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:29:00 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:29:00 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:29:00 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:29:00 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:29:00 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:29:00 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:29:00 - root - INFO - Initializing OCRHandler
2025-11-07 15:29:00 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:29:00 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:29:00 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:29:00 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:29:00 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:29:00 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:29:00 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:29:01 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:29:01 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:29:01 - root - INFO - Initializing TableDetector
2025-11-07 15:29:01 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:29:01 - root - DEBUG - Default detection parameters:
2025-11-07 15:29:01 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:29:01 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:29:01 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:29:01 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:29:01 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:29:01 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:29:01 - root - INFO - TableDetector initialization completed
2025-11-07 15:29:01 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:29:01 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:29:01 - root - DEBUG - Text analysis configuration:
2025-11-07 15:29:01 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:29:01 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:29:01 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:29:01 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:29:01 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:29:01 - root - INFO - Initializing ContentExtractor
2025-11-07 15:29:01 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:29:01 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:29:01 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:29:01 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:29:01 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:29:01 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:29:01 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:29:01 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:29:01 - root - DEBUG - Edge detection completed
2025-11-07 15:29:01 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:29:01 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 334560
2025-11-07 15:29:01 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:29:01 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:29:01 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:29:01 - root - DEBUG - Line enhancement completed
2025-11-07 15:29:01 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:29:01 - root - DEBUG - Line thickening completed
2025-11-07 15:29:01 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:29:01 - root - DEBUG - Line combination completed
2025-11-07 15:29:01 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:29:01 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:29:01 - root - INFO - Found 1126 contours
2025-11-07 15:29:01 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:29:01 - root - DEBUG - Contours drawn successfully
2025-11-07 15:29:01 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:29:01 - root - INFO - Rectangular region detection completed
2025-11-07 15:29:01 - root - INFO - Total candidate regions found: 99
2025-11-07 15:29:01 - root - DEBUG - Found 99 candidate regions
2025-11-07 15:29:01 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:29:02 - root - DEBUG - Line 1: '1 D 2.25cm' (conf: 0.993)
2025-11-07 15:29:02 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:29:02 - root - DEBUG - Line 3: 'D 0.99cm' (conf: 0.966)
2025-11-07 15:29:02 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:02 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:29:02 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:29:02 - root - DEBUG - Combined text: '1 d 2.25cm 2  d 0.99cm'
2025-11-07 15:29:02 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:02 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:02 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:02 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:02 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:02 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:29:02 - root - DEBUG - Pattern 1 found matches: ['2.25cm', '0.99cm']
2025-11-07 15:29:02 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:29:02 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:29:02 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:29:02 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:29:02 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:02 - root - INFO - Final measurement score: 8
2025-11-07 15:29:04 - root - DEBUG - Line 1: 'SRI' (conf: 0.998)
2025-11-07 15:29:04 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:04 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:04 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:04 - root - DEBUG - Combined text: 'sri'
2025-11-07 15:29:04 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:04 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:04 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:04 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:04 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:04 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:04 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:04 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:04 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:04 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:04 - root - INFO - Final measurement score: 0
2025-11-07 15:29:06 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:29:06 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:29:06 - root - DEBUG - Top 10 score indices: [2, 0, 1, 3, 4, 5, 6, 7, 8, 9]
2025-11-07 15:29:06 - root - DEBUG - Rank 1: Index 2, Score 8.000000
2025-11-07 15:29:06 - root - DEBUG - Rank 2: Index 0, Score 0.000000
2025-11-07 15:29:06 - root - DEBUG - Rank 3: Index 1, Score 0.000000
2025-11-07 15:29:06 - root - DEBUG - Rank 4: Index 3, Score 0.000000
2025-11-07 15:29:06 - root - DEBUG - Rank 5: Index 4, Score 0.000000
2025-11-07 15:29:06 - root - DEBUG - Rank 6: Index 5, Score 0.000000
2025-11-07 15:29:06 - root - DEBUG - Rank 7: Index 6, Score 0.000000
2025-11-07 15:29:06 - root - DEBUG - Rank 8: Index 7, Score 0.000000
2025-11-07 15:29:06 - root - DEBUG - Rank 9: Index 8, Score 0.000000
2025-11-07 15:29:06 - root - DEBUG - Rank 10: Index 9, Score 0.000000
2025-11-07 15:29:06 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:29:06 - root - DEBUG - All top 10 scores:
2025-11-07 15:29:06 - root - DEBUG - Score index 2: 8.000000
2025-11-07 15:29:06 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:29:06 - root - DEBUG - Score index 1: 0.000000
2025-11-07 15:29:06 - root - DEBUG - Score index 3: 0.000000
2025-11-07 15:29:06 - root - DEBUG - Score index 4: 0.000000
2025-11-07 15:29:06 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:29:06 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:29:06 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:29:06 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:29:06 - root - DEBUG - Score index 9: 0.000000
2025-11-07 15:29:06 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:29:06 - root - DEBUG - Table detection completed. Candidates found: 99
2025-11-07 15:29:06 - root - INFO - Identifying organ name from the image
2025-11-07 15:29:06 - root - INFO - Starting organ name identification
2025-11-07 15:29:06 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:29:06 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:29:06 - root - INFO - Starting organ label identification
2025-11-07 15:29:06 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:29:06 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:29:07 - root - DEBUG - Line 1: '180/29Hz' (conf: 1.000)
2025-11-07 15:29:07 - root - DEBUG - Line 2: 'Penetration' (conf: 0.999)
2025-11-07 15:29:07 - root - DEBUG - Line 3: '58' (conf: 0.859)
2025-11-07 15:29:07 - root - DEBUG - Line 4: 'P 9.70 - 3.80' (conf: 0.968)
2025-11-07 15:29:07 - root - DEBUG - Line 5: 'AO 98%' (conf: 0.913)
2025-11-07 15:29:07 - root - DEBUG - Line 6: 'Gn 15' (conf: 0.919)
2025-11-07 15:29:07 - root - DEBUG - Line 7: 'C7/M5' (conf: 0.991)
2025-11-07 15:29:07 - root - DEBUG - Line 8: 'P5/E1' (conf: 0.991)
2025-11-07 15:29:07 - root - DEBUG - Line 9: 'SRI II 2' (conf: 0.991)
2025-11-07 15:29:07 - root - DEBUG - Line 10: '+' (conf: 0.817)
2025-11-07 15:29:07 - root - DEBUG - Line 11: '1 D 2.25cm' (conf: 0.999)
2025-11-07 15:29:07 - root - DEBUG - Line 12: '2 D 0.99cm' (conf: 0.999)
2025-11-07 15:29:07 - root - DEBUG - OCR completed. Processing 12 text lines for organ keywords
2025-11-07 15:29:07 - root - DEBUG - Line 0 text: '180/29Hz'
2025-11-07 15:29:07 - root - DEBUG - Line 1 text: 'Penetration'
2025-11-07 15:29:07 - root - DEBUG - Line 2 text: '58'
2025-11-07 15:29:07 - root - DEBUG - Line 3 text: 'P 9.70 - 3.80'
2025-11-07 15:29:07 - root - DEBUG - Line 4 text: 'AO 98%'
2025-11-07 15:29:07 - root - DEBUG - Line 5 text: 'Gn 15'
2025-11-07 15:29:07 - root - DEBUG - Line 6 text: 'C7/M5'
2025-11-07 15:29:07 - root - DEBUG - Line 7 text: 'P5/E1'
2025-11-07 15:29:07 - root - DEBUG - Line 8 text: 'SRI II 2'
2025-11-07 15:29:07 - root - DEBUG - Line 9 text: '+'
2025-11-07 15:29:07 - root - DEBUG - Line 10 text: '1 D 2.25cm'
2025-11-07 15:29:07 - root - DEBUG - Line 11 text: '2 D 0.99cm'
2025-11-07 15:29:07 - root - DEBUG - Combined text for keyword search: '180/29hz penetration 58 p 9.70 - 3.80 ao 98% gn 15 c7/m5 p5/e1 sri ii 2 + 1 d 2.25cm 2 d 0.99cm'
2025-11-07 15:29:07 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:29:07 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:29:07 - root - INFO - Identified organs: []
2025-11-07 15:29:07 - root - WARNING - No organ name identified from the image
2025-11-07 15:29:07 - root - DEBUG - Organ identified: []
2025-11-07 15:29:07 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:29:07 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:29:07 - root - DEBUG - Best score index: 2
2025-11-07 15:29:07 - root - INFO - Extracting structured data from detected table
2025-11-07 15:29:07 - root - INFO - Starting table content extraction
2025-11-07 15:29:07 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:29:07 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:29:07 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:29:07 - root - INFO - Starting table content extraction
2025-11-07 15:29:07 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:29:07 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:29:08 - root - DEBUG - Line 1: '1 D 2.25cm' (conf: 0.993)
2025-11-07 15:29:08 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:29:08 - root - DEBUG - Line 3: 'D 0.99cm' (conf: 0.966)
2025-11-07 15:29:08 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:29:08 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:29:08 - root - INFO - Structuring extracted text data
2025-11-07 15:29:08 - root - INFO - Starting table data structuring
2025-11-07 15:29:08 - root - DEBUG - Element 1: text='1 D 2.25cm', x=153.00, y=43.00, conf=0.993
2025-11-07 15:29:08 - root - DEBUG - Element 2: text='2 ', x=55.00, y=130.00, conf=0.817
2025-11-07 15:29:08 - root - DEBUG - Element 3: text='D 0.99cm', x=180.50, y=126.00, conf=0.966
2025-11-07 15:29:08 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:29:08 - root - DEBUG - Processing element 1/3: '1 D 2.25cm' at (153.00, 43.00)
2025-11-07 15:29:08 - root - DEBUG - Processing element 2/3: 'D 0.99cm' at (180.50, 126.00)
2025-11-07 15:29:08 - root - DEBUG - Processing element 3/3: '2 ' at (55.00, 130.00)
2025-11-07 15:29:08 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:29:08 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:29:08 - root - DEBUG - Processing word 1/1: '1 D 2.25cm'
2025-11-07 15:29:08 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:29:08 - root - DEBUG - Input text: '1 D 2.25cm'
2025-11-07 15:29:08 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:08 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:29:08 - root - DEBUG - Pattern 1 groups: ('1', 'D', '2.25cm')
2025-11-07 15:29:08 - root - DEBUG - Pattern 1 result: ('1', 'D', '2.25cm')
2025-11-07 15:29:08 - root - INFO - Text split successful using pattern 1: ('1', 'D', '2.25cm')
2025-11-07 15:29:08 - root - DEBUG - Split measurement result: ('1', 'D', '2.25cm')
2025-11-07 15:29:08 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:29:08 - root - DEBUG - Processing word 1/2: '2 '
2025-11-07 15:29:08 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:29:08 - root - DEBUG - Input text: '2'
2025-11-07 15:29:08 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:08 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:29:08 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:08 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:29:08 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:29:08 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:29:08 - root - DEBUG - Split measurement result: None
2025-11-07 15:29:08 - root - DEBUG - Processing word 2/2: 'D 0.99cm'
2025-11-07 15:29:08 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:29:08 - root - DEBUG - Input text: 'D 0.99cm'
2025-11-07 15:29:08 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:08 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:29:08 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:08 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:29:08 - root - DEBUG - Pattern 2 groups: ('D', '0.99cm')
2025-11-07 15:29:08 - root - DEBUG - Pattern 2 result: ('D', '0.99cm')
2025-11-07 15:29:08 - root - INFO - Text split successful using pattern 2: ('D', '0.99cm')
2025-11-07 15:29:08 - root - DEBUG - Split measurement result: ('D', '0.99cm')
2025-11-07 15:29:08 - root - DEBUG - Final structured data:
2025-11-07 15:29:08 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '2.25cm']}'
2025-11-07 15:29:08 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '0.99cm']}'
2025-11-07 15:29:08 - root - INFO - Table content extraction completed successfully
2025-11-07 15:29:08 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:29:08 - root - DEBUG - Organ identified: []
2025-11-07 15:29:08 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000030.dcm
2025-11-07 15:29:08 - root - INFO - Organ identified: []
2025-11-07 15:29:08 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 D 2.25cm', '2 D 0.99cm']}
2025-11-07 15:29:08 - root - INFO - Processing DICOM file 29/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000031.dcm
2025-11-07 15:29:08 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:29:08 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000031.dcm
2025-11-07 15:29:08 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:29:08 - root - INFO - DICOM file loaded successfully
2025-11-07 15:29:08 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:29:08 - root - INFO - Processing RGB format DICOM
2025-11-07 15:29:08 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:29:08 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:29:08 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:29:08 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:29:08 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:29:08 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:29:08 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:29:08 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:29:08 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:29:08 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:29:08 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:29:08 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:29:08 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:29:08 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:29:08 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:29:08 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:29:08 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:29:08 - root - INFO - Initializing OCRHandler
2025-11-07 15:29:08 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:29:08 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:29:08 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:29:08 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:29:08 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:29:08 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:29:08 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:29:09 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:29:09 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:29:09 - root - INFO - Initializing TableDetector
2025-11-07 15:29:09 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:29:09 - root - DEBUG - Default detection parameters:
2025-11-07 15:29:09 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:29:09 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:29:09 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:29:09 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:29:09 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:29:09 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:29:09 - root - INFO - TableDetector initialization completed
2025-11-07 15:29:09 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:29:09 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:29:09 - root - DEBUG - Text analysis configuration:
2025-11-07 15:29:09 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:29:09 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:29:09 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:29:09 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:29:09 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:29:09 - root - INFO - Initializing ContentExtractor
2025-11-07 15:29:09 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:29:09 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:29:09 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:29:09 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:29:09 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:29:09 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:29:09 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:29:09 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:29:09 - root - DEBUG - Edge detection completed
2025-11-07 15:29:09 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:29:09 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 722153
2025-11-07 15:29:09 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:29:09 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:29:09 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:29:09 - root - DEBUG - Line enhancement completed
2025-11-07 15:29:09 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:29:09 - root - DEBUG - Line thickening completed
2025-11-07 15:29:09 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:29:09 - root - DEBUG - Line combination completed
2025-11-07 15:29:09 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:29:09 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:29:09 - root - INFO - Found 1858 contours
2025-11-07 15:29:09 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:29:09 - root - DEBUG - Contours drawn successfully
2025-11-07 15:29:09 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:29:09 - root - INFO - Rectangular region detection completed
2025-11-07 15:29:09 - root - INFO - Total candidate regions found: 156
2025-11-07 15:29:09 - root - DEBUG - Found 156 candidate regions
2025-11-07 15:29:09 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:29:13 - root - DEBUG - Line 1: 'SRI' (conf: 0.999)
2025-11-07 15:29:13 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:13 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:13 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:13 - root - DEBUG - Combined text: 'sri'
2025-11-07 15:29:13 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:13 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:13 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:13 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:13 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:13 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:13 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:13 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:13 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:13 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:13 - root - INFO - Final measurement score: 0
2025-11-07 15:29:13 - root - DEBUG - Line 1: 'E1' (conf: 0.976)
2025-11-07 15:29:13 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:13 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:13 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:13 - root - DEBUG - Combined text: 'e1'
2025-11-07 15:29:13 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:13 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:13 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:13 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:13 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:13 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:13 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:13 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:13 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:13 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:13 - root - INFO - Final measurement score: 0
2025-11-07 15:29:14 - root - DEBUG - Line 1: 'M5' (conf: 0.996)
2025-11-07 15:29:14 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:14 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:14 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:14 - root - DEBUG - Combined text: 'm5'
2025-11-07 15:29:14 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:14 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:14 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:14 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:14 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:14 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:14 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:14 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:14 - root - INFO - Final measurement score: 0
2025-11-07 15:29:14 - root - DEBUG - Line 1: 'Gn' (conf: 0.998)
2025-11-07 15:29:14 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:14 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:14 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:14 - root - DEBUG - Combined text: 'gn'
2025-11-07 15:29:14 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:14 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:14 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:14 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:14 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:14 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:14 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:14 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:14 - root - INFO - Final measurement score: 0
2025-11-07 15:29:14 - root - DEBUG - Line 1: '98%' (conf: 0.999)
2025-11-07 15:29:14 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:14 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:14 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:14 - root - DEBUG - Combined text: '98%'
2025-11-07 15:29:14 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:14 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:14 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:14 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:14 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:14 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:14 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:14 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:14 - root - INFO - Final measurement score: 0
2025-11-07 15:29:14 - root - DEBUG - Line 1: '80' (conf: 0.998)
2025-11-07 15:29:14 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:14 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:14 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:14 - root - DEBUG - Combined text: '80'
2025-11-07 15:29:14 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:14 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:14 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:14 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:14 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:14 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:14 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:14 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:14 - root - INFO - Final measurement score: 0
2025-11-07 15:29:14 - root - DEBUG - Line 1: 'Voluso' (conf: 0.995)
2025-11-07 15:29:14 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:14 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:14 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:14 - root - DEBUG - Combined text: 'voluso'
2025-11-07 15:29:14 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:14 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:14 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:14 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:14 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:14 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:14 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:14 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:14 - root - DEBUG - 'vol' occurrences: 1, bonus added: 2
2025-11-07 15:29:14 - root - INFO - Final measurement score: 2
2025-11-07 15:29:15 - root - DEBUG - Line 1: 'Voluson' (conf: 1.000)
2025-11-07 15:29:15 - root - DEBUG - Line 2: 'S8' (conf: 0.790)
2025-11-07 15:29:15 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:15 - root - DEBUG - Number of text lines detected: 2
2025-11-07 15:29:15 - root - DEBUG - Text extraction completed - Lines processed: 2
2025-11-07 15:29:15 - root - DEBUG - Combined text: 'voluson s8'
2025-11-07 15:29:15 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:15 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:15 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:15 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:15 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:15 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:15 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:15 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:15 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:15 - root - DEBUG - 'vol' occurrences: 1, bonus added: 2
2025-11-07 15:29:15 - root - INFO - Final measurement score: 2
2025-11-07 15:29:15 - root - DEBUG - Line 1: 'ration' (conf: 0.999)
2025-11-07 15:29:15 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:15 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:15 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:15 - root - DEBUG - Combined text: 'ration'
2025-11-07 15:29:15 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:15 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:15 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:15 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:15 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:15 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:15 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:15 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:15 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:15 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:15 - root - INFO - Final measurement score: 0
2025-11-07 15:29:15 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:29:15 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:29:15 - root - DEBUG - Top 10 score indices: [147, 148, 0, 1, 2, 3, 4, 5, 6, 7]
2025-11-07 15:29:15 - root - DEBUG - Rank 1: Index 147, Score 2.000000
2025-11-07 15:29:15 - root - DEBUG - Rank 2: Index 148, Score 2.000000
2025-11-07 15:29:15 - root - DEBUG - Rank 3: Index 0, Score 0.000000
2025-11-07 15:29:15 - root - DEBUG - Rank 4: Index 1, Score 0.000000
2025-11-07 15:29:15 - root - DEBUG - Rank 5: Index 2, Score 0.000000
2025-11-07 15:29:15 - root - DEBUG - Rank 6: Index 3, Score 0.000000
2025-11-07 15:29:15 - root - DEBUG - Rank 7: Index 4, Score 0.000000
2025-11-07 15:29:15 - root - DEBUG - Rank 8: Index 5, Score 0.000000
2025-11-07 15:29:15 - root - DEBUG - Rank 9: Index 6, Score 0.000000
2025-11-07 15:29:15 - root - DEBUG - Rank 10: Index 7, Score 0.000000
2025-11-07 15:29:15 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 2.000000
2025-11-07 15:29:15 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:29:15 - root - DEBUG - Table detection completed. Candidates found: 156
2025-11-07 15:29:15 - root - INFO - Identifying organ name from the image
2025-11-07 15:29:15 - root - INFO - Starting organ name identification
2025-11-07 15:29:15 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:29:15 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:29:15 - root - INFO - Starting organ label identification
2025-11-07 15:29:15 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:29:15 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:29:16 - root - DEBUG - Line 1: '180/29Hz' (conf: 1.000)
2025-11-07 15:29:16 - root - DEBUG - Line 2: 'Penetration' (conf: 0.999)
2025-11-07 15:29:16 - root - DEBUG - Line 3: 'S8' (conf: 0.677)
2025-11-07 15:29:16 - root - DEBUG - Line 4: 'P9.70-3.80' (conf: 0.968)
2025-11-07 15:29:16 - root - DEBUG - Line 5: 'AO98%' (conf: 0.995)
2025-11-07 15:29:16 - root - DEBUG - Line 6: 'Gn 15' (conf: 0.908)
2025-11-07 15:29:16 - root - DEBUG - Line 7: 'C7/M5' (conf: 0.986)
2025-11-07 15:29:16 - root - DEBUG - Line 8: 'P5/E1' (conf: 0.992)
2025-11-07 15:29:16 - root - DEBUG - Line 9: 'SRI II 2' (conf: 0.983)
2025-11-07 15:29:16 - root - DEBUG - OCR completed. Processing 9 text lines for organ keywords
2025-11-07 15:29:16 - root - DEBUG - Line 0 text: '180/29Hz'
2025-11-07 15:29:16 - root - DEBUG - Line 1 text: 'Penetration'
2025-11-07 15:29:16 - root - DEBUG - Line 2 text: 'S8'
2025-11-07 15:29:16 - root - DEBUG - Line 3 text: 'P9.70-3.80'
2025-11-07 15:29:16 - root - DEBUG - Line 4 text: 'AO98%'
2025-11-07 15:29:16 - root - DEBUG - Line 5 text: 'Gn 15'
2025-11-07 15:29:16 - root - DEBUG - Line 6 text: 'C7/M5'
2025-11-07 15:29:16 - root - DEBUG - Line 7 text: 'P5/E1'
2025-11-07 15:29:16 - root - DEBUG - Line 8 text: 'SRI II 2'
2025-11-07 15:29:16 - root - DEBUG - Combined text for keyword search: '180/29hz penetration s8 p9.70-3.80 ao98% gn 15 c7/m5 p5/e1 sri ii 2'
2025-11-07 15:29:16 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:29:16 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:29:16 - root - INFO - Identified organs: []
2025-11-07 15:29:16 - root - WARNING - No organ name identified from the image
2025-11-07 15:29:16 - root - DEBUG - Organ identified: []
2025-11-07 15:29:16 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:29:17 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000031.dcm
2025-11-07 15:29:17 - root - INFO - Processing DICOM file 30/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000032.dcm
2025-11-07 15:29:17 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:29:17 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000032.dcm
2025-11-07 15:29:17 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:29:17 - root - INFO - DICOM file loaded successfully
2025-11-07 15:29:17 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:29:17 - root - INFO - Processing RGB format DICOM
2025-11-07 15:29:17 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:29:17 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:29:17 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:29:17 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:29:17 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:29:17 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:29:17 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:29:17 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:29:17 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:29:17 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:29:17 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:29:17 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:29:17 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:29:17 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:29:17 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:29:17 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:29:17 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:29:17 - root - INFO - Initializing OCRHandler
2025-11-07 15:29:17 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:29:17 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:29:17 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:29:17 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:29:17 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:29:17 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:29:17 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:29:18 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:29:18 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:29:18 - root - INFO - Initializing TableDetector
2025-11-07 15:29:18 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:29:18 - root - DEBUG - Default detection parameters:
2025-11-07 15:29:18 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:29:18 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:29:18 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:29:18 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:29:18 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:29:18 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:29:18 - root - INFO - TableDetector initialization completed
2025-11-07 15:29:18 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:29:18 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:29:18 - root - DEBUG - Text analysis configuration:
2025-11-07 15:29:18 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:29:18 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:29:18 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:29:18 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:29:18 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:29:18 - root - INFO - Initializing ContentExtractor
2025-11-07 15:29:18 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:29:18 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:29:18 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:29:18 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:29:18 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:29:18 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:29:18 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:29:18 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:29:18 - root - DEBUG - Edge detection completed
2025-11-07 15:29:18 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:29:18 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 696540
2025-11-07 15:29:18 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:29:18 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:29:18 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:29:18 - root - DEBUG - Line enhancement completed
2025-11-07 15:29:18 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:29:18 - root - DEBUG - Line thickening completed
2025-11-07 15:29:18 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:29:18 - root - DEBUG - Line combination completed
2025-11-07 15:29:18 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:29:18 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:29:18 - root - INFO - Found 1827 contours
2025-11-07 15:29:18 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:29:18 - root - DEBUG - Contours drawn successfully
2025-11-07 15:29:18 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:29:18 - root - INFO - Rectangular region detection completed
2025-11-07 15:29:18 - root - INFO - Total candidate regions found: 124
2025-11-07 15:29:18 - root - DEBUG - Found 124 candidate regions
2025-11-07 15:29:18 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:29:22 - root - DEBUG - Line 1: 'SRI' (conf: 0.996)
2025-11-07 15:29:22 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:22 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:22 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:22 - root - DEBUG - Combined text: 'sri'
2025-11-07 15:29:22 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:22 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:22 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:22 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:22 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:22 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:22 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:22 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:22 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:22 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:22 - root - INFO - Final measurement score: 0
2025-11-07 15:29:22 - root - DEBUG - Line 1: 'E1' (conf: 0.999)
2025-11-07 15:29:22 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:22 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:22 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:22 - root - DEBUG - Combined text: 'e1'
2025-11-07 15:29:22 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:22 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:22 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:22 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:22 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:22 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:22 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:22 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:22 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:22 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:22 - root - INFO - Final measurement score: 0
2025-11-07 15:29:23 - root - DEBUG - Line 1: 'M5' (conf: 0.997)
2025-11-07 15:29:23 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:23 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:23 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:23 - root - DEBUG - Combined text: 'm5'
2025-11-07 15:29:23 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:23 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:23 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:23 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:23 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:23 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:23 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:23 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:23 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:23 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:23 - root - INFO - Final measurement score: 0
2025-11-07 15:29:23 - root - DEBUG - Line 1: 'Gn' (conf: 0.998)
2025-11-07 15:29:23 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:23 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:23 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:23 - root - DEBUG - Combined text: 'gn'
2025-11-07 15:29:23 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:23 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:23 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:23 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:23 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:23 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:23 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:23 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:23 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:23 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:23 - root - INFO - Final measurement score: 0
2025-11-07 15:29:23 - root - DEBUG - Line 1: '98%' (conf: 0.982)
2025-11-07 15:29:23 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:23 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:23 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:23 - root - DEBUG - Combined text: '98%'
2025-11-07 15:29:23 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:23 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:23 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:23 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:23 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:23 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:23 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:23 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:23 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:23 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:23 - root - INFO - Final measurement score: 0
2025-11-07 15:29:24 - root - DEBUG - Line 1: '3.80' (conf: 0.980)
2025-11-07 15:29:24 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:24 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:24 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:24 - root - DEBUG - Combined text: '3.80'
2025-11-07 15:29:24 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:24 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:24 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:24 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:24 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:24 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:24 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:24 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:24 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:24 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:24 - root - INFO - Final measurement score: 0
2025-11-07 15:29:24 - root - DEBUG - Line 1: 'Voluso' (conf: 0.995)
2025-11-07 15:29:24 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:24 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:24 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:24 - root - DEBUG - Combined text: 'voluso'
2025-11-07 15:29:24 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:24 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:24 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:24 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:24 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:24 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:24 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:24 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:24 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:24 - root - DEBUG - 'vol' occurrences: 1, bonus added: 2
2025-11-07 15:29:24 - root - INFO - Final measurement score: 2
2025-11-07 15:29:24 - root - DEBUG - Line 1: 'Volu' (conf: 0.841)
2025-11-07 15:29:24 - root - DEBUG - Line 2: 'S' (conf: 0.542)
2025-11-07 15:29:24 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:24 - root - DEBUG - Number of text lines detected: 2
2025-11-07 15:29:24 - root - DEBUG - Text extraction completed - Lines processed: 2
2025-11-07 15:29:24 - root - DEBUG - Combined text: 'volu s'
2025-11-07 15:29:24 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:24 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:24 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:24 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:24 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:24 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:24 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:24 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:24 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:24 - root - DEBUG - 'vol' occurrences: 1, bonus added: 2
2025-11-07 15:29:24 - root - INFO - Final measurement score: 2
2025-11-07 15:29:25 - root - DEBUG - Line 1: 'ration' (conf: 0.999)
2025-11-07 15:29:25 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:25 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:25 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:25 - root - DEBUG - Combined text: 'ration'
2025-11-07 15:29:25 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:25 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:25 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:25 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:25 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:25 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:25 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:25 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:25 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:25 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:25 - root - INFO - Final measurement score: 0
2025-11-07 15:29:25 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:29:25 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:29:25 - root - DEBUG - Top 10 score indices: [115, 116, 0, 1, 2, 3, 4, 5, 6, 7]
2025-11-07 15:29:25 - root - DEBUG - Rank 1: Index 115, Score 2.000000
2025-11-07 15:29:25 - root - DEBUG - Rank 2: Index 116, Score 2.000000
2025-11-07 15:29:25 - root - DEBUG - Rank 3: Index 0, Score 0.000000
2025-11-07 15:29:25 - root - DEBUG - Rank 4: Index 1, Score 0.000000
2025-11-07 15:29:25 - root - DEBUG - Rank 5: Index 2, Score 0.000000
2025-11-07 15:29:25 - root - DEBUG - Rank 6: Index 3, Score 0.000000
2025-11-07 15:29:25 - root - DEBUG - Rank 7: Index 4, Score 0.000000
2025-11-07 15:29:25 - root - DEBUG - Rank 8: Index 5, Score 0.000000
2025-11-07 15:29:25 - root - DEBUG - Rank 9: Index 6, Score 0.000000
2025-11-07 15:29:25 - root - DEBUG - Rank 10: Index 7, Score 0.000000
2025-11-07 15:29:25 - root - WARNING - No candidates meet the minimum threshold of 4. Best score: 2.000000
2025-11-07 15:29:25 - root - INFO - Measurement table detection completed - no valid tables found
2025-11-07 15:29:25 - root - DEBUG - Table detection completed. Candidates found: 124
2025-11-07 15:29:25 - root - INFO - Identifying organ name from the image
2025-11-07 15:29:25 - root - INFO - Starting organ name identification
2025-11-07 15:29:25 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:29:25 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:29:25 - root - INFO - Starting organ label identification
2025-11-07 15:29:25 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:29:25 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:29:26 - root - DEBUG - Line 1: '180/29Hz' (conf: 1.000)
2025-11-07 15:29:26 - root - DEBUG - Line 2: 'Penetration' (conf: 0.999)
2025-11-07 15:29:26 - root - DEBUG - Line 3: '58' (conf: 0.838)
2025-11-07 15:29:26 - root - DEBUG - Line 4: 'P9.70-3.80' (conf: 0.966)
2025-11-07 15:29:26 - root - DEBUG - Line 5: 'AO98%' (conf: 0.994)
2025-11-07 15:29:26 - root - DEBUG - Line 6: 'Gn15' (conf: 0.994)
2025-11-07 15:29:26 - root - DEBUG - Line 7: 'C7/M5' (conf: 0.992)
2025-11-07 15:29:26 - root - DEBUG - Line 8: 'P5/E1' (conf: 0.988)
2025-11-07 15:29:26 - root - DEBUG - Line 9: 'SRI II 2' (conf: 0.987)
2025-11-07 15:29:26 - root - DEBUG - OCR completed. Processing 9 text lines for organ keywords
2025-11-07 15:29:26 - root - DEBUG - Line 0 text: '180/29Hz'
2025-11-07 15:29:26 - root - DEBUG - Line 1 text: 'Penetration'
2025-11-07 15:29:26 - root - DEBUG - Line 2 text: '58'
2025-11-07 15:29:26 - root - DEBUG - Line 3 text: 'P9.70-3.80'
2025-11-07 15:29:26 - root - DEBUG - Line 4 text: 'AO98%'
2025-11-07 15:29:26 - root - DEBUG - Line 5 text: 'Gn15'
2025-11-07 15:29:26 - root - DEBUG - Line 6 text: 'C7/M5'
2025-11-07 15:29:26 - root - DEBUG - Line 7 text: 'P5/E1'
2025-11-07 15:29:26 - root - DEBUG - Line 8 text: 'SRI II 2'
2025-11-07 15:29:26 - root - DEBUG - Combined text for keyword search: '180/29hz penetration 58 p9.70-3.80 ao98% gn15 c7/m5 p5/e1 sri ii 2'
2025-11-07 15:29:26 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:29:26 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:29:26 - root - INFO - Identified organs: []
2025-11-07 15:29:26 - root - WARNING - No organ name identified from the image
2025-11-07 15:29:26 - root - DEBUG - Organ identified: []
2025-11-07 15:29:26 - root - WARNING - No measurement tables detected in the ultrasound image
2025-11-07 15:29:26 - root - WARNING - No structured data extracted from file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000032.dcm
2025-11-07 15:29:26 - root - INFO - Processing DICOM file 31/31: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000033.dcm
2025-11-07 15:29:26 - root - DEBUG - Converting DICOM to PNG format
2025-11-07 15:29:26 - root - INFO - Starting DICOM to PNG conversion: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000033.dcm
2025-11-07 15:29:26 - root - DEBUG - Reading DICOM file with pydicom
2025-11-07 15:29:26 - root - INFO - DICOM file loaded successfully
2025-11-07 15:29:26 - root - DEBUG - Original photometric interpretation: RGB
2025-11-07 15:29:26 - root - INFO - Processing RGB format DICOM
2025-11-07 15:29:26 - root - DEBUG - Converting RGB to BGR for OpenCV compatibility
2025-11-07 15:29:26 - root - DEBUG - RGB to BGR conversion completed. New shape: (852, 1136, 3)
2025-11-07 15:29:26 - root - INFO - DICOM to PNG conversion completed successfully
2025-11-07 15:29:26 - root - DEBUG - DICOM conversion successful. Pixel array shape: (852, 1136, 3)
2025-11-07 15:29:26 - root - DEBUG - Cropping ultrasound image area
2025-11-07 15:29:26 - root - DEBUG - Initializing USRegionLocation detector
2025-11-07 15:29:26 - root - INFO - Getting ultrasound region coordinates
2025-11-07 15:29:26 - root - DEBUG - Raw coordinates - minx0: [0], miny0: [66], maxx1: [1136], maxy1: [852]
2025-11-07 15:29:26 - root - DEBUG - Study type identified: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:29:26 - root - INFO - Single region detected, using direct coordinates
2025-11-07 15:29:26 - root - DEBUG - Single region bounds - minX: 0, minY: 66, maxX: 1136, maxY: 852
2025-11-07 15:29:26 - root - DEBUG - Cropping region: [66:852, 0:1136]
2025-11-07 15:29:26 - root - INFO - Ultrasound image area extraction completed successfully
2025-11-07 15:29:26 - root - DEBUG - Image cropping completed. Study type: (0008, 1030) Study Description                   LO: 'ABDOMEN/US'
2025-11-07 15:29:26 - root - INFO - Analyzing cropped image for measurement tables
2025-11-07 15:29:26 - root - INFO - Starting table detection in ultrasound image
2025-11-07 15:29:26 - root - INFO - Initializing UltrasoundTableDetector
2025-11-07 15:29:26 - root - INFO - Initializing OCRHandler
2025-11-07 15:29:26 - root - DEBUG - Setting up PaddleOCR with optimized parameters
2025-11-07 15:29:26 - root - DEBUG - Configuring PaddleOCR parameters:
2025-11-07 15:29:26 - root - DEBUG - - use_angle_cls: True (enables angle classification)
2025-11-07 15:29:26 - root - DEBUG - - lang: 'en' (English language)
2025-11-07 15:29:26 - root - DEBUG - - det_db_thresh: 0.3 (lower threshold for text detection)
2025-11-07 15:29:26 - root - DEBUG - - det_db_box_thresh: 0.5 (lower box threshold)
2025-11-07 15:29:26 - root - DEBUG - - det_db_unclip_ratio: 2.0 (text region expansion ratio)
2025-11-07 15:29:27 - root - INFO - OCRHandler initialized successfully
2025-11-07 15:29:27 - root - DEBUG - PaddleOCR instance created with optimized parameters
2025-11-07 15:29:27 - root - INFO - Initializing TableDetector
2025-11-07 15:29:27 - root - DEBUG - TableDetector instance created successfully
2025-11-07 15:29:27 - root - DEBUG - Default detection parameters:
2025-11-07 15:29:27 - root - DEBUG - - Image upscale factor: 3x
2025-11-07 15:29:27 - root - DEBUG - - Edge threshold: 50
2025-11-07 15:29:27 - root - DEBUG - - Horizontal kernel size: (30, 1)
2025-11-07 15:29:27 - root - DEBUG - - Vertical kernel size: (1, 10)
2025-11-07 15:29:27 - root - DEBUG - - Minimum area threshold: 2 pixels
2025-11-07 15:29:27 - root - DEBUG - - Minimum X position: 100 pixels
2025-11-07 15:29:27 - root - INFO - TableDetector initialization completed
2025-11-07 15:29:27 - root - INFO - Initializing TextAnalyzer
2025-11-07 15:29:27 - root - DEBUG - TextAnalyzer instance created successfully
2025-11-07 15:29:27 - root - DEBUG - Text analysis configuration:
2025-11-07 15:29:27 - root - DEBUG - - Same line threshold: 15 pixels
2025-11-07 15:29:27 - root - DEBUG - - Measurement pattern types: 2 (unit patterns, key patterns)
2025-11-07 15:29:27 - root - DEBUG - - Bonus scoring: cm (2x), vol (2x)
2025-11-07 15:29:27 - root - DEBUG - - Split measurement patterns: 2 (detailed, simple)
2025-11-07 15:29:27 - root - INFO - TextAnalyzer initialization completed
2025-11-07 15:29:27 - root - INFO - Initializing ContentExtractor
2025-11-07 15:29:27 - root - INFO - ContentExtractor initialized successfully
2025-11-07 15:29:27 - root - INFO - UltrasoundTableDetector initialization completed successfully
2025-11-07 15:29:27 - root - INFO - Detecting measurement tables in the image
2025-11-07 15:29:27 - root - DEBUG - Upscaling to: 3408x2358 (factor: 3x)
2025-11-07 15:29:27 - root - DEBUG - Cropping rightmost 4 pixels to remove artifacts
2025-11-07 15:29:27 - root - DEBUG - Converting upscaled image to grayscale
2025-11-07 15:29:27 - root - DEBUG - Grayscale conversion completed
2025-11-07 15:29:27 - root - INFO - Applying edge detection to grayscale image
2025-11-07 15:29:27 - root - DEBUG - Edge detection completed
2025-11-07 15:29:27 - root - DEBUG - Applying threshold to create binary image
2025-11-07 15:29:27 - root - DEBUG - Threshold applied - Value: 50, Non-zero pixels: 460531
2025-11-07 15:29:27 - root - DEBUG - Creating morphological kernels for line enhancement
2025-11-07 15:29:27 - root - DEBUG - Kernels created - Horizontal: (30,1), Vertical: (1,10)
2025-11-07 15:29:27 - root - INFO - Enhancing horizontal and vertical lines
2025-11-07 15:29:27 - root - DEBUG - Line enhancement completed
2025-11-07 15:29:27 - root - DEBUG - Applying dilation to make lines thicker
2025-11-07 15:29:28 - root - DEBUG - Line thickening completed
2025-11-07 15:29:28 - root - DEBUG - Combining horizontal and vertical lines
2025-11-07 15:29:28 - root - DEBUG - Line combination completed
2025-11-07 15:29:28 - root - DEBUG - Created copy for contour visualization
2025-11-07 15:29:28 - root - INFO - Finding contours in enhanced lines
2025-11-07 15:29:28 - root - INFO - Found 1411 contours
2025-11-07 15:29:28 - root - DEBUG - Drawing contours for visualization
2025-11-07 15:29:28 - root - DEBUG - Contours drawn successfully
2025-11-07 15:29:28 - root - INFO - Processing contours to find rectangular regions
2025-11-07 15:29:28 - root - INFO - Rectangular region detection completed
2025-11-07 15:29:28 - root - INFO - Total candidate regions found: 125
2025-11-07 15:29:28 - root - DEBUG - Found 125 candidate regions
2025-11-07 15:29:28 - root - INFO - Processing candidate regions for measurement content
2025-11-07 15:29:28 - root - DEBUG - Line 1: '9cm' (conf: 0.749)
2025-11-07 15:29:28 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:28 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:28 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:28 - root - DEBUG - Combined text: '9cm'
2025-11-07 15:29:28 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:28 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:28 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:28 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:28 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:28 - root - DEBUG - Pattern 1 matches: 1
2025-11-07 15:29:28 - root - DEBUG - Pattern 1 found matches: ['9cm']
2025-11-07 15:29:28 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:28 - root - DEBUG - Base score from pattern matching: 1
2025-11-07 15:29:28 - root - DEBUG - 'cm' occurrences: 1, bonus added: 2
2025-11-07 15:29:28 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:28 - root - INFO - Final measurement score: 3
2025-11-07 15:29:28 - root - DEBUG - Line 1: 'cm' (conf: 0.998)
2025-11-07 15:29:28 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:28 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:28 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:28 - root - DEBUG - Combined text: 'cm'
2025-11-07 15:29:28 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:28 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:28 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:28 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:28 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:28 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:28 - root - DEBUG - Pattern 2 matches: 1
2025-11-07 15:29:28 - root - DEBUG - Pattern 2 found matches: ['cm']
2025-11-07 15:29:28 - root - DEBUG - Base score from pattern matching: 1
2025-11-07 15:29:28 - root - DEBUG - 'cm' occurrences: 1, bonus added: 2
2025-11-07 15:29:28 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:28 - root - INFO - Final measurement score: 3
2025-11-07 15:29:28 - root - DEBUG - Line 1: '1 D 2.22cm' (conf: 0.997)
2025-11-07 15:29:28 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:29:28 - root - DEBUG - Line 3: 'D 1.69cm' (conf: 1.000)
2025-11-07 15:29:28 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:28 - root - DEBUG - Number of text lines detected: 3
2025-11-07 15:29:28 - root - DEBUG - Text extraction completed - Lines processed: 3
2025-11-07 15:29:28 - root - DEBUG - Combined text: '1 d 2.22cm 2  d 1.69cm'
2025-11-07 15:29:28 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:28 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:28 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:28 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:28 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:28 - root - DEBUG - Pattern 1 matches: 2
2025-11-07 15:29:28 - root - DEBUG - Pattern 1 found matches: ['2.22cm', '1.69cm']
2025-11-07 15:29:28 - root - DEBUG - Pattern 2 matches: 2
2025-11-07 15:29:28 - root - DEBUG - Pattern 2 found matches: ['d', 'd']
2025-11-07 15:29:28 - root - DEBUG - Base score from pattern matching: 4
2025-11-07 15:29:28 - root - DEBUG - 'cm' occurrences: 2, bonus added: 4
2025-11-07 15:29:28 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:28 - root - INFO - Final measurement score: 8
2025-11-07 15:29:32 - root - DEBUG - Line 1: 'Gn' (conf: 0.952)
2025-11-07 15:29:32 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:32 - root - DEBUG - Number of text lines detected: 1
2025-11-07 15:29:32 - root - DEBUG - Text extraction completed - Lines processed: 1
2025-11-07 15:29:32 - root - DEBUG - Combined text: 'gn'
2025-11-07 15:29:32 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:32 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:32 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:32 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:32 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:32 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:32 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:32 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:32 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:32 - root - DEBUG - 'vol' occurrences: 0, bonus added: 0
2025-11-07 15:29:32 - root - INFO - Final measurement score: 0
2025-11-07 15:29:33 - root - DEBUG - Line 1: 'Volus' (conf: 0.996)
2025-11-07 15:29:33 - root - DEBUG - Line 2: 'S8' (conf: 0.748)
2025-11-07 15:29:33 - root - INFO - OCR results found, processing text for measurement scoring
2025-11-07 15:29:33 - root - DEBUG - Number of text lines detected: 2
2025-11-07 15:29:33 - root - DEBUG - Text extraction completed - Lines processed: 2
2025-11-07 15:29:33 - root - DEBUG - Combined text: 'volus s8'
2025-11-07 15:29:33 - root - DEBUG - Defining measurement patterns for scoring
2025-11-07 15:29:33 - root - DEBUG - Measurement patterns defined:
2025-11-07 15:29:33 - root - DEBUG - Pattern 1: \d*\.?\d+\s*(?:mm|cm(?:\^?3)?|ml)
2025-11-07 15:29:33 - root - DEBUG - Pattern 2: \b(?:cm|vol|d1|d2|d|l|l1|l2)\b
2025-11-07 15:29:33 - root - INFO - Analyzing text for measurement patterns
2025-11-07 15:29:33 - root - DEBUG - Pattern 1 matches: 0
2025-11-07 15:29:33 - root - DEBUG - Pattern 2 matches: 0
2025-11-07 15:29:33 - root - DEBUG - Base score from pattern matching: 0
2025-11-07 15:29:33 - root - DEBUG - 'cm' occurrences: 0, bonus added: 0
2025-11-07 15:29:33 - root - DEBUG - 'vol' occurrences: 1, bonus added: 2
2025-11-07 15:29:33 - root - INFO - Final measurement score: 2
2025-11-07 15:29:33 - root - DEBUG - Storing measurement scores and ROI data in candidate structure
2025-11-07 15:29:33 - root - INFO - Identifying top 10 candidates based on measurement scores
2025-11-07 15:29:33 - root - DEBUG - Top 10 score indices: [4, 1, 3, 120, 0, 2, 5, 6, 7, 8]
2025-11-07 15:29:33 - root - DEBUG - Rank 1: Index 4, Score 8.000000
2025-11-07 15:29:33 - root - DEBUG - Rank 2: Index 1, Score 3.000000
2025-11-07 15:29:33 - root - DEBUG - Rank 3: Index 3, Score 3.000000
2025-11-07 15:29:33 - root - DEBUG - Rank 4: Index 120, Score 2.000000
2025-11-07 15:29:33 - root - DEBUG - Rank 5: Index 0, Score 0.000000
2025-11-07 15:29:33 - root - DEBUG - Rank 6: Index 2, Score 0.000000
2025-11-07 15:29:33 - root - DEBUG - Rank 7: Index 5, Score 0.000000
2025-11-07 15:29:33 - root - DEBUG - Rank 8: Index 6, Score 0.000000
2025-11-07 15:29:33 - root - DEBUG - Rank 9: Index 7, Score 0.000000
2025-11-07 15:29:33 - root - DEBUG - Rank 10: Index 8, Score 0.000000
2025-11-07 15:29:33 - root - INFO - Best candidate meets threshold (>= 4). Score: 8.000000
2025-11-07 15:29:33 - root - DEBUG - All top 10 scores:
2025-11-07 15:29:33 - root - DEBUG - Score index 4: 8.000000
2025-11-07 15:29:33 - root - DEBUG - Score index 1: 3.000000
2025-11-07 15:29:33 - root - DEBUG - Score index 3: 3.000000
2025-11-07 15:29:33 - root - DEBUG - Score index 120: 2.000000
2025-11-07 15:29:33 - root - DEBUG - Score index 0: 0.000000
2025-11-07 15:29:33 - root - DEBUG - Score index 2: 0.000000
2025-11-07 15:29:33 - root - DEBUG - Score index 5: 0.000000
2025-11-07 15:29:33 - root - DEBUG - Score index 6: 0.000000
2025-11-07 15:29:33 - root - DEBUG - Score index 7: 0.000000
2025-11-07 15:29:33 - root - DEBUG - Score index 8: 0.000000
2025-11-07 15:29:33 - root - INFO - Measurement table detection completed successfully
2025-11-07 15:29:33 - root - DEBUG - Table detection completed. Candidates found: 125
2025-11-07 15:29:33 - root - INFO - Identifying organ name from the image
2025-11-07 15:29:33 - root - INFO - Starting organ name identification
2025-11-07 15:29:33 - root - DEBUG - Image shape: (786, 1136, 3)
2025-11-07 15:29:33 - root - DEBUG - Delegating to content extractor for organ identification
2025-11-07 15:29:33 - root - INFO - Starting organ label identification
2025-11-07 15:29:33 - root - DEBUG - Input image shape: (786, 1136, 3)
2025-11-07 15:29:33 - root - DEBUG - Performing OCR on full image for organ identification
2025-11-07 15:29:34 - root - DEBUG - Line 1: '180/33Hz' (conf: 1.000)
2025-11-07 15:29:34 - root - DEBUG - Line 2: 'Penetration' (conf: 0.999)
2025-11-07 15:29:34 - root - DEBUG - Line 3: 'S8' (conf: 0.673)
2025-11-07 15:29:34 - root - DEBUG - Line 4: 'P 9.70- 3.80' (conf: 0.912)
2025-11-07 15:29:34 - root - DEBUG - Line 5: 'AO 98%' (conf: 0.936)
2025-11-07 15:29:34 - root - DEBUG - Line 6: 'Gn 15' (conf: 0.913)
2025-11-07 15:29:34 - root - DEBUG - Line 7: 'C7/M5' (conf: 0.993)
2025-11-07 15:29:34 - root - DEBUG - Line 8: 'P5/E1' (conf: 0.982)
2025-11-07 15:29:34 - root - DEBUG - Line 9: 'SRI II 2' (conf: 0.924)
2025-11-07 15:29:34 - root - DEBUG - Line 10: '1 D 2.22cm' (conf: 0.961)
2025-11-07 15:29:34 - root - DEBUG - Line 11: '2 D 1.69cm' (conf: 0.999)
2025-11-07 15:29:34 - root - DEBUG - OCR completed. Processing 11 text lines for organ keywords
2025-11-07 15:29:34 - root - DEBUG - Line 0 text: '180/33Hz'
2025-11-07 15:29:34 - root - DEBUG - Line 1 text: 'Penetration'
2025-11-07 15:29:34 - root - DEBUG - Line 2 text: 'S8'
2025-11-07 15:29:34 - root - DEBUG - Line 3 text: 'P 9.70- 3.80'
2025-11-07 15:29:34 - root - DEBUG - Line 4 text: 'AO 98%'
2025-11-07 15:29:34 - root - DEBUG - Line 5 text: 'Gn 15'
2025-11-07 15:29:34 - root - DEBUG - Line 6 text: 'C7/M5'
2025-11-07 15:29:34 - root - DEBUG - Line 7 text: 'P5/E1'
2025-11-07 15:29:34 - root - DEBUG - Line 8 text: 'SRI II 2'
2025-11-07 15:29:34 - root - DEBUG - Line 9 text: '1 D 2.22cm'
2025-11-07 15:29:34 - root - DEBUG - Line 10 text: '2 D 1.69cm'
2025-11-07 15:29:34 - root - DEBUG - Combined text for keyword search: '180/33hz penetration s8 p 9.70- 3.80 ao 98% gn 15 c7/m5 p5/e1 sri ii 2 1 d 2.22cm 2 d 1.69cm'
2025-11-07 15:29:34 - root - DEBUG - Searching for organ keywords: ['transplant kidney', 'right kidney', 'left kidney', 'subscap ten', 'rk kidney', 'lk kidney', 'rt breast', 'lt breast', 'rt ovary', 'lt ovary', 'nephron', 'bladder', 'kidney', 'ureter', 'uterus', 'breast', 'renal', 'rt ax', 'lt ax', 'ss']
2025-11-07 15:29:34 - root - INFO - Organ identification completed. Found 0 organ keywords
2025-11-07 15:29:34 - root - INFO - Identified organs: []
2025-11-07 15:29:34 - root - WARNING - No organ name identified from the image
2025-11-07 15:29:34 - root - DEBUG - Organ identified: []
2025-11-07 15:29:34 - root - INFO - Table(s) detected successfully. Processing best candidate...
2025-11-07 15:29:34 - root - DEBUG - Number of scored candidates: 10
2025-11-07 15:29:34 - root - DEBUG - Best score index: 4
2025-11-07 15:29:34 - root - INFO - Extracting structured data from detected table
2025-11-07 15:29:34 - root - INFO - Starting table content extraction
2025-11-07 15:29:34 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:29:34 - root - DEBUG - Image shape: (2358, 3404, 3)
2025-11-07 15:29:34 - root - DEBUG - Delegating to content extractor for table processing
2025-11-07 15:29:34 - root - INFO - Starting table content extraction
2025-11-07 15:29:34 - root - DEBUG - Bounding box coordinates: (3110, 2141, 294, 163)
2025-11-07 15:29:34 - root - INFO - Performing OCR on extracted table region
2025-11-07 15:29:35 - root - DEBUG - Line 1: '1 D 2.22cm' (conf: 0.997)
2025-11-07 15:29:35 - root - DEBUG - Line 2: '2 ' (conf: 0.817)
2025-11-07 15:29:35 - root - DEBUG - Line 3: 'D 1.69cm' (conf: 1.000)
2025-11-07 15:29:35 - root - INFO - OCR completed successfully. Processing text elements...
2025-11-07 15:29:35 - root - INFO - Extracted 3 text elements from table region
2025-11-07 15:29:35 - root - INFO - Structuring extracted text data
2025-11-07 15:29:35 - root - INFO - Starting table data structuring
2025-11-07 15:29:35 - root - DEBUG - Element 1: text='1 D 2.22cm', x=153.00, y=43.00, conf=0.997
2025-11-07 15:29:35 - root - DEBUG - Element 2: text='2 ', x=55.00, y=130.00, conf=0.817
2025-11-07 15:29:35 - root - DEBUG - Element 3: text='D 1.69cm', x=180.00, y=126.00, conf=1.000
2025-11-07 15:29:35 - root - INFO - Filtered 0 elements, 3 remaining
2025-11-07 15:29:35 - root - DEBUG - Processing element 1/3: '1 D 2.22cm' at (153.00, 43.00)
2025-11-07 15:29:35 - root - DEBUG - Processing element 2/3: 'D 1.69cm' at (180.00, 126.00)
2025-11-07 15:29:35 - root - DEBUG - Processing element 3/3: '2 ' at (55.00, 130.00)
2025-11-07 15:29:35 - root - INFO - Line grouping completed - Total lines: 2
2025-11-07 15:29:35 - root - DEBUG - Processing line 1/2 with 1 elements
2025-11-07 15:29:35 - root - DEBUG - Processing word 1/1: '1 D 2.22cm'
2025-11-07 15:29:35 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:29:35 - root - DEBUG - Input text: '1 D 2.22cm'
2025-11-07 15:29:35 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:35 - root - DEBUG - Pattern 1 matched successfully
2025-11-07 15:29:35 - root - DEBUG - Pattern 1 groups: ('1', 'D', '2.22cm')
2025-11-07 15:29:35 - root - DEBUG - Pattern 1 result: ('1', 'D', '2.22cm')
2025-11-07 15:29:35 - root - INFO - Text split successful using pattern 1: ('1', 'D', '2.22cm')
2025-11-07 15:29:35 - root - DEBUG - Split measurement result: ('1', 'D', '2.22cm')
2025-11-07 15:29:35 - root - DEBUG - Processing line 2/2 with 2 elements
2025-11-07 15:29:35 - root - DEBUG - Processing word 1/2: '2 '
2025-11-07 15:29:35 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:29:35 - root - DEBUG - Input text: '2'
2025-11-07 15:29:35 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:35 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:29:35 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:35 - root - DEBUG - Pattern 2 did not match
2025-11-07 15:29:35 - root - DEBUG - No patterns matched for text: '2'
2025-11-07 15:29:35 - root - INFO - Text split failed - no matching patterns found
2025-11-07 15:29:35 - root - DEBUG - Split measurement result: None
2025-11-07 15:29:35 - root - DEBUG - Processing word 2/2: 'D 1.69cm'
2025-11-07 15:29:35 - root - DEBUG - Starting measurement text splitting
2025-11-07 15:29:35 - root - DEBUG - Input text: 'D 1.69cm'
2025-11-07 15:29:35 - root - DEBUG - Trying pattern 1: (\d+)\s+(\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:35 - root - DEBUG - Pattern 1 did not match
2025-11-07 15:29:35 - root - DEBUG - Trying pattern 2: (\d*[a-zA-Z]+\d*)\s*[.\s]*\s*(\d+(?:\.\d+)?\s*cm)
2025-11-07 15:29:35 - root - DEBUG - Pattern 2 matched successfully
2025-11-07 15:29:35 - root - DEBUG - Pattern 2 groups: ('D', '1.69cm')
2025-11-07 15:29:35 - root - DEBUG - Pattern 2 result: ('D', '1.69cm')
2025-11-07 15:29:35 - root - INFO - Text split successful using pattern 2: ('D', '1.69cm')
2025-11-07 15:29:35 - root - DEBUG - Split measurement result: ('D', '1.69cm')
2025-11-07 15:29:35 - root - DEBUG - Final structured data:
2025-11-07 15:29:35 - root - DEBUG - Item 1 (text): '{'Value1': ['1', 'D', '2.22cm']}'
2025-11-07 15:29:35 - root - DEBUG - Item 2 (text): '{'Value2': ['2', 'D', '1.69cm']}'
2025-11-07 15:29:35 - root - INFO - Table content extraction completed successfully
2025-11-07 15:29:35 - root - DEBUG - Structured data keys: ['organLabel', 'value']
2025-11-07 15:29:35 - root - DEBUG - Organ identified: []
2025-11-07 15:29:35 - root - INFO - Table extraction successful for file: C:\Users\asthr\OneDrive\Documents\clarityNLP\AIFeaturesForGenerativeAIProjectProject\API\extracted\e6112419-3c6a20f9-988114f4-93ae8b59-94ec76e3\CICPL14846 KAVITHA.M\ASN21785 ABDOMENUS\US\US000033.dcm
2025-11-07 15:29:35 - root - INFO - Organ identified: []
2025-11-07 15:29:35 - root - DEBUG - Structured data extracted: {'organLabel': [], 'value': ['1 D 2.22cm', '2 D 1.69cm']}
2025-11-07 15:29:35 - root - INFO - === DICOM Processing Session Completed === {'slice1': None, 'slice2': None, 'slice3': None, 'slice4': None, 'slice5': None, 'slice6': {'organLabel': [], 'value': ['1 D 9.10cm', '2 D 4.61cm']}, 'slice7': {'organLabel': ['kidney'], 'value': ['1 D 9.12cm', '2 D 3.49cm']}, 'slice8': None, 'slice9': None, 'slice10': None, 'slice11': None, 'slice12': None, 'slice13': {'organLabel': [], 'value': ['1 L 9.18cm', '2 L4 22cm', '3 L 4.90cm']}, 'slice14': None, 'slice15': None, 'slice16': {'organLabel': [], 'value': ['1 D 1.75cm', '2 D 2.20cm']}, 'slice17': {'organLabel': [], 'value': ['1 D 3.03cm', '2 D 1.70cm']}, 'slice18': {'organLabel': [], 'value': ['1 D 1.51cm', '2 D 0.99cm']}, 'slice19': {'organLabel': [], 'value': ['1 L 7.74cm', '2 L 3.69cm', '3 L 3.70cm']}, 'slice20': {'organLabel': [], 'value': ['1 D 2.11cm', '2 D 1.54cm']}, 'slice21': None, 'slice22': {'organLabel': ['rt ovary'], 'value': ['1 D 2.18cm', '2 D 1.15cm']}, 'slice23': None, 'slice24': {'organLabel': [], 'value': ['1 D 0.39cm']}, 'slice25': None, 'slice26': {'organLabel': [], 'value': ['1 D 2.00cm', '2 D 1.61cm']}, 'slice27': None, 'slice28': {'organLabel': [], 'value': ['1 D 2.25cm', '2 D 0.99cm']}, 'slice29': None, 'slice30': None, 'slice31': {'organLabel': [], 'value': ['1 D 2.22cm', '2 D 1.69cm']}} {'patientInformation': {'PatientName': 'KAVITHA.M', 'PatientID': 'CICPL14846', 'PatientAge': '19790324', 'PatientGender': 'F', 'HospitalName': 'CLARITY IMAGING CENTRE', 'PhysicianName': 'Dr. Devi Gayathri.P. MBBs., DNB', 'scanType': 'ABDOMEN/US', 'scanDate': '20250428', 'scanTime': '161021', 'scanModality': 'US'}}
2025-11-07 15:31:02 - root - INFO - Starting transcription for audio file: recordings\recording_20251107_153102.wav
2025-11-07 15:31:02 - root - DEBUG - Audio file size: 0.76 MB
2025-11-07 15:31:02 - root - DEBUG - Loading audio with librosa (target sr=16000)...
2025-11-07 15:31:06 - root - DEBUG - Audio loaded successfully. Sample rate: 16000, Duration: 24.90 seconds
2025-11-07 15:31:06 - root - DEBUG - Audio array shape: (398336,), dtype: float32
2025-11-07 15:31:06 - root - INFO - Running inference...
2025-11-07 15:31:24 - root - INFO - Inference completed in 17.82 seconds
2025-11-07 15:31:24 - root - DEBUG - Transcription length: 21 characters
2025-11-07 15:31:24 - root - DEBUG - Transcription preview:  Thanks for watching!...
2025-11-07 15:31:24 - root - DEBUG - Number of timestamp chunks: 1
2025-11-07 15:31:24 - root - DEBUG - Starting grammar check. Input text length: 21 characters
2025-11-07 15:31:24 - root - DEBUG - Input text preview:  Thanks for watching!...
2025-11-07 15:31:27 - root - DEBUG - Correction complete. Changes made: False
2025-11-07 15:31:27 - root - DEBUG - Corrected text length: 21 characters
2025-11-07 15:31:27 - root - INFO - No grammar corrections needed
2025-11-07 15:31:54 - root - INFO - Shutdown complete.
